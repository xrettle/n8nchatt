var e,t;"function"==typeof(e=globalThis.define)&&(t=e,e=null),function(t,n,r,i,s){var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a="function"==typeof o[i]&&o[i],l=a.cache||{},u="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function c(e,n){if(!l[e]){if(!t[e]){var r="function"==typeof o[i]&&o[i];if(!n&&r)return r(e,!0);if(a)return a(e,!0);if(u&&"string"==typeof e)return u(e);var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}p.resolve=function(n){var r=t[e][1][n];return null!=r?r:n},p.cache={};var d=l[e]=new c.Module(e);t[e][0].call(d.exports,p,d,d.exports,this)}return l[e].exports;function p(e){var t=p.resolve(e);return!1===t?{}:c(t)}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=t,c.cache=l,c.parent=a,c.register=function(e,n){t[e]=[function(e,t){t.exports=n},{}]},Object.defineProperty(c,"root",{get:function(){return o[i]}}),o[i]=c;for(var d=0;d<n.length;d++)c(n[d]);if(r){var p=c(r);"object"==typeof exports&&"undefined"!=typeof module?module.exports=p:"function"==typeof e&&e.amd?e(function(){return p}):s&&(this[s]=p)}}({fBdzW:[function(e,t,n){e("8cf95e1266f35e79").register(JSON.parse('{"abzv4":"index.js","hQLIL":"stateManager.e8cf884c.js","7vBBH":"esm-browser.de0523db.js","eeDZt":"node-operations.bffc942f.js"}'))},{"8cf95e1266f35e79":"aOnzl"}],aOnzl:[function(e,t,n){var r={};t.exports.register=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)r[t[n]]=e[t[n]]},t.exports.resolve=function(e){var t=r[e];if(null==t)throw Error("Could not resolve bundle with id "+e);return t}},{}],kgW6q:[function(e,t,n){e("./messaging"),e("../../../src/background/index"),e("./main-world-scripts")},{"./messaging":"iG3ww","../../../src/background/index":"iqY5N","./main-world-scripts":"8ZbMf"}],iG3ww:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js"),i=e("~background/messages/clearData"),s=r.interopDefault(i),o=e("~background/messages/functionResult"),a=r.interopDefault(o),l=e("~background/messages/pasteNodeJson"),u=r.interopDefault(l),c=e("~background/messages/testBackground"),d=r.interopDefault(c),p=e("~background/ports/geminiStream"),f=r.interopDefault(p),h=e("~background/ports/openaiStream"),m=r.interopDefault(h);globalThis.__plasmoInternalPortMap=new Map,chrome.runtime.onMessageExternal.addListener((e,t,n)=>(e?.name,!0)),chrome.runtime.onMessage.addListener((e,t,n)=>{switch(e.name){case"clearData":(0,s.default)({...e,sender:t},{send:e=>n(e)});break;case"functionResult":(0,a.default)({...e,sender:t},{send:e=>n(e)});break;case"pasteNodeJson":(0,u.default)({...e,sender:t},{send:e=>n(e)});break;case"testBackground":(0,d.default)({...e,sender:t},{send:e=>n(e)})}return!0}),chrome.runtime.onConnect.addListener(function(e){globalThis.__plasmoInternalPortMap.set(e.name,e),e.onMessage.addListener(function(t){switch(e.name){case"geminiStream":(0,f.default)({port:e,...t},{send:t=>e.postMessage(t)});break;case"openaiStream":(0,m.default)({port:e,...t},{send:t=>e.postMessage(t)})}})})},{"~background/messages/clearData":"iSi9N","~background/messages/functionResult":"6LK6Q","~background/messages/pasteNodeJson":"1jfGO","~background/messages/testBackground":"aWjDy","~background/ports/geminiStream":"613SE","~background/ports/openaiStream":"dHvna","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],iSi9N:[function(e,t,n){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(n);var r=e("@plasmohq/storage");let i=async(e,t)=>{console.log("[DEBUG] clearData handler received request");try{let e=new r.Storage;await e.clear(),t.send({success:!0,message:"Storage data cleared successfully"})}catch(e){console.error("[DEBUG] Error clearing data:",e),t.send({success:!1,error:e.message||"Unknown error"})}};n.default=i},{"@plasmohq/storage":"luF8G","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],luF8G:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"BaseStorage",()=>a),r.export(n,"Storage",()=>l);var i=e("pify"),s=r.interopDefault(i),o=()=>{try{let e=globalThis.navigator?.userAgent.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if("Chrome"===e[1])return 100>parseInt(e[2])||globalThis.chrome.runtime?.getManifest()?.manifest_version===2}catch{}return!1},a=class{#e;#t;get primaryClient(){return this.#t}#n;get secondaryClient(){return this.#n}#r;get area(){return this.#r}get hasWebApi(){try{return"u">typeof window&&!!window.localStorage}catch(e){return console.error(e),!1}}#i=new Map;#s;get copiedKeySet(){return this.#s}isCopied=e=>this.hasWebApi&&(this.allCopied||this.copiedKeySet.has(e));#o=!1;get allCopied(){return this.#o}getExtStorageApi=()=>globalThis.browser?.storage||globalThis.chrome?.storage;get hasExtensionApi(){try{return!!this.getExtStorageApi()}catch(e){return console.error(e),!1}}isWatchSupported=()=>this.hasExtensionApi;keyNamespace="";isValidKey=e=>e.startsWith(this.keyNamespace);getNamespacedKey=e=>`${this.keyNamespace}${e}`;getUnnamespacedKey=e=>e.slice(this.keyNamespace.length);serde={serializer:JSON.stringify,deserializer:JSON.parse};constructor({area:e="sync",allCopied:t=!1,copiedKeyList:n=[],serde:r={}}={}){this.setCopiedKeySet(n),this.#r=e,this.#o=t,this.serde={...this.serde,...r};try{this.hasWebApi&&(t||n.length>0)&&(this.#n=window.localStorage)}catch{}try{this.hasExtensionApi&&(this.#e=this.getExtStorageApi(),o()?this.#t=(0,s.default)(this.#e[this.area],{exclude:["getBytesInUse"],errorFirst:!1}):this.#t=this.#e[this.area])}catch{}}setCopiedKeySet(e){this.#s=new Set(e)}rawGetAll=()=>this.#t?.get();getAll=async()=>Object.entries(await this.rawGetAll()).filter(([e])=>this.isValidKey(e)).reduce((e,[t,n])=>(e[this.getUnnamespacedKey(t)]=n,e),{});copy=async e=>{let t=void 0===e;if(!t&&!this.copiedKeySet.has(e)||!this.allCopied||!this.hasExtensionApi)return!1;let n=this.allCopied?await this.rawGetAll():await this.#t.get((t?[...this.copiedKeySet]:[e]).map(this.getNamespacedKey));if(!n)return!1;let r=!1;for(let e in n){let t=n[e],i=this.#n?.getItem(e);this.#n?.setItem(e,t),r||=t!==i}return r};rawGet=async e=>(await this.rawGetMany([e]))[e];rawGetMany=async e=>this.hasExtensionApi?await this.#t.get(e):e.filter(this.isCopied).reduce((e,t)=>(e[t]=this.#n?.getItem(t),e),{});rawSet=async(e,t)=>await this.rawSetMany({[e]:t});rawSetMany=async e=>(this.#n&&Object.entries(e).filter(([e])=>this.isCopied(e)).forEach(([e,t])=>this.#n.setItem(e,t)),this.hasExtensionApi&&await this.#t.set(e),null);clear=async(e=!1)=>{e&&this.#n?.clear(),await this.#t.clear()};rawRemove=async e=>{await this.rawRemoveMany([e])};rawRemoveMany=async e=>{this.#n&&e.filter(this.isCopied).forEach(e=>this.#n.removeItem(e)),this.hasExtensionApi&&await this.#t.remove(e)};removeAll=async()=>{let e=Object.keys(await this.getAll());await this.removeMany(e)};watch=e=>{let t=this.isWatchSupported();return t&&this.#a(e),t};#a=e=>{for(let t in e){let n=this.getNamespacedKey(t),r=this.#i.get(n)?.callbackSet||new Set;if(r.add(e[t]),r.size>1)continue;let i=(e,t)=>{if(t!==this.area||!e[n])return;let r=this.#i.get(n);if(!r)throw Error(`Storage comms does not exist for nsKey: ${n}`);Promise.all([this.parseValue(e[n].newValue),this.parseValue(e[n].oldValue)]).then(([e,n])=>{for(let i of r.callbackSet)i({newValue:e,oldValue:n},t)})};this.#e.onChanged.addListener(i),this.#i.set(n,{callbackSet:r,listener:i})}};unwatch=e=>{let t=this.isWatchSupported();return t&&this.#l(e),t};#l(e){for(let t in e){let n=this.getNamespacedKey(t),r=e[t],i=this.#i.get(n);i&&(i.callbackSet.delete(r),0===i.callbackSet.size&&(this.#i.delete(n),this.#e.onChanged.removeListener(i.listener)))}}unwatchAll=()=>this.#u();#u(){this.#i.forEach(({listener:e})=>this.#e.onChanged.removeListener(e)),this.#i.clear()}async getItem(e){return this.get(e)}async getItems(e){return await this.getMany(e)}async setItem(e,t){await this.set(e,t)}async setItems(e){await await this.setMany(e)}async removeItem(e){return this.remove(e)}async removeItems(e){return await this.removeMany(e)}},l=class extends a{get=async e=>{let t=this.getNamespacedKey(e),n=await this.rawGet(t);return this.parseValue(n)};getMany=async e=>{let t=e.map(this.getNamespacedKey),n=await this.rawGetMany(t),r=await Promise.all(Object.values(n).map(this.parseValue));return Object.keys(n).reduce((e,t,n)=>(e[this.getUnnamespacedKey(t)]=r[n],e),{})};set=async(e,t)=>{let n=this.getNamespacedKey(e),r=this.serde.serializer(t);return this.rawSet(n,r)};setMany=async e=>{let t=Object.entries(e).reduce((e,[t,n])=>(e[this.getNamespacedKey(t)]=this.serde.serializer(n),e),{});return await this.rawSetMany(t)};remove=async e=>{let t=this.getNamespacedKey(e);return this.rawRemove(t)};removeMany=async e=>{let t=e.map(this.getNamespacedKey);return await this.rawRemoveMany(t)};setNamespace=e=>{this.keyNamespace=e};parseValue=async e=>{try{if(void 0!==e)return this.serde.deserializer(e)}catch(e){console.error(e)}}}},{pify:"9arDK","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"9arDK":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"default",()=>o);let i=(e,t,n,r)=>function(...i){let s=t.promiseModule;return new s((s,o)=>{t.multiArgs?i.push((...e)=>{t.errorFirst?e[0]?o(e):(e.shift(),s(e)):s(e)}):t.errorFirst?i.push((e,t)=>{e?o(e):s(t)}):i.push(s),Reflect.apply(e,this===n?r:this,i)})},s=new WeakMap;function o(e,t){t={exclude:[/.+(?:Sync|Stream)$/],errorFirst:!0,promiseModule:Promise,...t};let n=typeof e;if(!(null!==e&&("object"===n||"function"===n)))throw TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${null===e?"null":n}\``);let r=(e,n)=>{let r=s.get(e);if(r||(r={},s.set(e,r)),n in r)return r[n];let i=e=>"string"==typeof e||"symbol"==typeof n?n===e:e.test(n),o=Reflect.getOwnPropertyDescriptor(e,n),a=void 0===o||o.writable||o.configurable,l=t.include?t.include.some(e=>i(e)):!t.exclude.some(e=>i(e)),u=l&&a;return r[n]=u,u},o=new WeakMap,a=new Proxy(e,{apply(e,n,r){let s=o.get(e);if(s)return Reflect.apply(s,n,r);let l=t.excludeMain?e:i(e,t,a,e);return o.set(e,l),Reflect.apply(l,n,r)},get(e,n){let s=e[n];if(!r(e,n)||s===Function.prototype[n])return s;let l=o.get(s);if(l)return l;if("function"==typeof s){let n=i(s,t,a,e);return o.set(s,n),n}return s}});return a}},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],hbR2Q:[function(e,t,n){n.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},n.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.exportAll=function(e,t){return Object.keys(e).forEach(function(n){"default"===n||"__esModule"===n||t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[n]}})}),t},n.export=function(e,t,n){Object.defineProperty(e,t,{enumerable:!0,get:n})}},{}],"6LK6Q":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"pendingFunctionResults",()=>i);let i=new Map,s=async(e,t)=>{let{functionName:n,result:r,toolCallId:s,requestId:o,success:a,error:l}=e.body;i.set(o,e.body),t.send({received:!0})};n.default=s},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"1jfGO":[function(e,t,n){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(n);var r=e("@plasmohq/messaging");let i=0,s="",o=async(e,t)=>{try{if(!e.body?.json)throw Error("No JSON data provided");let n=Date.now(),o=function(e){try{let t=JSON.parse(e);if(t.nodes&&Array.isArray(t.nodes))return t.nodes.map(e=>`${e.id||""}:${e.name||""}:${e.type||""}`).join("|")}catch(e){}return e.substring(0,100)}(e.body.json);if(n-i<5e3&&s===o){console.log("[n8n-chat] Skipping duplicate paste request"),t.send({success:!0,message:"Duplicate request skipped"});return}i=n,s=o;try{let t=JSON.parse(e.body.json);if(!t.nodes||!Array.isArray(t.nodes))throw Error("Invalid n8n workflow format")}catch(e){throw Error(`Invalid JSON format: ${e.message}`)}let a=e.sender.tab?.id;try{await (0,r.sendToContentScript)({name:"pasteNodeJson",body:{json:e.body.json},tabId:a}),t.send({success:!0,message:"Node JSON forwarded to content script"})}catch(e){throw Error(`Failed to send to content script: ${e.message}`)}}catch(e){console.error("[n8n-chat] Background error:",e),t.send({success:!1,error:e.message||"Failed to process node JSON"})}};n.default=o},{"@plasmohq/messaging":"cGQiM","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],cGQiM:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"relay",()=>m),r.export(n,"relayMessage",()=>h),r.export(n,"sendToActiveContentScript",()=>f),r.export(n,"sendToBackground",()=>d),r.export(n,"sendToBackgroundViaRelay",()=>g),r.export(n,"sendToContentScript",()=>p),r.export(n,"sendViaRelay",()=>y);var i=e("nanoid"),s=globalThis.browser?.tabs||globalThis.chrome?.tabs,o=()=>{let e=globalThis.browser?.runtime||globalThis.chrome?.runtime;if(!e)throw Error("Extension runtime is not available");return e},a=()=>{if(!s)throw Error("Extension tabs API is not available");return s},l=async()=>{let e=a(),[t]=await e.query({active:!0,currentWindow:!0});return t},u=(e,t)=>!t.__internal&&e.source===globalThis.window&&e.data.name===t.name&&(void 0===t.relayId||e.data.relayId===t.relayId),c=(e,t,n=globalThis.window)=>{let r=async r=>{if(u(r,e)&&!r.data.relayed){let i={name:e.name,relayId:e.relayId,body:r.data.body},s=await t?.(i);n.postMessage({name:e.name,relayId:e.relayId,instanceId:r.data.instanceId,body:s,relayed:!0},{targetOrigin:e.targetOrigin||"/"})}};return n.addEventListener("message",r),()=>n.removeEventListener("message",r)},d=async e=>o().sendMessage(e.extensionId??null,e),p=async e=>{let t="number"==typeof e.tabId?e.tabId:(await l())?.id;if(!t)throw Error("No active tab found to send message to.");return a().sendMessage(t,e)},f=p,h=e=>c(e,d),m=h,g=(e,t=globalThis.window)=>new Promise((n,r)=>{let s=(0,i.nanoid)(),o=new AbortController;t.addEventListener("message",t=>{u(t,e)&&t.data.relayed&&t.data.instanceId===s&&(n(t.data.body),o.abort())},{signal:o.signal}),t.postMessage({...e,instanceId:s},{targetOrigin:e.targetOrigin||"/"})}),y=g},{nanoid:"WGs0a","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],WGs0a:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"urlAlphabet",()=>i.urlAlphabet),r.export(n,"random",()=>s),r.export(n,"customRandom",()=>o),r.export(n,"customAlphabet",()=>a),r.export(n,"nanoid",()=>l);var i=e("./url-alphabet/index.js");let s=e=>crypto.getRandomValues(new Uint8Array(e)),o=(e,t,n)=>{let r=(2<<Math.log(e.length-1)/Math.LN2)-1,i=-~(1.6*r*t/e.length);return (s=t)=>{let o="";for(;;){let t=n(i),a=i;for(;a--;)if((o+=e[t[a]&r]||"").length===s)return o}}},a=(e,t=21)=>o(e,t,s),l=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>((t&=63)<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"")},{"./url-alphabet/index.js":!1,"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],aWjDy:[function(e,t,n){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(n);let r=async(e,t)=>{t.send({status:"Background script is active"})};n.default=r},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"613SE":[function(e,t,n){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(n);var r=e("@google/genai"),i=e("../messages/functionResult");function s(){return"call_"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}let o=async(e,t)=>{let{apiKey:n,streamOptions:i,requestId:o}=e.body;if(!n||!i||!o){t.send({type:"error",error:"Missing required parameters: apiKey, streamOptions, or requestId",requestId:o||"unknown"});return}let l=new r.GoogleGenAI({apiKey:n}),u=!1;try{let e;t.send({type:"start",requestId:o,data:{message:"Starting stream"}});let{model:n,tools:c,temperature:d,top_p:p,max_output_tokens:f}=i,{input:h}=i,m="",g=h.filter(e=>"system"!==e.role||(m=e.content,!1)),y=function(e){let t=[];for(let n of e)if(n&&"string"==typeof n.role&&"system"!==n.role){if("user"===n.role){let e=[];n.image&&e.push({inlineData:{mimeType:n.image.mimeType||"image/jpeg",data:n.image.data}}),n.content&&e.push({text:n.content}),t.push({role:"user",parts:e})}if("assistant"===n.role){let e=[];if(n.content&&e.push({text:n.content}),n.tool_calls&&Array.isArray(n.tool_calls))for(let t of n.tool_calls)e.push({functionCall:{name:t.function?.name||"",args:JSON.parse(t.function?.arguments||"{}")}});e.length>0&&t.push({role:"model",parts:e})}"function"===n.role&&n.toolCallId&&t.push({role:"user",parts:[{functionResponse:{name:n.name,response:{result:n.content}}}]})}return t}(g),b={};if(void 0!==d&&(b.temperature=d),void 0!==p&&(b.topP=p),void 0!==f&&(b.maxOutputTokens=f),c&&c.length>0){let t=c.filter(e=>"function"===e.type).map(e=>(function(e){let t=e.function||e,n=function e(t){let n={};if(!t)return n;for(let[i,s]of Object.entries(t)){let t={description:s.description||""};"string"===s.type?t.type=r.Type.STRING:"number"===s.type||"integer"===s.type?t.type=r.Type.NUMBER:"boolean"===s.type?t.type=r.Type.BOOLEAN:"array"===s.type?(t.type=r.Type.ARRAY,s.items&&("object"===s.items.type&&s.items.properties?t.items={type:r.Type.OBJECT,properties:e(s.items.properties),required:s.items.required||[]}:(t.items={type:"string"===s.items.type?r.Type.STRING:"number"===s.items.type?r.Type.NUMBER:"integer"===s.items.type?r.Type.NUMBER:"boolean"===s.items.type?r.Type.BOOLEAN:"object"===s.items.type?r.Type.OBJECT:r.Type.STRING},s.items.properties&&(t.items.properties=e(s.items.properties),t.items.required=s.items.required||[])))):"object"===s.type?(t.type=r.Type.OBJECT,s.properties&&(t.properties=e(s.properties),t.required=s.required||[]),void 0!==s.additionalProperties&&(t.additionalProperties=s.additionalProperties)):t.type=r.Type.STRING,s.enum&&(t.enum=s.enum),n[i]=t}return n}(t.parameters?.properties);return{name:t.name,description:t.description||"",parameters:{type:r.Type.OBJECT,properties:n,required:t.parameters?.required||[]}}})(e));t.length>0&&(e=[{functionDeclarations:t}])}let v=await l.models.generateContentStream({model:n,contents:y,config:{systemInstruction:m||void 0,temperature:b.temperature,topP:b.topP,topK:b.topK,maxOutputTokens:b.maxOutputTokens,stopSequences:b.stopSequences,candidateCount:b.candidateCount,seed:b.seed,frequencyPenalty:b.frequencyPenalty,presencePenalty:b.presencePenalty,responseMimeType:b.responseMimeType,responseSchema:b.responseSchema,tools:e,toolConfig:e?{functionCallingConfig:{mode:r.FunctionCallingConfigMode.AUTO}}:void 0}}),_=[],A=`gemini_${Date.now()}_${Math.random().toString(36).substring(2,9)}`;for await(let e of(t.send({type:"chunk",data:{type:"metadata",responseId:A},requestId:o}),v)){if(e.candidates&&e.candidates.length>0){let t=e.candidates[0];t.finishReason,"STOP"===t.finishReason&&e.text}let n=[];if(e.candidates&&e.candidates.length>0){let t=e.candidates[0];if(t.content&&t.content.parts)for(let e of t.content.parts)e.functionCall&&n.push(e.functionCall)}else e.functionCalls&&e.functionCalls.length>0&&(n=e.functionCalls);for(let e of n){let t=s();_.push({name:e.name,args:e.args,toolCallId:t})}let r="";try{void 0!==e.text&&null!==e.text&&(r=e.text)}catch(e){}if(!r&&e.candidates&&e.candidates.length>0){let t=e.candidates[0];if(t.content&&t.content.parts)for(let e of t.content.parts)e.text&&(r+=e.text)}r&&(t.send({type:"chunk",data:{type:"text",content:r},requestId:o}),await new Promise(e=>setTimeout(e,5)))}for(;_.length>0;){let i=_.shift();t.send({type:"function_call",functionName:i.name,toolCallId:i.toolCallId,data:{functionName:i.name,args:i.args,toolCallId:i.toolCallId,argumentsString:JSON.stringify(i.args),requestId:o},requestId:o});try{let c=await a(o);if(c.success){let a;y.push({role:"model",parts:[{functionCall:{name:i.name,args:i.args}}]}),y.push({role:"user",parts:[{functionResponse:{name:i.name,response:{result:c.result}}}]});try{try{a=await l.models.generateContentStream({model:n,contents:y,config:{systemInstruction:m||void 0,temperature:b.temperature,topP:b.topP,topK:b.topK,maxOutputTokens:b.maxOutputTokens,stopSequences:b.stopSequences,candidateCount:b.candidateCount,seed:b.seed,frequencyPenalty:b.frequencyPenalty,presencePenalty:b.presencePenalty,responseMimeType:b.responseMimeType,responseSchema:b.responseSchema,tools:e,toolConfig:e?{functionCallingConfig:{mode:r.FunctionCallingConfigMode.AUTO}}:void 0}})}catch(t){if(t.message&&t.message.includes("got status: 500")){let t=y.map(e=>{if("user"===e.role&&e.parts){let t=e.parts.some(e=>e.inlineData);if(t){let t=e.parts.filter(e=>!e.inlineData);return 0===t.length?{role:"user",parts:[{text:"[User provided an image - see original message]"}]}:{...e,parts:t}}}return e});a=await l.models.generateContentStream({model:n,contents:t,config:{systemInstruction:m||void 0,temperature:b.temperature,topP:b.topP,topK:b.topK,maxOutputTokens:b.maxOutputTokens,stopSequences:b.stopSequences,candidateCount:b.candidateCount,seed:b.seed,frequencyPenalty:b.frequencyPenalty,presencePenalty:b.presencePenalty,responseMimeType:b.responseMimeType,responseSchema:b.responseSchema,tools:e,toolConfig:e?{functionCallingConfig:{mode:r.FunctionCallingConfigMode.AUTO}}:void 0}})}else throw t}}catch(n){let e="Unknown error occurred";if("function"==typeof n.toJSON)try{let t=n.toJSON();t?.error?.message&&(e=t.error.message)}catch(e){}else n.response?.data?.error?.message?e=n.response.data.error.message:n.error?.message?e=n.error.message:n.message&&(e=n.message);if(n.message&&n.message.includes("got status:")){let t=n.message.match(/got status:\s*\d+\s*\.\s*(.+)$/s);if(t&&t[1])try{let n=t[1].trim(),r=JSON.parse(n);if(r?.error?.message&&"string"==typeof r.error.message)try{let t=JSON.parse(r.error.message);t?.error?.message&&(e=t.error.message)}catch(t){"exception parsing response"!==r.error.message&&(e=r.error.message)}}catch(e){}}t.send({type:"chunk",data:{type:"error",error:e},requestId:o}),u||(t.send({type:"complete",requestId:o,data:{message:"Stream completed with error",error:!0}}),u=!0);return}for await(let e of a){let n=[];if(e.candidates&&e.candidates.length>0){let t=e.candidates[0];if(t.content&&t.content.parts)for(let e of t.content.parts)e.functionCall&&n.push(e.functionCall)}else e.functionCalls&&e.functionCalls.length>0&&(n=e.functionCalls);for(let e of n){let t=s();_.push({name:e.name,args:e.args,toolCallId:t})}let r="";try{void 0!==e.text&&null!==e.text&&(r=e.text)}catch(e){}if(!r&&e.candidates&&e.candidates.length>0){let t=e.candidates[0];if(t.content&&t.content.parts)for(let e of t.content.parts)e.text&&(r+=e.text)}r&&(t.send({type:"chunk",data:{type:"text",content:r},requestId:o}),await new Promise(e=>setTimeout(e,5)))}}else{t.send({type:"chunk",data:{type:"error",error:`Function execution failed: ${c.error||"Unknown error"}`},requestId:o}),u||(t.send({type:"complete",requestId:o,data:{message:"Stream completed with error",error:!0}}),u=!0);return}}catch(n){let e="Unknown error";n.message&&n.message.includes("Function execution timeout")?e=`Function execution timeout for ${i.name}`:n.message&&(e=n.message),t.send({type:"chunk",data:{type:"error",error:`Error processing function ${i.name}: ${e}`},requestId:o}),u||(t.send({type:"complete",requestId:o,data:{message:"Stream completed with error",error:!0}}),u=!0);return}}u||(t.send({type:"complete",requestId:o,data:{message:"Stream completed"}}),u=!0)}catch(r){let e="Unknown error occurred",n=null;if(r.response?.data?.error?.message&&(e=r.response.data.error.message,n=r.response.data.error),(null===n||"Unknown error occurred"===e)&&"function"==typeof r.toJSON)try{let t=r.toJSON();t?.error?.message&&(e=t.error.message,n=t.error)}catch(e){}if(null===n){let t=[r.response?.data,r.response?.body,r.data,r.body,r.errorDetails,r.details];for(let r of t)if(r?.error?.message){e=r.error.message,n=r.error;break}}if(null===n&&r.message&&r.message.includes("got status:")){let t=r.message.match(/got status:\s*\d+\s*\.\s*(.+)$/s);if(t&&t[1])try{let r=t[1].trim(),i=JSON.parse(r);if(i?.error?.message&&"string"==typeof i.error.message)try{let t=JSON.parse(i.error.message);t?.error?.message&&(e=t.error.message,n=t.error)}catch(t){e=i.error.message,n=i.error}else i?.message&&(e=i.message,n=i)}catch(e){}}if("Unknown error occurred"===e||"exception parsing response"===e){let t=r,i=0;for(;t&&i<5;){let r=[t.originalResponse,t.rawResponse,t.responseBody,t._response,t.$response];for(let t of r)if(t)try{let r="string"==typeof t?JSON.parse(t):t;if(r?.error?.message){e=r.error.message,n=r.error;break}}catch(e){}if(n)break;t=t.cause||t.parent||t.originalError,i++}}("Unknown error occurred"===e||"exception parsing response"===e)&&(r.statusCode||r.status||r.code,r.message&&"exception parsing response"!==r.message&&(e=r.message));try{t.send({type:"chunk",data:{type:"error",error:e},requestId:o}),await new Promise(e=>setTimeout(e,100))}catch(e){}try{u||(t.send({type:"complete",requestId:o,data:{message:"Stream completed with error",error:!0}}),u=!0)}catch(e){}return}};async function a(e,t=3e4){let n=Date.now();for(;Date.now()-n<t;){if((0,i.pendingFunctionResults).has(e)){let t=(0,i.pendingFunctionResults).get(e);return(0,i.pendingFunctionResults).delete(e),t}await new Promise(e=>setTimeout(e,100))}throw Error("Function execution timeout")}n.default=o},{"@google/genai":"21K8E","../messages/functionResult":"6LK6Q","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"21K8E":[function(e,t,n){let r,i;var s,o,a,l,u,c,d,p,f,h,m,g,y,b,v,_,A,C,I,w,O,T,E,S,x,P,R,k,M,j,N,D,U,L,F,B,q,$,V,Z,G,J,H,z,K,W,Y,X,Q,ee,et,en,er,ei,es,eo,ea,el,eu,ec,ed,ep,ef,eh,em,eg,ey,eb,ev,e_,eA,eC,eI,ew,eO,eT,eE,eS,ex,eP,eR=e("@parcel/transformer-js/src/esmodule-helpers.js");eR.defineInteropFlag(n),eR.export(n,"ActivityHandling",()=>eO),eR.export(n,"AdapterSize",()=>ea),eR.export(n,"AuthType",()=>X),eR.export(n,"Behavior",()=>eu),eR.export(n,"BlockedReason",()=>en),eR.export(n,"Caches",()=>tH),eR.export(n,"Chat",()=>t0),eR.export(n,"Chats",()=>tQ),eR.export(n,"ComputeTokensResponse",()=>e4),eR.export(n,"ControlReferenceImage",()=>tl),eR.export(n,"ControlReferenceType",()=>ey),eR.export(n,"CountTokensResponse",()=>e5),eR.export(n,"CreateFileResponse",()=>tr),eR.export(n,"DeleteCachedContentResponse",()=>e7),eR.export(n,"DeleteFileResponse",()=>ti),eR.export(n,"DeleteModelResponse",()=>e8),eR.export(n,"DynamicRetrievalConfigMode",()=>ec),eR.export(n,"EditImageResponse",()=>e1),eR.export(n,"EditMode",()=>ev),eR.export(n,"EmbedContentResponse",()=>eQ),eR.export(n,"EndSensitivity",()=>ew),eR.export(n,"FeatureSelectionPreference",()=>el),eR.export(n,"FileSource",()=>eA),eR.export(n,"FileState",()=>e_),eR.export(n,"Files",()=>t2),eR.export(n,"FinishReason",()=>Q),eR.export(n,"FunctionCallingConfigMode",()=>ed),eR.export(n,"FunctionResponse",()=>eL),eR.export(n,"FunctionResponseScheduling",()=>eE),eR.export(n,"GenerateContentResponse",()=>eX),eR.export(n,"GenerateContentResponsePromptFeedback",()=>eW),eR.export(n,"GenerateContentResponseUsageMetadata",()=>eY),eR.export(n,"GenerateImagesResponse",()=>e0),eR.export(n,"GenerateVideosResponse",()=>e3),eR.export(n,"GoogleGenAI",()=>n1),eR.export(n,"HarmBlockMethod",()=>K),eR.export(n,"HarmBlockThreshold",()=>W),eR.export(n,"HarmCategory",()=>z),eR.export(n,"HarmProbability",()=>ee),eR.export(n,"HarmSeverity",()=>et),eR.export(n,"HttpResponse",()=>tn),eR.export(n,"ImagePromptLanguage",()=>em),eR.export(n,"JobState",()=>eo),eR.export(n,"Language",()=>J),eR.export(n,"ListCachedContentsResponse",()=>te),eR.export(n,"ListFilesResponse",()=>tt),eR.export(n,"ListModelsResponse",()=>e6),eR.export(n,"ListTuningJobsResponse",()=>e9),eR.export(n,"Live",()=>nk),eR.export(n,"LiveClientToolResponse",()=>tp),eR.export(n,"LiveMusicPlaybackControl",()=>ex),eR.export(n,"LiveMusicServerMessage",()=>th),eR.export(n,"LiveSendToolResponseParameters",()=>tf),eR.export(n,"LiveServerMessage",()=>td),eR.export(n,"MaskReferenceImage",()=>ta),eR.export(n,"MaskReferenceMode",()=>eg),eR.export(n,"MediaModality",()=>eC),eR.export(n,"MediaResolution",()=>es),eR.export(n,"Modality",()=>ei),eR.export(n,"Mode",()=>Y),eR.export(n,"Models",()=>nL),eR.export(n,"Operations",()=>nB),eR.export(n,"Outcome",()=>G),eR.export(n,"PagedItem",()=>eP),eR.export(n,"Pager",()=>tJ),eR.export(n,"PersonGeneration",()=>eh),eR.export(n,"RawReferenceImage",()=>to),eR.export(n,"ReplayResponse",()=>ts),eR.export(n,"SafetyFilterLevel",()=>ef),eR.export(n,"Scale",()=>eS),eR.export(n,"Session",()=>nj),eR.export(n,"StartSensitivity",()=>eI),eR.export(n,"StyleReferenceImage",()=>tu),eR.export(n,"SubjectReferenceImage",()=>tc),eR.export(n,"SubjectReferenceType",()=>eb),eR.export(n,"Tokens",()=>n$),eR.export(n,"TrafficType",()=>er),eR.export(n,"TurnCoverage",()=>eT),eR.export(n,"Type",()=>H),eR.export(n,"UpscaleImageResponse",()=>e2),eR.export(n,"UrlRetrievalStatus",()=>ep),eR.export(n,"createModelContent",()=>eK),eR.export(n,"createPartFromBase64",()=>eV),eR.export(n,"createPartFromCodeExecutionResult",()=>eZ),eR.export(n,"createPartFromExecutableCode",()=>eG),eR.export(n,"createPartFromFunctionCall",()=>eq),eR.export(n,"createPartFromFunctionResponse",()=>e$),eR.export(n,"createPartFromText",()=>eB),eR.export(n,"createPartFromUri",()=>eF),eR.export(n,"createUserContent",()=>ez),eR.export(n,"mcpToTool",()=>nE),eR.export(n,"setDefaultBaseUrls",()=>eM);var ek=e("zod");function eM(e){r=e.geminiUrl,i=e.vertexUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ej{}function eN(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){let e=t[n];return null!=e?String(e):""}throw Error(`Key '${n}' not found in valueMap.`)})}function eD(e,t,n){for(let r=0;r<t.length-1;r++){let i=t[r];if(i.endsWith("[]")){let s=i.slice(0,-2);if(!(s in e)){if(Array.isArray(n))e[s]=Array.from({length:n.length},()=>({}));else throw Error(`Value must be a list given an array path ${i}`)}if(Array.isArray(e[s])){let i=e[s];if(Array.isArray(n))for(let e=0;e<i.length;e++){let s=i[e];eD(s,t.slice(r+1),n[e])}else for(let e of i)eD(e,t.slice(r+1),n)}return}if(i.endsWith("[0]")){let s=i.slice(0,-3);s in e||(e[s]=[{}]);let o=e[s];eD(o[0],t.slice(r+1),n);return}e[i]&&"object"==typeof e[i]||(e[i]={}),e=e[i]}let r=t[t.length-1],i=e[r];if(void 0!==i){if(!n||"object"==typeof n&&0===Object.keys(n).length||n===i)return;if("object"==typeof i&&"object"==typeof n&&null!==i&&null!==n)Object.assign(i,n);else throw Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=n}function eU(e,t){try{if(1===t.length&&"_self"===t[0])return e;for(let n=0;n<t.length;n++){if("object"!=typeof e||null===e)return;let r=t[n];if(r.endsWith("[]")){let i=r.slice(0,-2);if(!(i in e))return;{let r=e[i];if(!Array.isArray(r))return;return r.map(e=>eU(e,t.slice(n+1)))}}e=e[r]}return e}catch(e){if(e instanceof TypeError)return;throw e}}(s=G||(G={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",s.OUTCOME_OK="OUTCOME_OK",s.OUTCOME_FAILED="OUTCOME_FAILED",s.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(o=J||(J={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",o.PYTHON="PYTHON",(a=H||(H={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",a.STRING="STRING",a.NUMBER="NUMBER",a.INTEGER="INTEGER",a.BOOLEAN="BOOLEAN",a.ARRAY="ARRAY",a.OBJECT="OBJECT",a.NULL="NULL",(l=z||(z={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",l.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",l.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",l.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",l.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",l.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",(u=K||(K={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",u.SEVERITY="SEVERITY",u.PROBABILITY="PROBABILITY",(c=W||(W={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",c.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",c.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",c.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",c.BLOCK_NONE="BLOCK_NONE",c.OFF="OFF",(d=Y||(Y={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",d.MODE_DYNAMIC="MODE_DYNAMIC",(p=X||(X={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",p.NO_AUTH="NO_AUTH",p.API_KEY_AUTH="API_KEY_AUTH",p.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",p.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",p.OAUTH="OAUTH",p.OIDC_AUTH="OIDC_AUTH",(f=Q||(Q={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",f.STOP="STOP",f.MAX_TOKENS="MAX_TOKENS",f.SAFETY="SAFETY",f.RECITATION="RECITATION",f.LANGUAGE="LANGUAGE",f.OTHER="OTHER",f.BLOCKLIST="BLOCKLIST",f.PROHIBITED_CONTENT="PROHIBITED_CONTENT",f.SPII="SPII",f.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",f.IMAGE_SAFETY="IMAGE_SAFETY",f.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",(h=ee||(ee={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",h.NEGLIGIBLE="NEGLIGIBLE",h.LOW="LOW",h.MEDIUM="MEDIUM",h.HIGH="HIGH",(m=et||(et={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",m.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",m.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",m.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",m.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(g=en||(en={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",g.SAFETY="SAFETY",g.OTHER="OTHER",g.BLOCKLIST="BLOCKLIST",g.PROHIBITED_CONTENT="PROHIBITED_CONTENT",(y=er||(er={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",y.ON_DEMAND="ON_DEMAND",y.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(b=ei||(ei={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",b.TEXT="TEXT",b.IMAGE="IMAGE",b.AUDIO="AUDIO",(v=es||(es={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",v.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",v.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",v.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(_=eo||(eo={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",_.JOB_STATE_QUEUED="JOB_STATE_QUEUED",_.JOB_STATE_PENDING="JOB_STATE_PENDING",_.JOB_STATE_RUNNING="JOB_STATE_RUNNING",_.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",_.JOB_STATE_FAILED="JOB_STATE_FAILED",_.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",_.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",_.JOB_STATE_PAUSED="JOB_STATE_PAUSED",_.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",_.JOB_STATE_UPDATING="JOB_STATE_UPDATING",_.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(A=ea||(ea={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",A.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",A.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",A.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",A.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",A.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",A.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(C=el||(el={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",C.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",C.BALANCED="BALANCED",C.PRIORITIZE_COST="PRIORITIZE_COST",(I=eu||(eu={})).UNSPECIFIED="UNSPECIFIED",I.BLOCKING="BLOCKING",I.NON_BLOCKING="NON_BLOCKING",(w=ec||(ec={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",w.MODE_DYNAMIC="MODE_DYNAMIC",(O=ed||(ed={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",O.AUTO="AUTO",O.ANY="ANY",O.NONE="NONE",(T=ep||(ep={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",T.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",T.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",(E=ef||(ef={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",E.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",E.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",E.BLOCK_NONE="BLOCK_NONE",(S=eh||(eh={})).DONT_ALLOW="DONT_ALLOW",S.ALLOW_ADULT="ALLOW_ADULT",S.ALLOW_ALL="ALLOW_ALL",(x=em||(em={})).auto="auto",x.en="en",x.ja="ja",x.ko="ko",x.hi="hi",(P=eg||(eg={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",P.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",P.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",P.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",P.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(R=ey||(ey={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",R.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",R.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",R.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(k=eb||(eb={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",k.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",k.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",k.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(M=ev||(ev={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",M.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",M.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",M.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",M.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",M.EDIT_MODE_STYLE="EDIT_MODE_STYLE",M.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",M.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(j=e_||(e_={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",j.PROCESSING="PROCESSING",j.ACTIVE="ACTIVE",j.FAILED="FAILED",(N=eA||(eA={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",N.UPLOADED="UPLOADED",N.GENERATED="GENERATED",(D=eC||(eC={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",D.TEXT="TEXT",D.IMAGE="IMAGE",D.VIDEO="VIDEO",D.AUDIO="AUDIO",D.DOCUMENT="DOCUMENT",(U=eI||(eI={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",U.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",U.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(L=ew||(ew={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",L.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",L.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(F=eO||(eO={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",F.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",F.NO_INTERRUPTION="NO_INTERRUPTION",(B=eT||(eT={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",B.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",B.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(q=eE||(eE={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",q.SILENT="SILENT",q.WHEN_IDLE="WHEN_IDLE",q.INTERRUPT="INTERRUPT",($=eS||(eS={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",$.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",$.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",$.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",$.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",$.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",$.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",$.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",$.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",$.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",$.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",$.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",$.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(V=ex||(ex={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",V.PLAY="PLAY",V.PAUSE="PAUSE",V.STOP="STOP",V.RESET_CONTEXT="RESET_CONTEXT";class eL{}function eF(e,t){return{fileData:{fileUri:e,mimeType:t}}}function eB(e){return{text:e}}function eq(e,t){return{functionCall:{name:e,args:t}}}function e$(e,t,n){return{functionResponse:{id:e,name:t,response:n}}}function eV(e,t){return{inlineData:{data:e,mimeType:t}}}function eZ(e,t){return{codeExecutionResult:{outcome:e,output:t}}}function eG(e,t){return{executableCode:{code:e,language:t}}}function eJ(e){return"object"==typeof e&&null!==e&&("fileData"in e||"text"in e||"functionCall"in e||"functionResponse"in e||"inlineData"in e||"videoMetadata"in e||"codeExecutionResult"in e||"executableCode"in e)}function eH(e){let t=[];if("string"==typeof e)t.push(eB(e));else if(eJ(e))t.push(e);else if(Array.isArray(e)){if(0===e.length)throw Error("partOrString cannot be an empty array");for(let n of e)if("string"==typeof n)t.push(eB(n));else if(eJ(n))t.push(n);else throw Error("element in PartUnion must be a Part object or string")}else throw Error("partOrString must be a Part object, string, or array");return t}function ez(e){return{role:"user",parts:eH(e)}}function eK(e){return{role:"model",parts:eH(e)}}class eW{}class eY{}class eX{get text(){var e,t,n,r,i,s,o,a;if((null===(r=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===r?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let l="",u=!1,c=[];for(let e of null!==(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)&&void 0!==a?a:[]){for(let[t,n]of Object.entries(e))"text"!==t&&"thought"!==t&&(null!==n||void 0!==n)&&c.push(t);if("string"==typeof e.text){if("boolean"==typeof e.thought&&e.thought)continue;u=!0,l+=e.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?l:void 0}get data(){var e,t,n,r,i,s,o,a;if((null===(r=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===r?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let l="",u=[];for(let e of null!==(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)&&void 0!==a?a:[]){for(let[t,n]of Object.entries(e))"inlineData"!==t&&(null!==n||void 0!==n)&&u.push(t);e.inlineData&&"string"==typeof e.inlineData.data&&(l+=atob(e.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),l.length>0?btoa(l):void 0}get functionCalls(){var e,t,n,r,i,s,o,a;if((null===(r=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===r?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let l=null===(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);if((null==l?void 0:l.length)!==0)return l}get executableCode(){var e,t,n,r,i,s,o,a,l;if((null===(r=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===r?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let u=null===(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null===(l=null==u?void 0:u[0])||void 0===l?void 0:l.code}get codeExecutionResult(){var e,t,n,r,i,s,o,a,l;if((null===(r=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===r?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let u=null===(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null===(l=null==u?void 0:u[0])||void 0===l?void 0:l.output}}class eQ{}class e0{}class e1{}class e2{}class e6{}class e8{}class e5{}class e4{}class e3{}class e9{}class e7{}class te{}class tt{}class tn{constructor(e){let t={};for(let n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class tr{}class ti{}class ts{}class to{toReferenceImageAPI(){let e={referenceType:"REFERENCE_TYPE_RAW",referenceImage:this.referenceImage,referenceId:this.referenceId};return e}}class ta{toReferenceImageAPI(){let e={referenceType:"REFERENCE_TYPE_MASK",referenceImage:this.referenceImage,referenceId:this.referenceId,maskImageConfig:this.config};return e}}class tl{toReferenceImageAPI(){let e={referenceType:"REFERENCE_TYPE_CONTROL",referenceImage:this.referenceImage,referenceId:this.referenceId,controlImageConfig:this.config};return e}}class tu{toReferenceImageAPI(){let e={referenceType:"REFERENCE_TYPE_STYLE",referenceImage:this.referenceImage,referenceId:this.referenceId,styleImageConfig:this.config};return e}}class tc{toReferenceImageAPI(){let e={referenceType:"REFERENCE_TYPE_SUBJECT",referenceImage:this.referenceImage,referenceId:this.referenceId,subjectImageConfig:this.config};return e}}class td{get text(){var e,t,n;let r="",i=!1,s=[];for(let o of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(let[e,t]of Object.entries(o))"text"!==e&&"thought"!==e&&null!==t&&s.push(e);if("string"==typeof o.text){if("boolean"==typeof o.thought&&o.thought)continue;i=!0,r+=o.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?r:void 0}get data(){var e,t,n;let r="",i=[];for(let s of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(let[e,t]of Object.entries(s))"inlineData"!==e&&null!==t&&i.push(e);s.inlineData&&"string"==typeof s.inlineData.data&&(r+=atob(s.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class tp{}class tf{constructor(){this.functionResponses=[]}}class th{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tm(e,t){if(!t||"string"!=typeof t)throw Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(!(t.indexOf("/")>=0))return`publishers/google/models/${t}`;{let e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function tg(e,t){let n=tm(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function ty(e,t){return Array.isArray(t)?t.map(t=>tb(e,t)):[tb(e,t)]}function tb(e,t){if("object"==typeof t&&null!==t)return t;throw Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function tv(e,t){if(null==t)throw Error("PartUnion is required");if("object"==typeof t)return t;if("string"==typeof t)return{text:t};throw Error(`Unsupported part type: ${typeof t}`)}function t_(e,t){if(null==t||Array.isArray(t)&&0===t.length)throw Error("PartListUnion is required");return Array.isArray(t)?t.map(t=>tv(e,t)):[tv(e,t)]}function tA(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function tC(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function tI(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function tw(e,t){if(null==t)throw Error("ContentUnion is required");return tA(t)?t:{role:"user",parts:t_(e,t)}}function tO(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(t=>{let n=tw(e,t);return n.parts&&n.parts.length>0&&void 0!==n.parts[0].text?[n.parts[0].text]:[]});if(e.isVertexAI()){let n=tw(e,t);return n.parts&&n.parts.length>0&&void 0!==n.parts[0].text?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(t=>tw(e,t)):[tw(e,t)]}function tT(e,t){if(null==t||Array.isArray(t)&&0===t.length)throw Error("contents are required");if(!Array.isArray(t)){if(tC(t)||tI(t))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[tw(e,t)]}let n=[],r=[],i=tA(t[0]);for(let e of t){let t=tA(e);if(t!=i)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(t)n.push(e);else if(tC(e)||tI(e))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else r.push(e)}return i||n.push({role:"user",parts:t_(e,r)}),n}let tE=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),tS=(0,ek.z).enum(["string","number","integer","object","array","boolean","null"]),tx=(0,ek.z).union([tS,(0,ek.z).array(tS)]);function tP(e){let t={},n=["items"],r=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw Error("type and anyOf cannot be both populated.");let s=e.anyOf;for(let[o,a]of(null!=s&&2==s.length&&("null"===s[0].type?(t.nullable=!0,e=s[1]):"null"===s[1].type&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);let n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.keys(H).includes(n[0].toUpperCase())?H[n[0].toUpperCase()]:H.TYPE_UNSPECIFIED;else for(let e of(t.anyOf=[],n))t.anyOf.push({type:Object.keys(H).includes(e.toUpperCase())?H[e.toUpperCase()]:H.TYPE_UNSPECIFIED})}(e.type,t),Object.entries(e)))if(null!=a){if("type"==o){if("null"===a)throw Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.keys(H).includes(a.toUpperCase())?a.toUpperCase():H.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=tP(a);else if(r.includes(o)){let e=[];for(let n of a){if("null"==n.type){t.nullable=!0;continue}e.push(tP(n))}t[o]=e}else if(i.includes(o)){let e={};for(let[t,n]of Object.entries(a))e[t]=tP(n);t[o]=e}else{if("additionalProperties"===o)continue;t[o]=a}}return t}function tR(e,t){if(!Object.keys(t).includes("$schema"))return tP(t);{delete t.$schema;let e=(function(e=!0){let t=(0,ek.z).lazy(()=>{let n=(0,ek.z).object({type:tx.optional(),format:(0,ek.z).string().optional(),title:(0,ek.z).string().optional(),description:(0,ek.z).string().optional(),default:(0,ek.z).unknown().optional(),items:t.optional(),minItems:(0,ek.z).coerce.string().optional(),maxItems:(0,ek.z).coerce.string().optional(),enum:(0,ek.z).array((0,ek.z).unknown()).optional(),properties:(0,ek.z).record((0,ek.z).string(),t).optional(),required:(0,ek.z).array((0,ek.z).string()).optional(),minProperties:(0,ek.z).coerce.string().optional(),maxProperties:(0,ek.z).coerce.string().optional(),propertyOrdering:(0,ek.z).array((0,ek.z).string()).optional(),minimum:(0,ek.z).number().optional(),maximum:(0,ek.z).number().optional(),minLength:(0,ek.z).coerce.string().optional(),maxLength:(0,ek.z).coerce.string().optional(),pattern:(0,ek.z).string().optional(),anyOf:(0,ek.z).array(t).optional(),additionalProperties:(0,ek.z).boolean().optional()});return e?n.strict():n});return t})().parse(t);return tP(e)}}function tk(e,t){if("object"==typeof t)return t;if("string"==typeof t)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw Error(`Unsupported speechConfig type: ${typeof t}`)}function tM(e,t){if("multiSpeakerVoiceConfig"in t)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function tj(e,t){if(t.functionDeclarations)for(let n of t.functionDeclarations)n.parameters&&(n.parameters=tR(e,n.parameters)),n.response&&(n.response=tR(e,n.response));return t}function tN(e,t){if(null==t)throw Error("tools is required");if(!Array.isArray(t))throw Error("tools is required and must be an array of Tools");let n=[];for(let e of t)n.push(e);return n}function tD(e,t){if("string"!=typeof t)throw Error("name must be a string");return function(e,t,n,r=1){let i=!t.startsWith(`${n}/`)&&t.split("/").length===r;if(e.isVertexAI())return t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t;return i?`${n}/${t}`:t}(e,t,"cachedContents")}function tU(e,t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function tL(e,t){if("string"!=typeof t)throw Error("fromImageBytes must be a string");return t}function tF(e,t){var n;let r;if(null!=t&&"object"==typeof t&&"name"in t&&(r=t.name),(null==t||"object"!=typeof t||!("uri"in t)||void 0!==(r=t.uri))&&(null==t||"object"!=typeof t||!("video"in t)||void 0!==(r=null===(n=t.video)||void 0===n?void 0:n.uri))){if("string"==typeof t&&(r=t),void 0===r)throw Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){let e=r.split("files/")[1],t=e.match(/[a-z0-9]+/);if(null===t)throw Error(`Could not extract file name from URI ${r}`);r=t[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function tB(e,t){return e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels"}function tq(e,t){for(let e of["models","tunedModels","publisherModels"]){if(null!==t&&"object"==typeof t&&e in t)return t[e]}return[]}function t$(e,t){let n={},r=eU(t,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["videoMetadata"]);null!=r&&eD(n,["videoMetadata"],/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e,t){let n={},r=eU(t,["fps"]);null!=r&&eD(n,["fps"],r);let i=eU(t,["endOffset"]);null!=i&&eD(n,["endOffset"],i);let s=eU(t,["startOffset"]);return null!=s&&eD(n,["startOffset"],s),n}(0,r));let i=eU(t,["thought"]);null!=i&&eD(n,["thought"],i);let s=eU(t,["inlineData"]);null!=s&&eD(n,["inlineData"],function(e,t){let n={};if(void 0!==eU(t,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eU(t,["data"]);null!=r&&eD(n,["data"],r);let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(0,s));let o=eU(t,["fileData"]);null!=o&&eD(n,["fileData"],function(e,t){let n={};if(void 0!==eU(t,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eU(t,["fileUri"]);null!=r&&eD(n,["fileUri"],r);let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(0,o));let a=eU(t,["thoughtSignature"]);null!=a&&eD(n,["thoughtSignature"],a);let l=eU(t,["codeExecutionResult"]);null!=l&&eD(n,["codeExecutionResult"],l);let u=eU(t,["executableCode"]);null!=u&&eD(n,["executableCode"],u);let c=eU(t,["functionCall"]);null!=c&&eD(n,["functionCall"],c);let d=eU(t,["functionResponse"]);null!=d&&eD(n,["functionResponse"],d);let p=eU(t,["text"]);return null!=p&&eD(n,["text"],p),n})(0,e))),eD(n,["parts"],e)}let i=eU(t,["role"]);return null!=i&&eD(n,["role"],i),n}function tV(e,t){let n={},r=eU(t,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["videoMetadata"]);null!=r&&eD(n,["videoMetadata"],function(e,t){let n={},r=eU(t,["fps"]);null!=r&&eD(n,["fps"],r);let i=eU(t,["endOffset"]);null!=i&&eD(n,["endOffset"],i);let s=eU(t,["startOffset"]);return null!=s&&eD(n,["startOffset"],s),n}(0,r));let i=eU(t,["thought"]);null!=i&&eD(n,["thought"],i);let s=eU(t,["inlineData"]);null!=s&&eD(n,["inlineData"],function(e,t){let n={},r=eU(t,["displayName"]);null!=r&&eD(n,["displayName"],r);let i=eU(t,["data"]);null!=i&&eD(n,["data"],i);let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(0,s));let o=eU(t,["fileData"]);null!=o&&eD(n,["fileData"],function(e,t){let n={},r=eU(t,["displayName"]);null!=r&&eD(n,["displayName"],r);let i=eU(t,["fileUri"]);null!=i&&eD(n,["fileUri"],i);let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(0,o));let a=eU(t,["thoughtSignature"]);null!=a&&eD(n,["thoughtSignature"],a);let l=eU(t,["codeExecutionResult"]);null!=l&&eD(n,["codeExecutionResult"],l);let u=eU(t,["executableCode"]);null!=u&&eD(n,["executableCode"],u);let c=eU(t,["functionCall"]);null!=c&&eD(n,["functionCall"],c);let d=eU(t,["functionResponse"]);null!=d&&eD(n,["functionResponse"],d);let p=eU(t,["text"]);return null!=p&&eD(n,["text"],p),n})(0,e))),eD(n,["parts"],e)}let i=eU(t,["role"]);return null!=i&&eD(n,["role"],i),n}function tZ(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["displayName"]);null!=i&&eD(n,["displayName"],i);let s=eU(t,["model"]);null!=s&&eD(n,["model"],s);let o=eU(t,["createTime"]);null!=o&&eD(n,["createTime"],o);let a=eU(t,["updateTime"]);null!=a&&eD(n,["updateTime"],a);let l=eU(t,["expireTime"]);null!=l&&eD(n,["expireTime"],l);let u=eU(t,["usageMetadata"]);return null!=u&&eD(n,["usageMetadata"],u),n}function tG(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["displayName"]);null!=i&&eD(n,["displayName"],i);let s=eU(t,["model"]);null!=s&&eD(n,["model"],s);let o=eU(t,["createTime"]);null!=o&&eD(n,["createTime"],o);let a=eU(t,["updateTime"]);null!=a&&eD(n,["updateTime"],a);let l=eU(t,["expireTime"]);null!=l&&eD(n,["expireTime"],l);let u=eU(t,["usageMetadata"]);return null!=u&&eD(n,["usageMetadata"],u),n}(Z=eP||(eP={})).PAGED_ITEM_BATCH_JOBS="batchJobs",Z.PAGED_ITEM_MODELS="models",Z.PAGED_ITEM_TUNING_JOBS="tuningJobs",Z.PAGED_ITEM_FILES="files",Z.PAGED_ITEM_CACHED_CONTENTS="cachedContents";class tJ{constructor(e,t,n,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,r)}init(e,t,n){var r,i;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let s={config:{}};(s=n?"object"==typeof n?Object.assign({},n):n:{config:{}}).config&&(s.config.pageToken=t.nextPageToken),this.paramsInternal=s,this.pageInternalSize=null!==(i=null===(r=s.config)||void 0===r?void 0:r.pageSize)&&void 0!==i?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tH extends ej{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new tJ(eP.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["model"],tg(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],function(e,t,n){let r=eU(t,["ttl"]);void 0!==n&&null!=r&&eD(n,["ttl"],r);let i=eU(t,["expireTime"]);void 0!==n&&null!=i&&eD(n,["expireTime"],i);let s=eU(t,["displayName"]);void 0!==n&&null!=s&&eD(n,["displayName"],s);let o=eU(t,["contents"]);if(void 0!==n&&null!=o){let t=tT(e,o);Array.isArray(t)&&(t=t.map(t=>tV(e,t))),eD(n,["contents"],t)}let a=eU(t,["systemInstruction"]);void 0!==n&&null!=a&&eD(n,["systemInstruction"],tV(e,tw(e,a)));let l=eU(t,["tools"]);if(void 0!==n&&null!=l){let t=l;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={};if(void 0!==eU(t,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let r=eU(t,["description"]);null!=r&&eD(n,["description"],r);let i=eU(t,["name"]);null!=i&&eD(n,["name"],i);let s=eU(t,["parameters"]);null!=s&&eD(n,["parameters"],s);let o=eU(t,["response"]);return null!=o&&eD(n,["response"],o),n})(0,e))),eD(n,["functionDeclarations"],e)}let i=eU(t,["retrieval"]);null!=i&&eD(n,["retrieval"],i);let s=eU(t,["googleSearch"]);null!=s&&eD(n,["googleSearch"],function(e,t){let n={},r=eU(t,["timeRangeFilter"]);return null!=r&&eD(n,["timeRangeFilter"],function(e,t){let n={},r=eU(t,["startTime"]);null!=r&&eD(n,["startTime"],r);let i=eU(t,["endTime"]);return null!=i&&eD(n,["endTime"],i),n}(0,r)),n}(0,s));let o=eU(t,["googleSearchRetrieval"]);null!=o&&eD(n,["googleSearchRetrieval"],function(e,t){let n={},r=eU(t,["dynamicRetrievalConfig"]);return null!=r&&eD(n,["dynamicRetrievalConfig"],function(e,t){let n={},r=eU(t,["mode"]);null!=r&&eD(n,["mode"],r);let i=eU(t,["dynamicThreshold"]);return null!=i&&eD(n,["dynamicThreshold"],i),n}(0,r)),n}(0,o));let a=eU(t,["enterpriseWebSearch"]);null!=a&&eD(n,["enterpriseWebSearch"],{});let l=eU(t,["googleMaps"]);if(null!=l&&eD(n,["googleMaps"],function(e,t){let n={},r=eU(t,["authConfig"]);return null!=r&&eD(n,["authConfig"],function(e,t){let n={},r=eU(t,["apiKeyConfig"]);null!=r&&eD(n,["apiKeyConfig"],function(e,t){let n={},r=eU(t,["apiKeyString"]);return null!=r&&eD(n,["apiKeyString"],r),n}(0,r));let i=eU(t,["authType"]);null!=i&&eD(n,["authType"],i);let s=eU(t,["googleServiceAccountConfig"]);null!=s&&eD(n,["googleServiceAccountConfig"],s);let o=eU(t,["httpBasicAuthConfig"]);null!=o&&eD(n,["httpBasicAuthConfig"],o);let a=eU(t,["oauthConfig"]);null!=a&&eD(n,["oauthConfig"],a);let l=eU(t,["oidcConfig"]);return null!=l&&eD(n,["oidcConfig"],l),n}(0,r)),n}(0,l)),void 0!==eU(t,["urlContext"]))throw Error("urlContext parameter is not supported in Vertex AI.");let u=eU(t,["codeExecution"]);return null!=u&&eD(n,["codeExecution"],u),n})(e,t))),eD(n,["tools"],t)}let u=eU(t,["toolConfig"]);void 0!==n&&null!=u&&eD(n,["toolConfig"],function(e,t){let n={},r=eU(t,["functionCallingConfig"]);null!=r&&eD(n,["functionCallingConfig"],function(e,t){let n={},r=eU(t,["mode"]);null!=r&&eD(n,["mode"],r);let i=eU(t,["allowedFunctionNames"]);return null!=i&&eD(n,["allowedFunctionNames"],i),n}(0,r));let i=eU(t,["retrievalConfig"]);return null!=i&&eD(n,["retrievalConfig"],function(e,t){let n={},r=eU(t,["latLng"]);null!=r&&eD(n,["latLng"],function(e,t){let n={},r=eU(t,["latitude"]);null!=r&&eD(n,["latitude"],r);let i=eU(t,["longitude"]);return null!=i&&eD(n,["longitude"],i),n}(0,r));let i=eU(t,["languageCode"]);return null!=i&&eD(n,["languageCode"],i),n}(0,i)),n}(0,u));let c=eU(t,["kmsKeyName"]);return void 0!==n&&null!=c&&eD(n,["encryption_spec","kmsKeyName"],c),{}}(e,i,n)),n}(this.apiClient,e);return s=eN("cachedContents",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=tG(this.apiClient,e);return t})}{let t=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["model"],tg(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],function(e,t,n){let r=eU(t,["ttl"]);void 0!==n&&null!=r&&eD(n,["ttl"],r);let i=eU(t,["expireTime"]);void 0!==n&&null!=i&&eD(n,["expireTime"],i);let s=eU(t,["displayName"]);void 0!==n&&null!=s&&eD(n,["displayName"],s);let o=eU(t,["contents"]);if(void 0!==n&&null!=o){let t=tT(e,o);Array.isArray(t)&&(t=t.map(t=>t$(e,t))),eD(n,["contents"],t)}let a=eU(t,["systemInstruction"]);void 0!==n&&null!=a&&eD(n,["systemInstruction"],t$(e,tw(e,a)));let l=eU(t,["tools"]);if(void 0!==n&&null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["behavior"]);null!=r&&eD(n,["behavior"],r);let i=eU(t,["description"]);null!=i&&eD(n,["description"],i);let s=eU(t,["name"]);null!=s&&eD(n,["name"],s);let o=eU(t,["parameters"]);null!=o&&eD(n,["parameters"],o);let a=eU(t,["response"]);return null!=a&&eD(n,["response"],a),n})(0,e))),eD(n,["functionDeclarations"],e)}if(void 0!==eU(t,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=eU(t,["googleSearch"]);null!=i&&eD(n,["googleSearch"],function(e,t){let n={},r=eU(t,["timeRangeFilter"]);return null!=r&&eD(n,["timeRangeFilter"],function(e,t){let n={},r=eU(t,["startTime"]);null!=r&&eD(n,["startTime"],r);let i=eU(t,["endTime"]);return null!=i&&eD(n,["endTime"],i),n}(0,r)),n}(0,i));let s=eU(t,["googleSearchRetrieval"]);if(null!=s&&eD(n,["googleSearchRetrieval"],function(e,t){let n={},r=eU(t,["dynamicRetrievalConfig"]);return null!=r&&eD(n,["dynamicRetrievalConfig"],function(e,t){let n={},r=eU(t,["mode"]);null!=r&&eD(n,["mode"],r);let i=eU(t,["dynamicThreshold"]);return null!=i&&eD(n,["dynamicThreshold"],i),n}(0,r)),n}(0,s)),void 0!==eU(t,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==eU(t,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");let o=eU(t,["urlContext"]);null!=o&&eD(n,["urlContext"],{});let a=eU(t,["codeExecution"]);return null!=a&&eD(n,["codeExecution"],a),n})(0,e))),eD(n,["tools"],e)}let u=eU(t,["toolConfig"]);if(void 0!==n&&null!=u&&eD(n,["toolConfig"],function(e,t){let n={},r=eU(t,["functionCallingConfig"]);null!=r&&eD(n,["functionCallingConfig"],function(e,t){let n={},r=eU(t,["mode"]);null!=r&&eD(n,["mode"],r);let i=eU(t,["allowedFunctionNames"]);return null!=i&&eD(n,["allowedFunctionNames"],i),n}(0,r));let i=eU(t,["retrievalConfig"]);return null!=i&&eD(n,["retrievalConfig"],function(e,t){let n={},r=eU(t,["latLng"]);null!=r&&eD(n,["latLng"],function(e,t){let n={},r=eU(t,["latitude"]);null!=r&&eD(n,["latitude"],r);let i=eU(t,["longitude"]);return null!=i&&eD(n,["longitude"],i),n}(0,r));let i=eU(t,["languageCode"]);return null!=i&&eD(n,["languageCode"],i),n}(0,i)),n}(0,u)),void 0!==eU(t,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.");return{}}(e,i,n)),n}(this.apiClient,e);return s=eN("cachedContents",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=tZ(this.apiClient,e);return t})}}async get(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["_url","name"],tD(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return s=eN("{name}",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=tG(this.apiClient,e);return t})}{let t=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["_url","name"],tD(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return s=eN("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=tZ(this.apiClient,e);return t})}}async delete(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["_url","name"],tD(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return s=eN("{name}",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(()=>{let e=new e7;return Object.assign(e,{}),e})}{let t=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["_url","name"],tD(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return s=eN("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(()=>{let e=new e7;return Object.assign(e,{}),e})}}async update(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["_url","name"],tD(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],function(e,t,n){let r=eU(t,["ttl"]);void 0!==n&&null!=r&&eD(n,["ttl"],r);let i=eU(t,["expireTime"]);return void 0!==n&&null!=i&&eD(n,["expireTime"],i),{}}(0,i,n)),n}(this.apiClient,e);return s=eN("{name}",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=tG(this.apiClient,e);return t})}{let t=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["_url","name"],tD(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],function(e,t,n){let r=eU(t,["ttl"]);void 0!==n&&null!=r&&eD(n,["ttl"],r);let i=eU(t,["expireTime"]);return void 0!==n&&null!=i&&eD(n,["expireTime"],i),{}}(0,i,n)),n}(this.apiClient,e);return s=eN("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=tZ(this.apiClient,e);return t})}}async listInternal(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["config"]);return null!=r&&eD(n,["config"],function(e,t,n){let r=eU(t,["pageSize"]);void 0!==n&&null!=r&&eD(n,["_query","pageSize"],r);let i=eU(t,["pageToken"]);return void 0!==n&&null!=i&&eD(n,["_query","pageToken"],i),{}}(0,r,n)),n}(this.apiClient,e);return s=eN("cachedContents",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["nextPageToken"]);null!=r&&eD(n,["nextPageToken"],r);let i=eU(t,["cachedContents"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>tG(e,t))),eD(n,["cachedContents"],t)}return n}(this.apiClient,e),n=new te;return Object.assign(n,t),n})}{let t=function(e,t){let n={},r=eU(t,["config"]);return null!=r&&eD(n,["config"],function(e,t,n){let r=eU(t,["pageSize"]);void 0!==n&&null!=r&&eD(n,["_query","pageSize"],r);let i=eU(t,["pageToken"]);return void 0!==n&&null!=i&&eD(n,["_query","pageToken"],i),{}}(0,r,n)),n}(this.apiClient,e);return s=eN("cachedContents",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["nextPageToken"]);null!=r&&eD(n,["nextPageToken"],r);let i=eU(t,["cachedContents"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>tZ(e,t))),eD(n,["cachedContents"],t)}return n}(this.apiClient,e),n=new te;return Object.assign(n,t),n})}}}function tz(e){return this instanceof tz?(this.v=e,this):new tz(e)}function tK(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),r[Symbol.asyncIterator]=function(){return this},r;function o(e,t){i[e]&&(r[e]=function(t){return new Promise(function(n,r){s.push([e,t,n,r])>1||a(e,t)})},t&&(r[e]=t(r[e])))}function a(e,t){try{var n;(n=i[e](t)).value instanceof tz?Promise.resolve(n.value.v).then(l,u):c(s[0][2],n)}catch(e){c(s[0][3],e)}}function l(e){a("next",e)}function u(e){a("throw",e)}function c(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function tW(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,i,(t=e[n](t)).done,t.value)})}}}function tY(e){if(void 0===e.parts||0===e.parts.length)return!1;for(let t of e.parts)if(void 0===t||0===Object.keys(t).length||!t.thought&&void 0!==t.text&&""===t.text)return!1;return!0}function tX(e){if(void 0===e||0===e.length)return[];let t=[],n=e.length,r=0;for(;r<n;)if("user"===e[r].role)t.push(e[r]),r++;else{let i=[],s=!0;for(;r<n&&"model"===e[r].role;)i.push(e[r]),s&&!tY(e[r])&&(s=!1),r++;s?t.push(...i):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class tQ{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new t0(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class t0{constructor(e,t,n,r={},i=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=r,this.history=i,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length){for(let t of e)if("user"!==t.role&&"model"!==t.role)throw Error(`Role must be user or model, but got ${t.role}.`)}}(i)}async sendMessage(e){var t;await this.sendPromise;let n=tw(this.apiClient,e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t,i;let s=await r,o=null===(t=null===(e=s.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content,a=s.automaticFunctionCallingHistory,l=this.getHistory(!0).length,u=[];null!=a&&(u=null!==(i=a.slice(l))&&void 0!==i?i:[]),this.recordHistory(n,o?[o]:[],u)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;let n=tw(this.apiClient,e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=r.then(()=>void 0).catch(()=>void 0);let i=await r,s=this.processStreamResponse(i,n);return s}getHistory(e=!1){let t=e?tX(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var n,r;return tK(this,arguments,function*(){var i,s,o,a;let l=[];try{for(var u,c=!0,d=tW(e);!(i=(u=yield tz(d.next())).done);c=!0){if(a=u.value,c=!1,/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e){var t;if(void 0==e.candidates||0===e.candidates.length)return!1;let n=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==n&&tY(n)}(a)){let e=null===(r=null===(n=a.candidates)||void 0===n?void 0:n[0])||void 0===r?void 0:r.content;void 0!==e&&l.push(e)}yield yield tz(a)}}catch(e){s={error:e}}finally{try{!c&&!i&&(o=d.return)&&(yield tz(o.call(d)))}finally{if(s)throw s.error}}this.recordHistory(t,l)})}recordHistory(e,t,n){let r=[];t.length>0&&t.every(e=>void 0!==e.role)?r=t:r.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...tX(n)):this.history.push(e),this.history.push(...r)}}function t1(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["displayName"]);null!=i&&eD(n,["displayName"],i);let s=eU(t,["mimeType"]);null!=s&&eD(n,["mimeType"],s);let o=eU(t,["sizeBytes"]);null!=o&&eD(n,["sizeBytes"],o);let a=eU(t,["createTime"]);null!=a&&eD(n,["createTime"],a);let l=eU(t,["expirationTime"]);null!=l&&eD(n,["expirationTime"],l);let u=eU(t,["updateTime"]);null!=u&&eD(n,["updateTime"],u);let c=eU(t,["sha256Hash"]);null!=c&&eD(n,["sha256Hash"],c);let d=eU(t,["uri"]);null!=d&&eD(n,["uri"],d);let p=eU(t,["downloadUri"]);null!=p&&eD(n,["downloadUri"],p);let f=eU(t,["state"]);null!=f&&eD(n,["state"],f);let h=eU(t,["source"]);null!=h&&eD(n,["source"],h);let m=eU(t,["videoMetadata"]);null!=m&&eD(n,["videoMetadata"],m);let g=eU(t,["error"]);return null!=g&&eD(n,["error"],function(e,t){let n={},r=eU(t,["details"]);null!=r&&eD(n,["details"],r);let i=eU(t,["message"]);null!=i&&eD(n,["message"],i);let s=eU(t,["code"]);return null!=s&&eD(n,["code"],s),n}(0,g)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class t2 extends ej{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new tJ(eP.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>{let t=t1(this.apiClient,e);return t})}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let r="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e,t){let n={},r=eU(t,["config"]);return null!=r&&eD(n,["config"],/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e,t,n){let r=eU(t,["pageSize"]);void 0!==n&&null!=r&&eD(n,["_query","pageSize"],r);let i=eU(t,["pageToken"]);return void 0!==n&&null!=i&&eD(n,["_query","pageToken"],i),{}}(0,r,n)),n}(this.apiClient,e);return r=eN("files",s._url),i=s._query,delete s.config,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["nextPageToken"]);null!=r&&eD(n,["nextPageToken"],r);let i=eU(t,["files"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>t1(e,t))),eD(n,["files"],t)}return n}(this.apiClient,e),n=new tt;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let r="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e,t){let n={},r=eU(t,["file"]);null!=r&&eD(n,["file"],function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["displayName"]);null!=i&&eD(n,["displayName"],i);let s=eU(t,["mimeType"]);null!=s&&eD(n,["mimeType"],s);let o=eU(t,["sizeBytes"]);null!=o&&eD(n,["sizeBytes"],o);let a=eU(t,["createTime"]);null!=a&&eD(n,["createTime"],a);let l=eU(t,["expirationTime"]);null!=l&&eD(n,["expirationTime"],l);let u=eU(t,["updateTime"]);null!=u&&eD(n,["updateTime"],u);let c=eU(t,["sha256Hash"]);null!=c&&eD(n,["sha256Hash"],c);let d=eU(t,["uri"]);null!=d&&eD(n,["uri"],d);let p=eU(t,["downloadUri"]);null!=p&&eD(n,["downloadUri"],p);let f=eU(t,["state"]);null!=f&&eD(n,["state"],f);let h=eU(t,["source"]);null!=h&&eD(n,["source"],h);let m=eU(t,["videoMetadata"]);null!=m&&eD(n,["videoMetadata"],m);let g=eU(t,["error"]);return null!=g&&eD(n,["error"],function(e,t){let n={},r=eU(t,["details"]);null!=r&&eD(n,["details"],r);let i=eU(t,["message"]);null!=i&&eD(n,["message"],i);let s=eU(t,["code"]);return null!=s&&eD(n,["code"],s),n}(0,g)),n}(0,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return r=eN("upload/v1beta/files",s._url),i=s._query,delete s.config,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(()=>{let e=new tr;return Object.assign(e,{}),e})}}async get(e){var t,n;let r="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["_url","file"],tF(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return r=eN("files/{file}",s._url),i=s._query,delete s.config,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=t1(this.apiClient,e);return t})}}async delete(e){var t,n;let r="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["_url","file"],tF(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return r=eN("files/{file}",s._url),i=s._query,delete s.config,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(()=>{let e=new ti;return Object.assign(e,{}),e})}}}function t6(e,t){let n={},r=eU(t,["prebuiltVoiceConfig"]);return null!=r&&eD(n,["prebuiltVoiceConfig"],/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e,t){let n={},r=eU(t,["voiceName"]);return null!=r&&eD(n,["voiceName"],r),n}(0,r)),n}function t8(e,t){let n={},r=eU(t,["text"]);null!=r&&eD(n,["text"],r);let i=eU(t,["weight"]);return null!=i&&eD(n,["weight"],i),n}function t5(e,t){let n={},r=eU(t,["temperature"]);null!=r&&eD(n,["temperature"],r);let i=eU(t,["topK"]);null!=i&&eD(n,["topK"],i);let s=eU(t,["seed"]);null!=s&&eD(n,["seed"],s);let o=eU(t,["guidance"]);null!=o&&eD(n,["guidance"],o);let a=eU(t,["bpm"]);null!=a&&eD(n,["bpm"],a);let l=eU(t,["density"]);null!=l&&eD(n,["density"],l);let u=eU(t,["brightness"]);null!=u&&eD(n,["brightness"],u);let c=eU(t,["scale"]);null!=c&&eD(n,["scale"],c);let d=eU(t,["muteBass"]);null!=d&&eD(n,["muteBass"],d);let p=eU(t,["muteDrums"]);null!=p&&eD(n,["muteDrums"],p);let f=eU(t,["onlyBassAndDrums"]);return null!=f&&eD(n,["onlyBassAndDrums"],f),n}function t4(e,t){let n={},r=eU(t,["model"]);return null!=r&&eD(n,["model"],r),n}function t3(e,t){let n={},r=eU(t,["weightedPrompts"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>t8(e,t))),eD(n,["weightedPrompts"],t)}return n}function t9(e,t){let n={},r=eU(t,["setup"]);null!=r&&eD(n,["setup"],t4(e,r));let i=eU(t,["clientContent"]);null!=i&&eD(n,["clientContent"],t3(e,i));let s=eU(t,["musicGenerationConfig"]);null!=s&&eD(n,["musicGenerationConfig"],t5(e,s));let o=eU(t,["playbackControl"]);return null!=o&&eD(n,["playbackControl"],o),n}function t7(e,t){let n={},r=eU(t,["text"]);null!=r&&eD(n,["text"],r);let i=eU(t,["finished"]);return null!=i&&eD(n,["finished"],i),n}function ne(e,t){let n={},r=eU(t,["text"]);null!=r&&eD(n,["text"],r);let i=eU(t,["finished"]);return null!=i&&eD(n,["finished"],i),n}function nt(e,t){let n={},r=eU(t,["modality"]);null!=r&&eD(n,["modality"],r);let i=eU(t,["tokenCount"]);return null!=i&&eD(n,["tokenCount"],i),n}function nn(e,t){let n={},r=eU(t,["modality"]);null!=r&&eD(n,["modality"],r);let i=eU(t,["tokenCount"]);return null!=i&&eD(n,["tokenCount"],i),n}function nr(e,t){let n={},r=eU(t,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["videoMetadata"]);null!=r&&eD(n,["videoMetadata"],/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e,t){let n={},r=eU(t,["fps"]);null!=r&&eD(n,["fps"],r);let i=eU(t,["endOffset"]);null!=i&&eD(n,["endOffset"],i);let s=eU(t,["startOffset"]);return null!=s&&eD(n,["startOffset"],s),n}(0,r));let i=eU(t,["thought"]);null!=i&&eD(n,["thought"],i);let s=eU(t,["inlineData"]);null!=s&&eD(n,["inlineData"],function(e,t){let n={};if(void 0!==eU(t,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eU(t,["data"]);null!=r&&eD(n,["data"],r);let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(0,s));let o=eU(t,["fileData"]);null!=o&&eD(n,["fileData"],function(e,t){let n={};if(void 0!==eU(t,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eU(t,["fileUri"]);null!=r&&eD(n,["fileUri"],r);let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(0,o));let a=eU(t,["thoughtSignature"]);null!=a&&eD(n,["thoughtSignature"],a);let l=eU(t,["codeExecutionResult"]);null!=l&&eD(n,["codeExecutionResult"],l);let u=eU(t,["executableCode"]);null!=u&&eD(n,["executableCode"],u);let c=eU(t,["functionCall"]);null!=c&&eD(n,["functionCall"],c);let d=eU(t,["functionResponse"]);null!=d&&eD(n,["functionResponse"],d);let p=eU(t,["text"]);return null!=p&&eD(n,["text"],p),n})(0,e))),eD(n,["parts"],e)}let i=eU(t,["role"]);return null!=i&&eD(n,["role"],i),n}function ni(e,t){let n={},r=eU(t,["prebuiltVoiceConfig"]);return null!=r&&eD(n,["prebuiltVoiceConfig"],function(e,t){let n={},r=eU(t,["voiceName"]);return null!=r&&eD(n,["voiceName"],r),n}(0,r)),n}function ns(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["contents"]);if(null!=i){let t=tT(e,i);Array.isArray(t)&&(t=t.map(t=>nr(e,t))),eD(n,["contents"],t)}let s=eU(t,["config"]);return null!=s&&eD(n,["generationConfig"],function(e,t,n){let r={},i=eU(t,["systemInstruction"]);void 0!==n&&null!=i&&eD(n,["systemInstruction"],nr(e,tw(e,i)));let s=eU(t,["temperature"]);null!=s&&eD(r,["temperature"],s);let o=eU(t,["topP"]);null!=o&&eD(r,["topP"],o);let a=eU(t,["topK"]);null!=a&&eD(r,["topK"],a);let l=eU(t,["candidateCount"]);null!=l&&eD(r,["candidateCount"],l);let u=eU(t,["maxOutputTokens"]);null!=u&&eD(r,["maxOutputTokens"],u);let c=eU(t,["stopSequences"]);null!=c&&eD(r,["stopSequences"],c);let d=eU(t,["responseLogprobs"]);null!=d&&eD(r,["responseLogprobs"],d);let p=eU(t,["logprobs"]);null!=p&&eD(r,["logprobs"],p);let f=eU(t,["presencePenalty"]);null!=f&&eD(r,["presencePenalty"],f);let h=eU(t,["frequencyPenalty"]);null!=h&&eD(r,["frequencyPenalty"],h);let m=eU(t,["seed"]);null!=m&&eD(r,["seed"],m);let g=eU(t,["responseMimeType"]);null!=g&&eD(r,["responseMimeType"],g);let y=eU(t,["responseSchema"]);if(null!=y&&eD(r,["responseSchema"],function(e,t){let n={},r=eU(t,["anyOf"]);null!=r&&eD(n,["anyOf"],r);let i=eU(t,["default"]);null!=i&&eD(n,["default"],i);let s=eU(t,["description"]);null!=s&&eD(n,["description"],s);let o=eU(t,["enum"]);null!=o&&eD(n,["enum"],o);let a=eU(t,["example"]);null!=a&&eD(n,["example"],a);let l=eU(t,["format"]);null!=l&&eD(n,["format"],l);let u=eU(t,["items"]);null!=u&&eD(n,["items"],u);let c=eU(t,["maxItems"]);null!=c&&eD(n,["maxItems"],c);let d=eU(t,["maxLength"]);null!=d&&eD(n,["maxLength"],d);let p=eU(t,["maxProperties"]);null!=p&&eD(n,["maxProperties"],p);let f=eU(t,["maximum"]);null!=f&&eD(n,["maximum"],f);let h=eU(t,["minItems"]);null!=h&&eD(n,["minItems"],h);let m=eU(t,["minLength"]);null!=m&&eD(n,["minLength"],m);let g=eU(t,["minProperties"]);null!=g&&eD(n,["minProperties"],g);let y=eU(t,["minimum"]);null!=y&&eD(n,["minimum"],y);let b=eU(t,["nullable"]);null!=b&&eD(n,["nullable"],b);let v=eU(t,["pattern"]);null!=v&&eD(n,["pattern"],v);let _=eU(t,["properties"]);null!=_&&eD(n,["properties"],_);let A=eU(t,["propertyOrdering"]);null!=A&&eD(n,["propertyOrdering"],A);let C=eU(t,["required"]);null!=C&&eD(n,["required"],C);let I=eU(t,["title"]);null!=I&&eD(n,["title"],I);let w=eU(t,["type"]);return null!=w&&eD(n,["type"],w),n}(0,tR(e,y))),void 0!==eU(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==eU(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let b=eU(t,["safetySettings"]);if(void 0!==n&&null!=b){let e=b;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={};if(void 0!==eU(t,["method"]))throw Error("method parameter is not supported in Gemini API.");let r=eU(t,["category"]);null!=r&&eD(n,["category"],r);let i=eU(t,["threshold"]);return null!=i&&eD(n,["threshold"],i),n})(0,e))),eD(n,["safetySettings"],e)}let v=eU(t,["tools"]);if(void 0!==n&&null!=v){let t=tN(e,v);Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["behavior"]);null!=r&&eD(n,["behavior"],r);let i=eU(t,["description"]);null!=i&&eD(n,["description"],i);let s=eU(t,["name"]);null!=s&&eD(n,["name"],s);let o=eU(t,["parameters"]);null!=o&&eD(n,["parameters"],o);let a=eU(t,["response"]);return null!=a&&eD(n,["response"],a),n})(0,e))),eD(n,["functionDeclarations"],e)}if(void 0!==eU(t,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=eU(t,["googleSearch"]);null!=i&&eD(n,["googleSearch"],function(e,t){let n={},r=eU(t,["timeRangeFilter"]);return null!=r&&eD(n,["timeRangeFilter"],function(e,t){let n={},r=eU(t,["startTime"]);null!=r&&eD(n,["startTime"],r);let i=eU(t,["endTime"]);return null!=i&&eD(n,["endTime"],i),n}(0,r)),n}(0,i));let s=eU(t,["googleSearchRetrieval"]);if(null!=s&&eD(n,["googleSearchRetrieval"],function(e,t){let n={},r=eU(t,["dynamicRetrievalConfig"]);return null!=r&&eD(n,["dynamicRetrievalConfig"],function(e,t){let n={},r=eU(t,["mode"]);null!=r&&eD(n,["mode"],r);let i=eU(t,["dynamicThreshold"]);return null!=i&&eD(n,["dynamicThreshold"],i),n}(0,r)),n}(0,s)),void 0!==eU(t,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==eU(t,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");let o=eU(t,["urlContext"]);null!=o&&eD(n,["urlContext"],{});let a=eU(t,["codeExecution"]);return null!=a&&eD(n,["codeExecution"],a),n})(0,tj(e,t)))),eD(n,["tools"],t)}let _=eU(t,["toolConfig"]);if(void 0!==n&&null!=_&&eD(n,["toolConfig"],function(e,t){let n={},r=eU(t,["functionCallingConfig"]);null!=r&&eD(n,["functionCallingConfig"],function(e,t){let n={},r=eU(t,["mode"]);null!=r&&eD(n,["mode"],r);let i=eU(t,["allowedFunctionNames"]);return null!=i&&eD(n,["allowedFunctionNames"],i),n}(0,r));let i=eU(t,["retrievalConfig"]);return null!=i&&eD(n,["retrievalConfig"],function(e,t){let n={},r=eU(t,["latLng"]);null!=r&&eD(n,["latLng"],function(e,t){let n={},r=eU(t,["latitude"]);null!=r&&eD(n,["latitude"],r);let i=eU(t,["longitude"]);return null!=i&&eD(n,["longitude"],i),n}(0,r));let i=eU(t,["languageCode"]);return null!=i&&eD(n,["languageCode"],i),n}(0,i)),n}(0,_)),void 0!==eU(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let A=eU(t,["cachedContent"]);void 0!==n&&null!=A&&eD(n,["cachedContent"],tD(e,A));let C=eU(t,["responseModalities"]);null!=C&&eD(r,["responseModalities"],C);let I=eU(t,["mediaResolution"]);null!=I&&eD(r,["mediaResolution"],I);let w=eU(t,["speechConfig"]);if(null!=w&&eD(r,["speechConfig"],function(e,t){let n={},r=eU(t,["voiceConfig"]);null!=r&&eD(n,["voiceConfig"],ni(e,r));let i=eU(t,["multiSpeakerVoiceConfig"]);null!=i&&eD(n,["multiSpeakerVoiceConfig"],function(e,t){let n={},r=eU(t,["speakerVoiceConfigs"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["speaker"]);null!=r&&eD(n,["speaker"],r);let i=eU(t,["voiceConfig"]);return null!=i&&eD(n,["voiceConfig"],ni(e,i)),n})(e,t))),eD(n,["speakerVoiceConfigs"],t)}return n}(e,i));let s=eU(t,["languageCode"]);return null!=s&&eD(n,["languageCode"],s),n}(e,tk(e,w))),void 0!==eU(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let O=eU(t,["thinkingConfig"]);return null!=O&&eD(r,["thinkingConfig"],function(e,t){let n={},r=eU(t,["includeThoughts"]);null!=r&&eD(n,["includeThoughts"],r);let i=eU(t,["thinkingBudget"]);return null!=i&&eD(n,["thinkingBudget"],i),n}(0,O)),r}(e,s,n)),n}function no(e,t){let n={},r=eU(t,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["videoMetadata"]);null!=r&&eD(n,["videoMetadata"],function(e,t){let n={},r=eU(t,["fps"]);null!=r&&eD(n,["fps"],r);let i=eU(t,["endOffset"]);null!=i&&eD(n,["endOffset"],i);let s=eU(t,["startOffset"]);return null!=s&&eD(n,["startOffset"],s),n}(0,r));let i=eU(t,["thought"]);null!=i&&eD(n,["thought"],i);let s=eU(t,["inlineData"]);null!=s&&eD(n,["inlineData"],function(e,t){let n={},r=eU(t,["displayName"]);null!=r&&eD(n,["displayName"],r);let i=eU(t,["data"]);null!=i&&eD(n,["data"],i);let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(0,s));let o=eU(t,["fileData"]);null!=o&&eD(n,["fileData"],function(e,t){let n={},r=eU(t,["displayName"]);null!=r&&eD(n,["displayName"],r);let i=eU(t,["fileUri"]);null!=i&&eD(n,["fileUri"],i);let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(0,o));let a=eU(t,["thoughtSignature"]);null!=a&&eD(n,["thoughtSignature"],a);let l=eU(t,["codeExecutionResult"]);null!=l&&eD(n,["codeExecutionResult"],l);let u=eU(t,["executableCode"]);null!=u&&eD(n,["executableCode"],u);let c=eU(t,["functionCall"]);null!=c&&eD(n,["functionCall"],c);let d=eU(t,["functionResponse"]);null!=d&&eD(n,["functionResponse"],d);let p=eU(t,["text"]);return null!=p&&eD(n,["text"],p),n})(0,e))),eD(n,["parts"],e)}let i=eU(t,["role"]);return null!=i&&eD(n,["role"],i),n}function na(e,t){let n={},r=eU(t,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={};if(void 0!==eU(t,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let r=eU(t,["description"]);null!=r&&eD(n,["description"],r);let i=eU(t,["name"]);null!=i&&eD(n,["name"],i);let s=eU(t,["parameters"]);null!=s&&eD(n,["parameters"],s);let o=eU(t,["response"]);return null!=o&&eD(n,["response"],o),n})(0,e))),eD(n,["functionDeclarations"],e)}let i=eU(t,["retrieval"]);null!=i&&eD(n,["retrieval"],i);let s=eU(t,["googleSearch"]);null!=s&&eD(n,["googleSearch"],function(e,t){let n={},r=eU(t,["timeRangeFilter"]);return null!=r&&eD(n,["timeRangeFilter"],function(e,t){let n={},r=eU(t,["startTime"]);null!=r&&eD(n,["startTime"],r);let i=eU(t,["endTime"]);return null!=i&&eD(n,["endTime"],i),n}(0,r)),n}(0,s));let o=eU(t,["googleSearchRetrieval"]);null!=o&&eD(n,["googleSearchRetrieval"],function(e,t){let n={},r=eU(t,["dynamicRetrievalConfig"]);return null!=r&&eD(n,["dynamicRetrievalConfig"],function(e,t){let n={},r=eU(t,["mode"]);null!=r&&eD(n,["mode"],r);let i=eU(t,["dynamicThreshold"]);return null!=i&&eD(n,["dynamicThreshold"],i),n}(0,r)),n}(0,o));let a=eU(t,["enterpriseWebSearch"]);null!=a&&eD(n,["enterpriseWebSearch"],{});let l=eU(t,["googleMaps"]);if(null!=l&&eD(n,["googleMaps"],function(e,t){let n={},r=eU(t,["authConfig"]);return null!=r&&eD(n,["authConfig"],function(e,t){let n={},r=eU(t,["apiKeyConfig"]);null!=r&&eD(n,["apiKeyConfig"],function(e,t){let n={},r=eU(t,["apiKeyString"]);return null!=r&&eD(n,["apiKeyString"],r),n}(0,r));let i=eU(t,["authType"]);null!=i&&eD(n,["authType"],i);let s=eU(t,["googleServiceAccountConfig"]);null!=s&&eD(n,["googleServiceAccountConfig"],s);let o=eU(t,["httpBasicAuthConfig"]);null!=o&&eD(n,["httpBasicAuthConfig"],o);let a=eU(t,["oauthConfig"]);null!=a&&eD(n,["oauthConfig"],a);let l=eU(t,["oidcConfig"]);return null!=l&&eD(n,["oidcConfig"],l),n}(0,r)),n}(0,l)),void 0!==eU(t,["urlContext"]))throw Error("urlContext parameter is not supported in Vertex AI.");let u=eU(t,["codeExecution"]);return null!=u&&eD(n,["codeExecution"],u),n}function nl(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["contents"]);if(null!=i){let t=tT(e,i);Array.isArray(t)&&(t=t.map(t=>no(e,t))),eD(n,["contents"],t)}let s=eU(t,["config"]);return null!=s&&eD(n,["generationConfig"],function(e,t,n){let r={},i=eU(t,["systemInstruction"]);void 0!==n&&null!=i&&eD(n,["systemInstruction"],no(e,tw(e,i)));let s=eU(t,["temperature"]);null!=s&&eD(r,["temperature"],s);let o=eU(t,["topP"]);null!=o&&eD(r,["topP"],o);let a=eU(t,["topK"]);null!=a&&eD(r,["topK"],a);let l=eU(t,["candidateCount"]);null!=l&&eD(r,["candidateCount"],l);let u=eU(t,["maxOutputTokens"]);null!=u&&eD(r,["maxOutputTokens"],u);let c=eU(t,["stopSequences"]);null!=c&&eD(r,["stopSequences"],c);let d=eU(t,["responseLogprobs"]);null!=d&&eD(r,["responseLogprobs"],d);let p=eU(t,["logprobs"]);null!=p&&eD(r,["logprobs"],p);let f=eU(t,["presencePenalty"]);null!=f&&eD(r,["presencePenalty"],f);let h=eU(t,["frequencyPenalty"]);null!=h&&eD(r,["frequencyPenalty"],h);let m=eU(t,["seed"]);null!=m&&eD(r,["seed"],m);let g=eU(t,["responseMimeType"]);null!=g&&eD(r,["responseMimeType"],g);let y=eU(t,["responseSchema"]);null!=y&&eD(r,["responseSchema"],function(e,t){let n={},r=eU(t,["anyOf"]);null!=r&&eD(n,["anyOf"],r);let i=eU(t,["default"]);null!=i&&eD(n,["default"],i);let s=eU(t,["description"]);null!=s&&eD(n,["description"],s);let o=eU(t,["enum"]);null!=o&&eD(n,["enum"],o);let a=eU(t,["example"]);null!=a&&eD(n,["example"],a);let l=eU(t,["format"]);null!=l&&eD(n,["format"],l);let u=eU(t,["items"]);null!=u&&eD(n,["items"],u);let c=eU(t,["maxItems"]);null!=c&&eD(n,["maxItems"],c);let d=eU(t,["maxLength"]);null!=d&&eD(n,["maxLength"],d);let p=eU(t,["maxProperties"]);null!=p&&eD(n,["maxProperties"],p);let f=eU(t,["maximum"]);null!=f&&eD(n,["maximum"],f);let h=eU(t,["minItems"]);null!=h&&eD(n,["minItems"],h);let m=eU(t,["minLength"]);null!=m&&eD(n,["minLength"],m);let g=eU(t,["minProperties"]);null!=g&&eD(n,["minProperties"],g);let y=eU(t,["minimum"]);null!=y&&eD(n,["minimum"],y);let b=eU(t,["nullable"]);null!=b&&eD(n,["nullable"],b);let v=eU(t,["pattern"]);null!=v&&eD(n,["pattern"],v);let _=eU(t,["properties"]);null!=_&&eD(n,["properties"],_);let A=eU(t,["propertyOrdering"]);null!=A&&eD(n,["propertyOrdering"],A);let C=eU(t,["required"]);null!=C&&eD(n,["required"],C);let I=eU(t,["title"]);null!=I&&eD(n,["title"],I);let w=eU(t,["type"]);return null!=w&&eD(n,["type"],w),n}(0,tR(e,y)));let b=eU(t,["routingConfig"]);null!=b&&eD(r,["routingConfig"],b);let v=eU(t,["modelSelectionConfig"]);null!=v&&eD(r,["modelConfig"],function(e,t){let n={},r=eU(t,["featureSelectionPreference"]);return null!=r&&eD(n,["featureSelectionPreference"],r),n}(0,v));let _=eU(t,["safetySettings"]);if(void 0!==n&&null!=_){let e=_;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["method"]);null!=r&&eD(n,["method"],r);let i=eU(t,["category"]);null!=i&&eD(n,["category"],i);let s=eU(t,["threshold"]);return null!=s&&eD(n,["threshold"],s),n})(0,e))),eD(n,["safetySettings"],e)}let A=eU(t,["tools"]);if(void 0!==n&&null!=A){let t=tN(e,A);Array.isArray(t)&&(t=t.map(t=>na(e,tj(e,t)))),eD(n,["tools"],t)}let C=eU(t,["toolConfig"]);void 0!==n&&null!=C&&eD(n,["toolConfig"],function(e,t){let n={},r=eU(t,["functionCallingConfig"]);null!=r&&eD(n,["functionCallingConfig"],function(e,t){let n={},r=eU(t,["mode"]);null!=r&&eD(n,["mode"],r);let i=eU(t,["allowedFunctionNames"]);return null!=i&&eD(n,["allowedFunctionNames"],i),n}(0,r));let i=eU(t,["retrievalConfig"]);return null!=i&&eD(n,["retrievalConfig"],function(e,t){let n={},r=eU(t,["latLng"]);null!=r&&eD(n,["latLng"],function(e,t){let n={},r=eU(t,["latitude"]);null!=r&&eD(n,["latitude"],r);let i=eU(t,["longitude"]);return null!=i&&eD(n,["longitude"],i),n}(0,r));let i=eU(t,["languageCode"]);return null!=i&&eD(n,["languageCode"],i),n}(0,i)),n}(0,C));let I=eU(t,["labels"]);void 0!==n&&null!=I&&eD(n,["labels"],I);let w=eU(t,["cachedContent"]);void 0!==n&&null!=w&&eD(n,["cachedContent"],tD(e,w));let O=eU(t,["responseModalities"]);null!=O&&eD(r,["responseModalities"],O);let T=eU(t,["mediaResolution"]);null!=T&&eD(r,["mediaResolution"],T);let E=eU(t,["speechConfig"]);null!=E&&eD(r,["speechConfig"],function(e,t){let n={},r=eU(t,["voiceConfig"]);if(null!=r&&eD(n,["voiceConfig"],function(e,t){let n={},r=eU(t,["prebuiltVoiceConfig"]);return null!=r&&eD(n,["prebuiltVoiceConfig"],function(e,t){let n={},r=eU(t,["voiceName"]);return null!=r&&eD(n,["voiceName"],r),n}(0,r)),n}(0,r)),void 0!==eU(t,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");let i=eU(t,["languageCode"]);return null!=i&&eD(n,["languageCode"],i),n}(0,tk(e,E)));let S=eU(t,["audioTimestamp"]);null!=S&&eD(r,["audioTimestamp"],S);let x=eU(t,["thinkingConfig"]);return null!=x&&eD(r,["thinkingConfig"],function(e,t){let n={},r=eU(t,["includeThoughts"]);null!=r&&eD(n,["includeThoughts"],r);let i=eU(t,["thinkingBudget"]);return null!=i&&eD(n,["thinkingBudget"],i),n}(0,x)),r}(e,s,n)),n}function nu(e,t){let n={},r=eU(t,["gcsUri"]);null!=r&&eD(n,["gcsUri"],r);let i=eU(t,["imageBytes"]);null!=i&&eD(n,["bytesBase64Encoded"],tL(e,i));let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}function nc(e,t){let n={},r=eU(t,["candidates"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["content"]);null!=r&&eD(n,["content"],function(e,t){let n={},r=eU(t,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["videoMetadata"]);null!=r&&eD(n,["videoMetadata"],function(e,t){let n={},r=eU(t,["fps"]);null!=r&&eD(n,["fps"],r);let i=eU(t,["endOffset"]);null!=i&&eD(n,["endOffset"],i);let s=eU(t,["startOffset"]);return null!=s&&eD(n,["startOffset"],s),n}(0,r));let i=eU(t,["thought"]);null!=i&&eD(n,["thought"],i);let s=eU(t,["inlineData"]);null!=s&&eD(n,["inlineData"],function(e,t){let n={},r=eU(t,["data"]);null!=r&&eD(n,["data"],r);let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(0,s));let o=eU(t,["fileData"]);null!=o&&eD(n,["fileData"],function(e,t){let n={},r=eU(t,["fileUri"]);null!=r&&eD(n,["fileUri"],r);let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(0,o));let a=eU(t,["thoughtSignature"]);null!=a&&eD(n,["thoughtSignature"],a);let l=eU(t,["codeExecutionResult"]);null!=l&&eD(n,["codeExecutionResult"],l);let u=eU(t,["executableCode"]);null!=u&&eD(n,["executableCode"],u);let c=eU(t,["functionCall"]);null!=c&&eD(n,["functionCall"],c);let d=eU(t,["functionResponse"]);null!=d&&eD(n,["functionResponse"],d);let p=eU(t,["text"]);return null!=p&&eD(n,["text"],p),n})(0,e))),eD(n,["parts"],e)}let i=eU(t,["role"]);return null!=i&&eD(n,["role"],i),n}(0,r));let i=eU(t,["citationMetadata"]);null!=i&&eD(n,["citationMetadata"],function(e,t){let n={},r=eU(t,["citationSources"]);return null!=r&&eD(n,["citations"],r),n}(0,i));let s=eU(t,["tokenCount"]);null!=s&&eD(n,["tokenCount"],s);let o=eU(t,["finishReason"]);null!=o&&eD(n,["finishReason"],o);let a=eU(t,["urlContextMetadata"]);null!=a&&eD(n,["urlContextMetadata"],function(e,t){let n={},r=eU(t,["urlMetadata"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["retrievedUrl"]);null!=r&&eD(n,["retrievedUrl"],r);let i=eU(t,["urlRetrievalStatus"]);return null!=i&&eD(n,["urlRetrievalStatus"],i),n})(0,e))),eD(n,["urlMetadata"],e)}return n}(0,a));let l=eU(t,["avgLogprobs"]);null!=l&&eD(n,["avgLogprobs"],l);let u=eU(t,["groundingMetadata"]);null!=u&&eD(n,["groundingMetadata"],u);let c=eU(t,["index"]);null!=c&&eD(n,["index"],c);let d=eU(t,["logprobsResult"]);null!=d&&eD(n,["logprobsResult"],d);let p=eU(t,["safetyRatings"]);return null!=p&&eD(n,["safetyRatings"],p),n})(e,t))),eD(n,["candidates"],t)}let i=eU(t,["modelVersion"]);null!=i&&eD(n,["modelVersion"],i);let s=eU(t,["promptFeedback"]);null!=s&&eD(n,["promptFeedback"],s);let o=eU(t,["usageMetadata"]);return null!=o&&eD(n,["usageMetadata"],o),n}function nd(e,t){let n={},r=eU(t,["safetyAttributes","categories"]);null!=r&&eD(n,["categories"],r);let i=eU(t,["safetyAttributes","scores"]);null!=i&&eD(n,["scores"],i);let s=eU(t,["contentType"]);return null!=s&&eD(n,["contentType"],s),n}function np(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["displayName"]);null!=i&&eD(n,["displayName"],i);let s=eU(t,["description"]);null!=s&&eD(n,["description"],s);let o=eU(t,["version"]);null!=o&&eD(n,["version"],o);let a=eU(t,["_self"]);null!=a&&eD(n,["tunedModelInfo"],function(e,t){let n={},r=eU(t,["baseModel"]);null!=r&&eD(n,["baseModel"],r);let i=eU(t,["createTime"]);null!=i&&eD(n,["createTime"],i);let s=eU(t,["updateTime"]);return null!=s&&eD(n,["updateTime"],s),n}(0,a));let l=eU(t,["inputTokenLimit"]);null!=l&&eD(n,["inputTokenLimit"],l);let u=eU(t,["outputTokenLimit"]);null!=u&&eD(n,["outputTokenLimit"],u);let c=eU(t,["supportedGenerationMethods"]);return null!=c&&eD(n,["supportedActions"],c),n}function nf(e,t){let n={},r=eU(t,["candidates"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["content"]);null!=r&&eD(n,["content"],function(e,t){let n={},r=eU(t,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["videoMetadata"]);null!=r&&eD(n,["videoMetadata"],function(e,t){let n={},r=eU(t,["fps"]);null!=r&&eD(n,["fps"],r);let i=eU(t,["endOffset"]);null!=i&&eD(n,["endOffset"],i);let s=eU(t,["startOffset"]);return null!=s&&eD(n,["startOffset"],s),n}(0,r));let i=eU(t,["thought"]);null!=i&&eD(n,["thought"],i);let s=eU(t,["inlineData"]);null!=s&&eD(n,["inlineData"],function(e,t){let n={},r=eU(t,["displayName"]);null!=r&&eD(n,["displayName"],r);let i=eU(t,["data"]);null!=i&&eD(n,["data"],i);let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(0,s));let o=eU(t,["fileData"]);null!=o&&eD(n,["fileData"],function(e,t){let n={},r=eU(t,["displayName"]);null!=r&&eD(n,["displayName"],r);let i=eU(t,["fileUri"]);null!=i&&eD(n,["fileUri"],i);let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(0,o));let a=eU(t,["thoughtSignature"]);null!=a&&eD(n,["thoughtSignature"],a);let l=eU(t,["codeExecutionResult"]);null!=l&&eD(n,["codeExecutionResult"],l);let u=eU(t,["executableCode"]);null!=u&&eD(n,["executableCode"],u);let c=eU(t,["functionCall"]);null!=c&&eD(n,["functionCall"],c);let d=eU(t,["functionResponse"]);null!=d&&eD(n,["functionResponse"],d);let p=eU(t,["text"]);return null!=p&&eD(n,["text"],p),n})(0,e))),eD(n,["parts"],e)}let i=eU(t,["role"]);return null!=i&&eD(n,["role"],i),n}(0,r));let i=eU(t,["citationMetadata"]);null!=i&&eD(n,["citationMetadata"],function(e,t){let n={},r=eU(t,["citations"]);return null!=r&&eD(n,["citations"],r),n}(0,i));let s=eU(t,["finishMessage"]);null!=s&&eD(n,["finishMessage"],s);let o=eU(t,["finishReason"]);null!=o&&eD(n,["finishReason"],o);let a=eU(t,["avgLogprobs"]);null!=a&&eD(n,["avgLogprobs"],a);let l=eU(t,["groundingMetadata"]);null!=l&&eD(n,["groundingMetadata"],l);let u=eU(t,["index"]);null!=u&&eD(n,["index"],u);let c=eU(t,["logprobsResult"]);null!=c&&eD(n,["logprobsResult"],c);let d=eU(t,["safetyRatings"]);return null!=d&&eD(n,["safetyRatings"],d),n})(e,t))),eD(n,["candidates"],t)}let i=eU(t,["createTime"]);null!=i&&eD(n,["createTime"],i);let s=eU(t,["responseId"]);null!=s&&eD(n,["responseId"],s);let o=eU(t,["modelVersion"]);null!=o&&eD(n,["modelVersion"],o);let a=eU(t,["promptFeedback"]);null!=a&&eD(n,["promptFeedback"],a);let l=eU(t,["usageMetadata"]);return null!=l&&eD(n,["usageMetadata"],l),n}function nh(e,t){let n={},r=eU(t,["safetyAttributes","categories"]);null!=r&&eD(n,["categories"],r);let i=eU(t,["safetyAttributes","scores"]);null!=i&&eD(n,["scores"],i);let s=eU(t,["contentType"]);return null!=s&&eD(n,["contentType"],s),n}function nm(e,t){let n={},r=eU(t,["_self"]);null!=r&&eD(n,["image"],function(e,t){let n={},r=eU(t,["gcsUri"]);null!=r&&eD(n,["gcsUri"],r);let i=eU(t,["bytesBase64Encoded"]);null!=i&&eD(n,["imageBytes"],tL(e,i));let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(e,r));let i=eU(t,["raiFilteredReason"]);null!=i&&eD(n,["raiFilteredReason"],i);let s=eU(t,["_self"]);null!=s&&eD(n,["safetyAttributes"],nh(e,s));let o=eU(t,["prompt"]);return null!=o&&eD(n,["enhancedPrompt"],o),n}function ng(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["displayName"]);null!=i&&eD(n,["displayName"],i);let s=eU(t,["description"]);null!=s&&eD(n,["description"],s);let o=eU(t,["versionId"]);null!=o&&eD(n,["version"],o);let a=eU(t,["deployedModels"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["endpoint"]);null!=r&&eD(n,["name"],r);let i=eU(t,["deployedModelId"]);return null!=i&&eD(n,["deployedModelId"],i),n})(0,e))),eD(n,["endpoints"],e)}let l=eU(t,["labels"]);null!=l&&eD(n,["labels"],l);let u=eU(t,["_self"]);null!=u&&eD(n,["tunedModelInfo"],function(e,t){let n={},r=eU(t,["labels","google-vertex-llm-tuning-base-model-id"]);null!=r&&eD(n,["baseModel"],r);let i=eU(t,["createTime"]);null!=i&&eD(n,["createTime"],i);let s=eU(t,["updateTime"]);return null!=s&&eD(n,["updateTime"],s),n}(0,u));let c=eU(t,["defaultCheckpointId"]);null!=c&&eD(n,["defaultCheckpointId"],c);let d=eU(t,["checkpoints"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["checkpointId"]);null!=r&&eD(n,["checkpointId"],r);let i=eU(t,["epoch"]);null!=i&&eD(n,["epoch"],i);let s=eU(t,["step"]);return null!=s&&eD(n,["step"],s),n})(0,e))),eD(n,["checkpoints"],e)}return n}let ny="x-goog-api-client",nb=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class nv extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:Error().stack}),this.message=e,this.name="ClientError"}}class n_ extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:Error().stack}),this.message=e,this.name="ServerError"}}class nA{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});let r={};this.clientOptions.vertexai?(r.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=null!==(n=this.clientOptions.apiVersion)&&void 0!==n?n:"v1beta",r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw Error("HTTP options are not correctly set.");let t=e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl,n=[t];return e.apiVersion&&""!==e.apiVersion&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=this.getBaseUrl(),t=new URL(e);return t.protocol="http:"==t.protocol?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw Error("HTTP options are not correctly set.")}constructUrl(e,t,n){let r=[this.getRequestUrlInternal(t)];n&&r.push(this.getBaseResourcePath()),""!==e&&r.push(e);let i=new URL(`${r.join("/")}`);return i}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,n);if(e.queryParams)for(let[t,n]of Object.entries(e.queryParams))r.searchParams.append(t,String(n));let i={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,t,e.abortSignal),this.unaryApiCall(r,i,e.httpMethod)}patchHttpOptions(e,t){let n=JSON.parse(JSON.stringify(e));for(let[e,r]of Object.entries(t))"object"==typeof r?n[e]=Object.assign(Object.assign({},n[e]),r):void 0!==r&&(n[e]=r);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,n);r.searchParams.has("alt")&&"sse"===r.searchParams.get("alt")||r.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,t,e.abortSignal),this.streamApiCall(r,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n){if(t&&t.timeout||n){let r=new AbortController,i=r.signal;t.timeout&&(null==t?void 0:t.timeout)>0&&setTimeout(()=>r.abort(),t.timeout),n&&n.addEventListener("abort",()=>{r.abort()}),e.signal=i}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await nC(e),new tn(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await nC(e),this.processStreamResponse(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}processStreamResponse(e){var t;return tK(this,arguments,function*(){let n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.getReader(),r=new TextDecoder("utf-8");if(!n)throw Error("Response body is empty");try{let t="";for(;;){let{done:i,value:s}=yield tz(n.read());if(i){if(t.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let o=r.decode(s);try{let e=JSON.parse(o);if("error"in e){let t=JSON.parse(JSON.stringify(e.error)),n=t.status,r=t.code,i=`got status: ${n}. ${JSON.stringify(e)}`;if(r>=400&&r<500){let e=new nv(i);throw e}if(r>=500&&r<600){let e=new n_(i);throw e}}}catch(e){if("ClientError"===e.name||"ServerError"===e.name)throw e}let a=(t+=o).match(nb);for(;a;){let n=a[1];try{let r=new Response(n,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield tz(new tn(r)),a=(t=t.slice(a[0].length)).match(nb)}catch(e){throw Error(`exception parsing stream chunk ${n}. ${e}`)}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw Error(`exception ${e} sending request`)})}getDefaultHeaders(){let e={},t="google-genai-sdk/1.3.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[ny]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e){let t=new Headers;if(e&&e.headers){for(let[n,r]of Object.entries(e.headers))t.append(n,r);e.timeout&&e.timeout>0&&t.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var n;let r={};null!=t&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);let i=this.clientOptions.uploader,s=await i.stat(e);r.sizeBytes=String(s.size);let o=null!==(n=null==t?void 0:t.mimeType)&&void 0!==n?n:s.type;if(void 0===o||""===o)throw Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=o;let a=await this.fetchUploadUrl(r,t);return i.upload(e,a,this)}async downloadFile(e){let t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t){var n;let r={};r=(null==t?void 0:t.httpOptions)?t.httpOptions:{apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};let i={file:e},s=await this.request({path:eN("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:r});if(!s||!(null==s?void 0:s.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let o=null===(n=null==s?void 0:s.headers)||void 0===n?void 0:n["x-goog-upload-url"];if(void 0===o)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return o}}async function nC(e){var t;if(void 0===e)throw new n_("response is undefined");if(!e.ok){let n;let r=e.status,i=e.statusText;n=(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}};let s=`got status: ${r} ${i}. ${JSON.stringify(n)}`;if(r>=400&&r<500){let e=new nv(s);throw e}if(r>=500&&r<600){let e=new n_(s);throw e}throw Error(s)}}function nI(e){for(let t of e)if(nO(t)||"object"==typeof t&&"inputSchema"in t)return!0;return!1}function nw(e){var t;let n=null!==(t=e[ny])&&void 0!==t?t:"";e[ny]=(n+" mcp_used/unknown").trimStart()}function nO(e){return null!==e&&"object"==typeof e&&e instanceof nT}class nT{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new nT(e,t)}async initialize(){var e,t,n,r;if(this.mcpTools.length>0)return;let i={},s=[];for(let u of this.mcpClients)try{for(var o,a=!0,l=(t=void 0,tW(function(e,t=100){return tK(this,arguments,function*(){let n;let r=0;for(;r<t;){let t=yield tz(e.listTools({cursor:n}));for(let e of t.tools)yield yield tz(e),r++;if(!t.nextCursor)break;n=t.nextCursor}})}(u)));!(e=(o=await l.next()).done);a=!0){r=o.value,a=!1,s.push(r);let e=r.name;if(i[e])throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);i[e]=u}}catch(e){t={error:e}}finally{try{!a&&!e&&(n=l.return)&&await n.call(l)}finally{if(t)throw t.error}}this.mcpTools=s,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),function(e,t={}){let n=[],r=new Set;for(let i of e){let e=i.name;if(r.has(e))throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);r.add(e);let s=function(e,t={}){let n={name:e.name,description:e.description,parameters:tP(function e(t){let n=new Set(["items"]),r=new Set(["anyOf"]),i=new Set(["properties"]),s={};for(let[o,a]of Object.entries(t))if(n.has(o))s[o]=e(a);else if(r.has(o))s[o]=function(t){let n=[];for(let r of t)n.push(e(r));return n}(a);else if(i.has(o))s[o]=function(t){let n={};for(let[r,i]of Object.entries(t))n[r]=e(i);return n}(a);else if("type"===o){let e=a.toUpperCase();s[o]=Object.keys(H).includes(e)?e:H.TYPE_UNSPECIFIED}else tE.has(o)&&(s[o]=a);return s}(e.inputSchema))};return t.behavior&&(n.behavior=t.behavior),{functionDeclarations:[n]}}(i,t);s.functionDeclarations&&n.push(...s.functionDeclarations)}return{functionDeclarations:n}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();let t=[];for(let n of e)if(n.name in this.functionNameToMcpClient){let e=this.functionNameToMcpClient[n.name],r=await e.callTool({name:n.name,arguments:n.args});t.push({functionResponse:{name:n.name,response:r.isError?{error:r}:r}})}return t}}function nE(...e){if(0===e.length)throw Error("No MCP clients provided");let t=e[e.length-1];return null!==t&&"object"==typeof t&&"listTools"in t&&"function"==typeof t.listTools?nT.create(e,{}):nT.create(e.slice(0,e.length-1),t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function nS(e,t,n){let r;let i=new th;r=n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data);let s=function(e,t){let n={},r=eU(t,["setupComplete"]);null!=r&&eD(n,["setupComplete"],{});let i=eU(t,["serverContent"]);null!=i&&eD(n,["serverContent"],function(e,t){let n={},r=eU(t,["audioChunks"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["data"]);null!=r&&eD(n,["data"],r);let i=eU(t,["mimeType"]);null!=i&&eD(n,["mimeType"],i);let s=eU(t,["sourceMetadata"]);return null!=s&&eD(n,["sourceMetadata"],function(e,t){let n={},r=eU(t,["clientContent"]);null!=r&&eD(n,["clientContent"],function(e,t){let n={},r=eU(t,["weightedPrompts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["text"]);null!=r&&eD(n,["text"],r);let i=eU(t,["weight"]);return null!=i&&eD(n,["weight"],i),n})(0,e))),eD(n,["weightedPrompts"],e)}return n}(0,r));let i=eU(t,["musicGenerationConfig"]);return null!=i&&eD(n,["musicGenerationConfig"],function(e,t){let n={},r=eU(t,["temperature"]);null!=r&&eD(n,["temperature"],r);let i=eU(t,["topK"]);null!=i&&eD(n,["topK"],i);let s=eU(t,["seed"]);null!=s&&eD(n,["seed"],s);let o=eU(t,["guidance"]);null!=o&&eD(n,["guidance"],o);let a=eU(t,["bpm"]);null!=a&&eD(n,["bpm"],a);let l=eU(t,["density"]);null!=l&&eD(n,["density"],l);let u=eU(t,["brightness"]);null!=u&&eD(n,["brightness"],u);let c=eU(t,["scale"]);null!=c&&eD(n,["scale"],c);let d=eU(t,["muteBass"]);null!=d&&eD(n,["muteBass"],d);let p=eU(t,["muteDrums"]);null!=p&&eD(n,["muteDrums"],p);let f=eU(t,["onlyBassAndDrums"]);return null!=f&&eD(n,["onlyBassAndDrums"],f),n}(0,i)),n}(0,s)),n})(e,t))),eD(n,["audioChunks"],t)}return n}(e,i));let s=eU(t,["filteredPrompt"]);return null!=s&&eD(n,["filteredPrompt"],function(e,t){let n={},r=eU(t,["text"]);null!=r&&eD(n,["text"],r);let i=eU(t,["filteredReason"]);return null!=i&&eD(n,["filteredReason"],i),n}(0,s)),n}(e,r);Object.assign(i,s),t(i)}class nx{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let r=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),s=function(e){let t=new Headers;for(let[n,r]of Object.entries(e))t.append(n,r);return t}(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),a=`${r}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${o}`,l=()=>{},u=new Promise(e=>{l=e}),c=e.callbacks,d=this.apiClient,p={onopen:function(){l({})},onmessage:e=>{nS(d,c.onmessage,e)},onerror:null!==(t=null==c?void 0:c.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==c?void 0:c.onclose)&&void 0!==n?n:function(e){}},f=this.webSocketFactory.create(a,function(e){let t={};return e.forEach((e,n)=>{t[n]=e}),t}(s),p);f.connect(),await u;let h=tm(this.apiClient,e.model),m=t4(this.apiClient,{model:h}),g=t9(this.apiClient,{setup:m});return f.send(JSON.stringify(g)),new nP(f,this.apiClient)}}class nP{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let t=function(e,t){let n={},r=eU(t,["weightedPrompts"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>t8(e,t))),eD(n,["weightedPrompts"],t)}return n}(this.apiClient,e),n=t3(this.apiClient,t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});let t=function(e,t){let n={},r=eU(t,["musicGenerationConfig"]);return null!=r&&eD(n,["musicGenerationConfig"],t5(e,r)),n}(this.apiClient,e),n=t9(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){let t=t9(this.apiClient,{playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(ex.PLAY)}pause(){this.sendPlaybackControl(ex.PAUSE)}stop(){this.sendPlaybackControl(ex.STOP)}resetContext(){this.sendPlaybackControl(ex.RESET_CONTEXT)}close(){this.conn.close()}}async function nR(e,t,n){let r;let i=new td;if(r=n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data),e.isVertexAI()){let t=function(e,t){let n={},r=eU(t,["setupComplete"]);null!=r&&eD(n,["setupComplete"],{});let i=eU(t,["serverContent"]);null!=i&&eD(n,["serverContent"],function(e,t){let n={},r=eU(t,["modelTurn"]);null!=r&&eD(n,["modelTurn"],function(e,t){let n={},r=eU(t,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["videoMetadata"]);null!=r&&eD(n,["videoMetadata"],function(e,t){let n={},r=eU(t,["fps"]);null!=r&&eD(n,["fps"],r);let i=eU(t,["endOffset"]);null!=i&&eD(n,["endOffset"],i);let s=eU(t,["startOffset"]);return null!=s&&eD(n,["startOffset"],s),n}(0,r));let i=eU(t,["thought"]);null!=i&&eD(n,["thought"],i);let s=eU(t,["inlineData"]);null!=s&&eD(n,["inlineData"],function(e,t){let n={},r=eU(t,["displayName"]);null!=r&&eD(n,["displayName"],r);let i=eU(t,["data"]);null!=i&&eD(n,["data"],i);let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(0,s));let o=eU(t,["fileData"]);null!=o&&eD(n,["fileData"],function(e,t){let n={},r=eU(t,["displayName"]);null!=r&&eD(n,["displayName"],r);let i=eU(t,["fileUri"]);null!=i&&eD(n,["fileUri"],i);let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(0,o));let a=eU(t,["thoughtSignature"]);null!=a&&eD(n,["thoughtSignature"],a);let l=eU(t,["codeExecutionResult"]);null!=l&&eD(n,["codeExecutionResult"],l);let u=eU(t,["executableCode"]);null!=u&&eD(n,["executableCode"],u);let c=eU(t,["functionCall"]);null!=c&&eD(n,["functionCall"],c);let d=eU(t,["functionResponse"]);null!=d&&eD(n,["functionResponse"],d);let p=eU(t,["text"]);return null!=p&&eD(n,["text"],p),n})(0,e))),eD(n,["parts"],e)}let i=eU(t,["role"]);return null!=i&&eD(n,["role"],i),n}(0,r));let i=eU(t,["turnComplete"]);null!=i&&eD(n,["turnComplete"],i);let s=eU(t,["interrupted"]);null!=s&&eD(n,["interrupted"],s);let o=eU(t,["groundingMetadata"]);null!=o&&eD(n,["groundingMetadata"],o);let a=eU(t,["generationComplete"]);null!=a&&eD(n,["generationComplete"],a);let l=eU(t,["inputTranscription"]);null!=l&&eD(n,["inputTranscription"],ne(e,l));let u=eU(t,["outputTranscription"]);return null!=u&&eD(n,["outputTranscription"],ne(e,u)),n}(e,i));let s=eU(t,["toolCall"]);null!=s&&eD(n,["toolCall"],function(e,t){let n={},r=eU(t,["functionCalls"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["args"]);null!=r&&eD(n,["args"],r);let i=eU(t,["name"]);return null!=i&&eD(n,["name"],i),n})(0,e))),eD(n,["functionCalls"],e)}return n}(0,s));let o=eU(t,["toolCallCancellation"]);null!=o&&eD(n,["toolCallCancellation"],function(e,t){let n={},r=eU(t,["ids"]);return null!=r&&eD(n,["ids"],r),n}(0,o));let a=eU(t,["usageMetadata"]);null!=a&&eD(n,["usageMetadata"],function(e,t){let n={},r=eU(t,["promptTokenCount"]);null!=r&&eD(n,["promptTokenCount"],r);let i=eU(t,["cachedContentTokenCount"]);null!=i&&eD(n,["cachedContentTokenCount"],i);let s=eU(t,["candidatesTokenCount"]);null!=s&&eD(n,["responseTokenCount"],s);let o=eU(t,["toolUsePromptTokenCount"]);null!=o&&eD(n,["toolUsePromptTokenCount"],o);let a=eU(t,["thoughtsTokenCount"]);null!=a&&eD(n,["thoughtsTokenCount"],a);let l=eU(t,["totalTokenCount"]);null!=l&&eD(n,["totalTokenCount"],l);let u=eU(t,["promptTokensDetails"]);if(null!=u){let t=u;Array.isArray(t)&&(t=t.map(t=>nn(e,t))),eD(n,["promptTokensDetails"],t)}let c=eU(t,["cacheTokensDetails"]);if(null!=c){let t=c;Array.isArray(t)&&(t=t.map(t=>nn(e,t))),eD(n,["cacheTokensDetails"],t)}let d=eU(t,["candidatesTokensDetails"]);if(null!=d){let t=d;Array.isArray(t)&&(t=t.map(t=>nn(e,t))),eD(n,["responseTokensDetails"],t)}let p=eU(t,["toolUsePromptTokensDetails"]);if(null!=p){let t=p;Array.isArray(t)&&(t=t.map(t=>nn(e,t))),eD(n,["toolUsePromptTokensDetails"],t)}let f=eU(t,["trafficType"]);return null!=f&&eD(n,["trafficType"],f),n}(e,a));let l=eU(t,["goAway"]);null!=l&&eD(n,["goAway"],function(e,t){let n={},r=eU(t,["timeLeft"]);return null!=r&&eD(n,["timeLeft"],r),n}(0,l));let u=eU(t,["sessionResumptionUpdate"]);return null!=u&&eD(n,["sessionResumptionUpdate"],function(e,t){let n={},r=eU(t,["newHandle"]);null!=r&&eD(n,["newHandle"],r);let i=eU(t,["resumable"]);null!=i&&eD(n,["resumable"],i);let s=eU(t,["lastConsumedClientMessageIndex"]);return null!=s&&eD(n,["lastConsumedClientMessageIndex"],s),n}(0,u)),n}(e,r);Object.assign(i,t)}else{let t=function(e,t){let n={},r=eU(t,["setupComplete"]);null!=r&&eD(n,["setupComplete"],{});let i=eU(t,["serverContent"]);null!=i&&eD(n,["serverContent"],function(e,t){let n={},r=eU(t,["modelTurn"]);null!=r&&eD(n,["modelTurn"],function(e,t){let n={},r=eU(t,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["videoMetadata"]);null!=r&&eD(n,["videoMetadata"],function(e,t){let n={},r=eU(t,["fps"]);null!=r&&eD(n,["fps"],r);let i=eU(t,["endOffset"]);null!=i&&eD(n,["endOffset"],i);let s=eU(t,["startOffset"]);return null!=s&&eD(n,["startOffset"],s),n}(0,r));let i=eU(t,["thought"]);null!=i&&eD(n,["thought"],i);let s=eU(t,["inlineData"]);null!=s&&eD(n,["inlineData"],function(e,t){let n={},r=eU(t,["data"]);null!=r&&eD(n,["data"],r);let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(0,s));let o=eU(t,["fileData"]);null!=o&&eD(n,["fileData"],function(e,t){let n={},r=eU(t,["fileUri"]);null!=r&&eD(n,["fileUri"],r);let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(0,o));let a=eU(t,["thoughtSignature"]);null!=a&&eD(n,["thoughtSignature"],a);let l=eU(t,["codeExecutionResult"]);null!=l&&eD(n,["codeExecutionResult"],l);let u=eU(t,["executableCode"]);null!=u&&eD(n,["executableCode"],u);let c=eU(t,["functionCall"]);null!=c&&eD(n,["functionCall"],c);let d=eU(t,["functionResponse"]);null!=d&&eD(n,["functionResponse"],d);let p=eU(t,["text"]);return null!=p&&eD(n,["text"],p),n})(0,e))),eD(n,["parts"],e)}let i=eU(t,["role"]);return null!=i&&eD(n,["role"],i),n}(0,r));let i=eU(t,["turnComplete"]);null!=i&&eD(n,["turnComplete"],i);let s=eU(t,["interrupted"]);null!=s&&eD(n,["interrupted"],s);let o=eU(t,["groundingMetadata"]);null!=o&&eD(n,["groundingMetadata"],o);let a=eU(t,["generationComplete"]);null!=a&&eD(n,["generationComplete"],a);let l=eU(t,["inputTranscription"]);null!=l&&eD(n,["inputTranscription"],t7(e,l));let u=eU(t,["outputTranscription"]);null!=u&&eD(n,["outputTranscription"],t7(e,u));let c=eU(t,["urlContextMetadata"]);return null!=c&&eD(n,["urlContextMetadata"],function(e,t){let n={},r=eU(t,["urlMetadata"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["retrievedUrl"]);null!=r&&eD(n,["retrievedUrl"],r);let i=eU(t,["urlRetrievalStatus"]);return null!=i&&eD(n,["urlRetrievalStatus"],i),n})(0,e))),eD(n,["urlMetadata"],e)}return n}(0,c)),n}(e,i));let s=eU(t,["toolCall"]);null!=s&&eD(n,["toolCall"],function(e,t){let n={},r=eU(t,["functionCalls"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["id"]);null!=r&&eD(n,["id"],r);let i=eU(t,["args"]);null!=i&&eD(n,["args"],i);let s=eU(t,["name"]);return null!=s&&eD(n,["name"],s),n})(0,e))),eD(n,["functionCalls"],e)}return n}(0,s));let o=eU(t,["toolCallCancellation"]);null!=o&&eD(n,["toolCallCancellation"],function(e,t){let n={},r=eU(t,["ids"]);return null!=r&&eD(n,["ids"],r),n}(0,o));let a=eU(t,["usageMetadata"]);null!=a&&eD(n,["usageMetadata"],function(e,t){let n={},r=eU(t,["promptTokenCount"]);null!=r&&eD(n,["promptTokenCount"],r);let i=eU(t,["cachedContentTokenCount"]);null!=i&&eD(n,["cachedContentTokenCount"],i);let s=eU(t,["responseTokenCount"]);null!=s&&eD(n,["responseTokenCount"],s);let o=eU(t,["toolUsePromptTokenCount"]);null!=o&&eD(n,["toolUsePromptTokenCount"],o);let a=eU(t,["thoughtsTokenCount"]);null!=a&&eD(n,["thoughtsTokenCount"],a);let l=eU(t,["totalTokenCount"]);null!=l&&eD(n,["totalTokenCount"],l);let u=eU(t,["promptTokensDetails"]);if(null!=u){let t=u;Array.isArray(t)&&(t=t.map(t=>nt(e,t))),eD(n,["promptTokensDetails"],t)}let c=eU(t,["cacheTokensDetails"]);if(null!=c){let t=c;Array.isArray(t)&&(t=t.map(t=>nt(e,t))),eD(n,["cacheTokensDetails"],t)}let d=eU(t,["responseTokensDetails"]);if(null!=d){let t=d;Array.isArray(t)&&(t=t.map(t=>nt(e,t))),eD(n,["responseTokensDetails"],t)}let p=eU(t,["toolUsePromptTokensDetails"]);if(null!=p){let t=p;Array.isArray(t)&&(t=t.map(t=>nt(e,t))),eD(n,["toolUsePromptTokensDetails"],t)}return n}(e,a));let l=eU(t,["goAway"]);null!=l&&eD(n,["goAway"],function(e,t){let n={},r=eU(t,["timeLeft"]);return null!=r&&eD(n,["timeLeft"],r),n}(0,l));let u=eU(t,["sessionResumptionUpdate"]);return null!=u&&eD(n,["sessionResumptionUpdate"],function(e,t){let n={},r=eU(t,["newHandle"]);null!=r&&eD(n,["newHandle"],r);let i=eU(t,["resumable"]);null!=i&&eD(n,["resumable"],i);let s=eU(t,["lastConsumedClientMessageIndex"]);return null!=s&&eD(n,["lastConsumedClientMessageIndex"],s),n}(0,u)),n}(e,r);Object.assign(i,t)}t(i)}class nk{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new nx(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,r,i,s,o;let a;let l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion(),c=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&nI(e.config.tools)&&nw(c);let d=function(e){let t=new Headers;for(let[n,r]of Object.entries(e))t.append(n,r);return t}(c);if(this.apiClient.isVertexAI())a=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d);else{let e=this.apiClient.getApiKey(),t="BidiGenerateContent",n="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),t="BidiGenerateContentConstrained",n="access_token"),a=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${t}?${n}=${e}`}let p=()=>{},f=new Promise(e=>{p=e}),h=e.callbacks,m=this.apiClient,g={onopen:function(){var e;null===(e=null==h?void 0:h.onopen)||void 0===e||e.call(h),p({})},onmessage:e=>{nR(m,h.onmessage,e)},onerror:null!==(t=null==h?void 0:h.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==h?void 0:h.onclose)&&void 0!==n?n:function(e){}},y=this.webSocketFactory.create(a,function(e){let t={};return e.forEach((e,n)=>{t[n]=e}),t}(d),g);y.connect(),await f;let b=tm(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&b.startsWith("publishers/")){let e=this.apiClient.getProject(),t=this.apiClient.getLocation();b=`projects/${e}/locations/${t}/`+b}let v={};this.apiClient.isVertexAI()&&(null===(r=e.config)||void 0===r?void 0:r.responseModalities)===void 0&&(void 0===e.config?e.config={responseModalities:[ei.AUDIO]}:e.config.responseModalities=[ei.AUDIO]),(null===(i=e.config)||void 0===i?void 0:i.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let _=null!==(o=null===(s=e.config)||void 0===s?void 0:s.tools)&&void 0!==o?o:[],A=[];for(let e of _)this.isCallableTool(e)?A.push(await e.tool()):A.push(e);A.length>0&&(e.config.tools=A);let C={model:b,config:e.config,callbacks:e.callbacks};return v=this.apiClient.isVertexAI()?function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["setup","model"],tm(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],function(e,t,n){let r=eU(t,["generationConfig"]);void 0!==n&&null!=r&&eD(n,["setup","generationConfig"],r);let i=eU(t,["responseModalities"]);void 0!==n&&null!=i&&eD(n,["setup","generationConfig","responseModalities"],i);let s=eU(t,["temperature"]);void 0!==n&&null!=s&&eD(n,["setup","generationConfig","temperature"],s);let o=eU(t,["topP"]);void 0!==n&&null!=o&&eD(n,["setup","generationConfig","topP"],o);let a=eU(t,["topK"]);void 0!==n&&null!=a&&eD(n,["setup","generationConfig","topK"],a);let l=eU(t,["maxOutputTokens"]);void 0!==n&&null!=l&&eD(n,["setup","generationConfig","maxOutputTokens"],l);let u=eU(t,["mediaResolution"]);void 0!==n&&null!=u&&eD(n,["setup","generationConfig","mediaResolution"],u);let c=eU(t,["seed"]);void 0!==n&&null!=c&&eD(n,["setup","generationConfig","seed"],c);let d=eU(t,["speechConfig"]);void 0!==n&&null!=d&&eD(n,["setup","generationConfig","speechConfig"],function(e,t){let n={},r=eU(t,["voiceConfig"]);if(null!=r&&eD(n,["voiceConfig"],function(e,t){let n={},r=eU(t,["prebuiltVoiceConfig"]);return null!=r&&eD(n,["prebuiltVoiceConfig"],function(e,t){let n={},r=eU(t,["voiceName"]);return null!=r&&eD(n,["voiceName"],r),n}(0,r)),n}(0,r)),void 0!==eU(t,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");let i=eU(t,["languageCode"]);return null!=i&&eD(n,["languageCode"],i),n}(0,tM(e,d)));let p=eU(t,["enableAffectiveDialog"]);void 0!==n&&null!=p&&eD(n,["setup","generationConfig","enableAffectiveDialog"],p);let f=eU(t,["systemInstruction"]);void 0!==n&&null!=f&&eD(n,["setup","systemInstruction"],function(e,t){let n={},r=eU(t,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["videoMetadata"]);null!=r&&eD(n,["videoMetadata"],function(e,t){let n={},r=eU(t,["fps"]);null!=r&&eD(n,["fps"],r);let i=eU(t,["endOffset"]);null!=i&&eD(n,["endOffset"],i);let s=eU(t,["startOffset"]);return null!=s&&eD(n,["startOffset"],s),n}(0,r));let i=eU(t,["thought"]);null!=i&&eD(n,["thought"],i);let s=eU(t,["inlineData"]);null!=s&&eD(n,["inlineData"],function(e,t){let n={},r=eU(t,["displayName"]);null!=r&&eD(n,["displayName"],r);let i=eU(t,["data"]);null!=i&&eD(n,["data"],i);let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(0,s));let o=eU(t,["fileData"]);null!=o&&eD(n,["fileData"],function(e,t){let n={},r=eU(t,["displayName"]);null!=r&&eD(n,["displayName"],r);let i=eU(t,["fileUri"]);null!=i&&eD(n,["fileUri"],i);let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(0,o));let a=eU(t,["thoughtSignature"]);null!=a&&eD(n,["thoughtSignature"],a);let l=eU(t,["codeExecutionResult"]);null!=l&&eD(n,["codeExecutionResult"],l);let u=eU(t,["executableCode"]);null!=u&&eD(n,["executableCode"],u);let c=eU(t,["functionCall"]);null!=c&&eD(n,["functionCall"],c);let d=eU(t,["functionResponse"]);null!=d&&eD(n,["functionResponse"],d);let p=eU(t,["text"]);return null!=p&&eD(n,["text"],p),n})(0,e))),eD(n,["parts"],e)}let i=eU(t,["role"]);return null!=i&&eD(n,["role"],i),n}(0,tw(e,f)));let h=eU(t,["tools"]);if(void 0!==n&&null!=h){let t=tN(e,h);Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={};if(void 0!==eU(t,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let r=eU(t,["description"]);null!=r&&eD(n,["description"],r);let i=eU(t,["name"]);null!=i&&eD(n,["name"],i);let s=eU(t,["parameters"]);null!=s&&eD(n,["parameters"],s);let o=eU(t,["response"]);return null!=o&&eD(n,["response"],o),n})(0,e))),eD(n,["functionDeclarations"],e)}let i=eU(t,["retrieval"]);null!=i&&eD(n,["retrieval"],i);let s=eU(t,["googleSearch"]);null!=s&&eD(n,["googleSearch"],function(e,t){let n={},r=eU(t,["timeRangeFilter"]);return null!=r&&eD(n,["timeRangeFilter"],function(e,t){let n={},r=eU(t,["startTime"]);null!=r&&eD(n,["startTime"],r);let i=eU(t,["endTime"]);return null!=i&&eD(n,["endTime"],i),n}(0,r)),n}(0,s));let o=eU(t,["googleSearchRetrieval"]);null!=o&&eD(n,["googleSearchRetrieval"],function(e,t){let n={},r=eU(t,["dynamicRetrievalConfig"]);return null!=r&&eD(n,["dynamicRetrievalConfig"],function(e,t){let n={},r=eU(t,["mode"]);null!=r&&eD(n,["mode"],r);let i=eU(t,["dynamicThreshold"]);return null!=i&&eD(n,["dynamicThreshold"],i),n}(0,r)),n}(0,o));let a=eU(t,["enterpriseWebSearch"]);null!=a&&eD(n,["enterpriseWebSearch"],{});let l=eU(t,["googleMaps"]);if(null!=l&&eD(n,["googleMaps"],function(e,t){let n={},r=eU(t,["authConfig"]);return null!=r&&eD(n,["authConfig"],function(e,t){let n={},r=eU(t,["apiKeyConfig"]);null!=r&&eD(n,["apiKeyConfig"],function(e,t){let n={},r=eU(t,["apiKeyString"]);return null!=r&&eD(n,["apiKeyString"],r),n}(0,r));let i=eU(t,["authType"]);null!=i&&eD(n,["authType"],i);let s=eU(t,["googleServiceAccountConfig"]);null!=s&&eD(n,["googleServiceAccountConfig"],s);let o=eU(t,["httpBasicAuthConfig"]);null!=o&&eD(n,["httpBasicAuthConfig"],o);let a=eU(t,["oauthConfig"]);null!=a&&eD(n,["oauthConfig"],a);let l=eU(t,["oidcConfig"]);return null!=l&&eD(n,["oidcConfig"],l),n}(0,r)),n}(0,l)),void 0!==eU(t,["urlContext"]))throw Error("urlContext parameter is not supported in Vertex AI.");let u=eU(t,["codeExecution"]);return null!=u&&eD(n,["codeExecution"],u),n})(e,tj(e,t)))),eD(n,["setup","tools"],t)}let m=eU(t,["sessionResumption"]);void 0!==n&&null!=m&&eD(n,["setup","sessionResumption"],function(e,t){let n={},r=eU(t,["handle"]);null!=r&&eD(n,["handle"],r);let i=eU(t,["transparent"]);return null!=i&&eD(n,["transparent"],i),n}(0,m));let g=eU(t,["inputAudioTranscription"]);void 0!==n&&null!=g&&eD(n,["setup","inputAudioTranscription"],{});let y=eU(t,["outputAudioTranscription"]);void 0!==n&&null!=y&&eD(n,["setup","outputAudioTranscription"],{});let b=eU(t,["realtimeInputConfig"]);void 0!==n&&null!=b&&eD(n,["setup","realtimeInputConfig"],function(e,t){let n={},r=eU(t,["automaticActivityDetection"]);null!=r&&eD(n,["automaticActivityDetection"],function(e,t){let n={},r=eU(t,["disabled"]);null!=r&&eD(n,["disabled"],r);let i=eU(t,["startOfSpeechSensitivity"]);null!=i&&eD(n,["startOfSpeechSensitivity"],i);let s=eU(t,["endOfSpeechSensitivity"]);null!=s&&eD(n,["endOfSpeechSensitivity"],s);let o=eU(t,["prefixPaddingMs"]);null!=o&&eD(n,["prefixPaddingMs"],o);let a=eU(t,["silenceDurationMs"]);return null!=a&&eD(n,["silenceDurationMs"],a),n}(0,r));let i=eU(t,["activityHandling"]);null!=i&&eD(n,["activityHandling"],i);let s=eU(t,["turnCoverage"]);return null!=s&&eD(n,["turnCoverage"],s),n}(0,b));let v=eU(t,["contextWindowCompression"]);void 0!==n&&null!=v&&eD(n,["setup","contextWindowCompression"],function(e,t){let n={},r=eU(t,["triggerTokens"]);null!=r&&eD(n,["triggerTokens"],r);let i=eU(t,["slidingWindow"]);return null!=i&&eD(n,["slidingWindow"],function(e,t){let n={},r=eU(t,["targetTokens"]);return null!=r&&eD(n,["targetTokens"],r),n}(0,i)),n}(0,v));let _=eU(t,["proactivity"]);return void 0!==n&&null!=_&&eD(n,["setup","proactivity"],function(e,t){let n={},r=eU(t,["proactiveAudio"]);return null!=r&&eD(n,["proactiveAudio"],r),n}(0,_)),{}}(e,i,n)),n}(this.apiClient,C):function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["setup","model"],tm(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],function(e,t,n){let r=eU(t,["generationConfig"]);void 0!==n&&null!=r&&eD(n,["setup","generationConfig"],r);let i=eU(t,["responseModalities"]);void 0!==n&&null!=i&&eD(n,["setup","generationConfig","responseModalities"],i);let s=eU(t,["temperature"]);void 0!==n&&null!=s&&eD(n,["setup","generationConfig","temperature"],s);let o=eU(t,["topP"]);void 0!==n&&null!=o&&eD(n,["setup","generationConfig","topP"],o);let a=eU(t,["topK"]);void 0!==n&&null!=a&&eD(n,["setup","generationConfig","topK"],a);let l=eU(t,["maxOutputTokens"]);void 0!==n&&null!=l&&eD(n,["setup","generationConfig","maxOutputTokens"],l);let u=eU(t,["mediaResolution"]);void 0!==n&&null!=u&&eD(n,["setup","generationConfig","mediaResolution"],u);let c=eU(t,["seed"]);void 0!==n&&null!=c&&eD(n,["setup","generationConfig","seed"],c);let d=eU(t,["speechConfig"]);void 0!==n&&null!=d&&eD(n,["setup","generationConfig","speechConfig"],function(e,t){let n={},r=eU(t,["voiceConfig"]);null!=r&&eD(n,["voiceConfig"],t6(e,r));let i=eU(t,["multiSpeakerVoiceConfig"]);null!=i&&eD(n,["multiSpeakerVoiceConfig"],function(e,t){let n={},r=eU(t,["speakerVoiceConfigs"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["speaker"]);null!=r&&eD(n,["speaker"],r);let i=eU(t,["voiceConfig"]);return null!=i&&eD(n,["voiceConfig"],t6(e,i)),n})(e,t))),eD(n,["speakerVoiceConfigs"],t)}return n}(e,i));let s=eU(t,["languageCode"]);return null!=s&&eD(n,["languageCode"],s),n}(e,tM(e,d)));let p=eU(t,["enableAffectiveDialog"]);void 0!==n&&null!=p&&eD(n,["setup","generationConfig","enableAffectiveDialog"],p);let f=eU(t,["systemInstruction"]);void 0!==n&&null!=f&&eD(n,["setup","systemInstruction"],function(e,t){let n={},r=eU(t,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["videoMetadata"]);null!=r&&eD(n,["videoMetadata"],function(e,t){let n={},r=eU(t,["fps"]);null!=r&&eD(n,["fps"],r);let i=eU(t,["endOffset"]);null!=i&&eD(n,["endOffset"],i);let s=eU(t,["startOffset"]);return null!=s&&eD(n,["startOffset"],s),n}(0,r));let i=eU(t,["thought"]);null!=i&&eD(n,["thought"],i);let s=eU(t,["inlineData"]);null!=s&&eD(n,["inlineData"],function(e,t){let n={};if(void 0!==eU(t,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eU(t,["data"]);null!=r&&eD(n,["data"],r);let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(0,s));let o=eU(t,["fileData"]);null!=o&&eD(n,["fileData"],function(e,t){let n={};if(void 0!==eU(t,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eU(t,["fileUri"]);null!=r&&eD(n,["fileUri"],r);let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(0,o));let a=eU(t,["thoughtSignature"]);null!=a&&eD(n,["thoughtSignature"],a);let l=eU(t,["codeExecutionResult"]);null!=l&&eD(n,["codeExecutionResult"],l);let u=eU(t,["executableCode"]);null!=u&&eD(n,["executableCode"],u);let c=eU(t,["functionCall"]);null!=c&&eD(n,["functionCall"],c);let d=eU(t,["functionResponse"]);null!=d&&eD(n,["functionResponse"],d);let p=eU(t,["text"]);return null!=p&&eD(n,["text"],p),n})(0,e))),eD(n,["parts"],e)}let i=eU(t,["role"]);return null!=i&&eD(n,["role"],i),n}(0,tw(e,f)));let h=eU(t,["tools"]);if(void 0!==n&&null!=h){let t=tN(e,h);Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["behavior"]);null!=r&&eD(n,["behavior"],r);let i=eU(t,["description"]);null!=i&&eD(n,["description"],i);let s=eU(t,["name"]);null!=s&&eD(n,["name"],s);let o=eU(t,["parameters"]);null!=o&&eD(n,["parameters"],o);let a=eU(t,["response"]);return null!=a&&eD(n,["response"],a),n})(0,e))),eD(n,["functionDeclarations"],e)}if(void 0!==eU(t,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=eU(t,["googleSearch"]);null!=i&&eD(n,["googleSearch"],function(e,t){let n={},r=eU(t,["timeRangeFilter"]);return null!=r&&eD(n,["timeRangeFilter"],function(e,t){let n={},r=eU(t,["startTime"]);null!=r&&eD(n,["startTime"],r);let i=eU(t,["endTime"]);return null!=i&&eD(n,["endTime"],i),n}(0,r)),n}(0,i));let s=eU(t,["googleSearchRetrieval"]);if(null!=s&&eD(n,["googleSearchRetrieval"],function(e,t){let n={},r=eU(t,["dynamicRetrievalConfig"]);return null!=r&&eD(n,["dynamicRetrievalConfig"],function(e,t){let n={},r=eU(t,["mode"]);null!=r&&eD(n,["mode"],r);let i=eU(t,["dynamicThreshold"]);return null!=i&&eD(n,["dynamicThreshold"],i),n}(0,r)),n}(0,s)),void 0!==eU(t,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==eU(t,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");let o=eU(t,["urlContext"]);null!=o&&eD(n,["urlContext"],{});let a=eU(t,["codeExecution"]);return null!=a&&eD(n,["codeExecution"],a),n})(0,tj(e,t)))),eD(n,["setup","tools"],t)}let m=eU(t,["sessionResumption"]);void 0!==n&&null!=m&&eD(n,["setup","sessionResumption"],function(e,t){let n={},r=eU(t,["handle"]);if(null!=r&&eD(n,["handle"],r),void 0!==eU(t,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return n}(0,m));let g=eU(t,["inputAudioTranscription"]);void 0!==n&&null!=g&&eD(n,["setup","inputAudioTranscription"],{});let y=eU(t,["outputAudioTranscription"]);void 0!==n&&null!=y&&eD(n,["setup","outputAudioTranscription"],{});let b=eU(t,["realtimeInputConfig"]);void 0!==n&&null!=b&&eD(n,["setup","realtimeInputConfig"],function(e,t){let n={},r=eU(t,["automaticActivityDetection"]);null!=r&&eD(n,["automaticActivityDetection"],function(e,t){let n={},r=eU(t,["disabled"]);null!=r&&eD(n,["disabled"],r);let i=eU(t,["startOfSpeechSensitivity"]);null!=i&&eD(n,["startOfSpeechSensitivity"],i);let s=eU(t,["endOfSpeechSensitivity"]);null!=s&&eD(n,["endOfSpeechSensitivity"],s);let o=eU(t,["prefixPaddingMs"]);null!=o&&eD(n,["prefixPaddingMs"],o);let a=eU(t,["silenceDurationMs"]);return null!=a&&eD(n,["silenceDurationMs"],a),n}(0,r));let i=eU(t,["activityHandling"]);null!=i&&eD(n,["activityHandling"],i);let s=eU(t,["turnCoverage"]);return null!=s&&eD(n,["turnCoverage"],s),n}(0,b));let v=eU(t,["contextWindowCompression"]);void 0!==n&&null!=v&&eD(n,["setup","contextWindowCompression"],function(e,t){let n={},r=eU(t,["triggerTokens"]);null!=r&&eD(n,["triggerTokens"],r);let i=eU(t,["slidingWindow"]);return null!=i&&eD(n,["slidingWindow"],function(e,t){let n={},r=eU(t,["targetTokens"]);return null!=r&&eD(n,["targetTokens"],r),n}(0,i)),n}(0,v));let _=eU(t,["proactivity"]);return void 0!==n&&null!=_&&eD(n,["setup","proactivity"],function(e,t){let n={},r=eU(t,["proactiveAudio"]);return null!=r&&eD(n,["proactiveAudio"],r),n}(0,_)),{}}(e,i,n)),n}(this.apiClient,C),delete v.config,y.send(JSON.stringify(v)),new nj(y,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}let nM={turnComplete:!0};class nj{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let n=[];try{n=tT(e,t.turns),n=e.isVertexAI()?n.map(t=>no(e,t)):n.map(t=>nr(e,t))}catch(e){throw Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses||0===(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses]).length)throw Error("functionResponses is required.");for(let t of n){if("object"!=typeof t||null===t||!("name"in t)||!("response"in t))throw Error(`Could not parse function response, type '${typeof t}'.`);if(!e.isVertexAI()&&!("id"in t))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}let r={toolResponse:{functionResponses:n}};return r}sendClientContent(e){e=Object.assign(Object.assign({},nM),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:function(e,t){let n={},r=eU(t,["media"]);if(null!=r&&eD(n,["mediaChunks"],ty(e,r)),void 0!==eU(t,["audio"]))throw Error("audio parameter is not supported in Vertex AI.");let i=eU(t,["audioStreamEnd"]);if(null!=i&&eD(n,["audioStreamEnd"],i),void 0!==eU(t,["video"]))throw Error("video parameter is not supported in Vertex AI.");if(void 0!==eU(t,["text"]))throw Error("text parameter is not supported in Vertex AI.");let s=eU(t,["activityStart"]);null!=s&&eD(n,["activityStart"],{});let o=eU(t,["activityEnd"]);return null!=o&&eD(n,["activityEnd"],{}),n}(this.apiClient,e)}:{realtimeInput:function(e,t){let n={},r=eU(t,["media"]);null!=r&&eD(n,["mediaChunks"],ty(e,r));let i=eU(t,["audio"]);null!=i&&eD(n,["audio"],function(e,t){let n=tb(e,t);if(n.mimeType&&n.mimeType.startsWith("audio/"))return n;throw Error(`Unsupported mime type: ${n.mimeType}`)}(e,i));let s=eU(t,["audioStreamEnd"]);null!=s&&eD(n,["audioStreamEnd"],s);let o=eU(t,["video"]);null!=o&&eD(n,["video"],function(e,t){let n=tb(e,t);if(n.mimeType&&n.mimeType.startsWith("image/"))return n;throw Error(`Unsupported mime type: ${n.mimeType}`)}(e,o));let a=eU(t,["text"]);null!=a&&eD(n,["text"],a);let l=eU(t,["activityStart"]);null!=l&&eD(n,["activityStart"],{});let u=eU(t,["activityEnd"]);return null!=u&&eD(n,["activityEnd"],{}),n}(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function nN(e){var t,n,r;if(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.disable)return!0;let i=!1;for(let t of null!==(n=null==e?void 0:e.tools)&&void 0!==n?n:[])if(nD(t)){i=!0;break}if(!i)return!0;let s=null===(r=null==e?void 0:e.automaticFunctionCalling)||void 0===r?void 0:r.maximumRemoteCalls;return(!!s&&(s<0||!Number.isInteger(s))||0==s)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0)}function nD(e){return"callTool"in e&&"function"==typeof e.callTool}function nU(e){var t;return!(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nL extends ej{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,r,i,s,o,a,l,u,c,d;let p,f;let h=await this.processParamsForMcpUsage(e);if(!(null!==(l=null===(a=null===(o=e.config)||void 0===o?void 0:o.tools)||void 0===a?void 0:a.some(e=>nO(e)))&&void 0!==l&&l)||nN(e.config))return await this.generateContentInternal(h);if(null!==(d=null===(c=null===(u=e.config)||void 0===u?void 0:u.tools)||void 0===c?void 0:c.some(e=>!nO(e)))&&void 0!==d&&d)throw Error("Automatic function calling with CallableTools and Tools is not yet supported.");let m=tT(this.apiClient,h.contents),g=null!==(r=null===(n=null===(t=h.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==r?r:10,y=0;for(;y<g&&(p=await this.generateContentInternal(h)).functionCalls&&0!==p.functionCalls.length;){let t=p.candidates[0].content,n=[];for(let t of null!==(s=null===(i=e.config)||void 0===i?void 0:i.tools)&&void 0!==s?s:[])if(nD(t)){let e=await t.callTool(p.functionCalls);n.push(...e)}y++,f={role:"user",parts:n},h.contents=tT(this.apiClient,h.contents),h.contents.push(t),h.contents.push(f),nU(h.config)&&(m.push(t),m.push(f))}return nU(h.config)&&(p.automaticFunctionCallingHistory=m),p},this.generateContentStream=async e=>{if(!nN(e.config))return await this.processAfcStream(e);{let t=await this.processParamsForMcpUsage(e);return await this.generateContentStreamInternal(t)}},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n;let r=[];if(null==e?void 0:e.generatedImages)for(let i of e.generatedImages)i&&(null==i?void 0:i.safetyAttributes)&&(null===(t=null==i?void 0:i.safetyAttributes)||void 0===t?void 0:t.contentType)==="Positive Prompt"?n=null==i?void 0:i.safetyAttributes:r.push(i);return n?{generatedImages:r,positivePromptSafetyAttributes:n}:{generatedImages:r}}),this.list=async e=>{var t;let n=Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config),r={config:n};if(this.apiClient.isVertexAI()&&!r.config.queryBase){if(null===(t=r.config)||void 0===t?void 0:t.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");r.config.filter="labels.tune-type:*"}return new tJ(eP.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(r),r)},this.editImage=async e=>{let t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));let n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)}}async processParamsForMcpUsage(e){var t,n,r;let i=null===(t=e.config)||void 0===t?void 0:t.tools;if(!i)return e;let s=await Promise.all(i.map(async e=>nD(e)?await e.tool():e)),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(o.config.tools=s,e.config&&e.config.tools&&nI(e.config.tools)){let t=null!==(r=null===(n=e.config.httpOptions)||void 0===n?void 0:n.headers)&&void 0!==r?r:{},i=Object.assign({},t);0===Object.keys(i).length&&(i=this.apiClient.getDefaultHeaders()),nw(i),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:i})}return o}async initAfcToolsMap(e){var t,n,r;let i=new Map;for(let s of null!==(n=null===(t=e.config)||void 0===t?void 0:t.tools)&&void 0!==n?n:[])if(nD(s)){let e=await s.tool();for(let t of null!==(r=e.functionDeclarations)&&void 0!==r?r:[]){if(!t.name)throw Error("Function declaration name is required.");if(i.has(t.name))throw Error(`Duplicate tool declaration name: ${t.name}`);i.set(t.name,s)}}return i}async processAfcStream(e){var t,n,r;let i=null!==(r=null===(n=null===(t=e.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==r?r:10,s=!1,o=0,a=await this.initAfcToolsMap(e);return function(e,t,n){var r,a;return tK(this,arguments,function*(){for(var l,u,c,d;o<i;){s&&(o++,s=!1);let m=yield tz(e.processParamsForMcpUsage(n)),g=yield tz(e.generateContentStreamInternal(m)),y=[],b=[];try{for(var p,f=!0,h=(u=void 0,tW(g));!(l=(p=yield tz(h.next())).done);f=!0)if(d=p.value,f=!1,yield yield tz(d),d.candidates&&(null===(r=d.candidates[0])||void 0===r?void 0:r.content)){for(let e of(b.push(d.candidates[0].content),null!==(a=d.candidates[0].content.parts)&&void 0!==a?a:[]))if(o<i&&e.functionCall){if(!e.functionCall.name)throw Error("Function call name was not returned by the model.");if(t.has(e.functionCall.name)){let n=yield tz(t.get(e.functionCall.name).callTool([e.functionCall]));y.push(...n)}else throw Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${e.functionCall.name}`)}}}catch(e){u={error:e}}finally{try{!f&&!l&&(c=h.return)&&(yield tz(c.call(h)))}finally{if(u)throw u.error}}if(y.length>0){s=!0;let t=new eX;t.candidates=[{content:{role:"user",parts:y}}],yield yield tz(t);let r=[];r.push(...b),r.push({role:"user",parts:y});let i=tT(e.apiClient,n.contents).concat(r);n.contents=i}else break}})}(this,a,e)}async generateContentInternal(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=nl(this.apiClient,e);return s=eN("{model}:generateContent",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=nf(this.apiClient,e),n=new eX;return Object.assign(n,t),n})}{let t=ns(this.apiClient,e);return s=eN("{model}:generateContent",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=nc(this.apiClient,e),n=new eX;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=nl(this.apiClient,e);s=eN("{model}:streamGenerateContent?alt=sse",r._url),o=r._query,delete r.config,delete r._url,delete r._query;let i=this.apiClient;return i.requestStream({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(function(e){return tK(this,arguments,function*(){var t,n,r,s;try{for(var o,a=!0,l=tW(e);!(t=(o=yield tz(l.next())).done);a=!0){s=o.value,a=!1;let e=nf(i,(yield tz(s.json()))),t=new eX;Object.assign(t,e),yield yield tz(t)}}catch(e){n={error:e}}finally{try{!a&&!t&&(r=l.return)&&(yield tz(r.call(l)))}finally{if(n)throw n.error}}})})}{let t=ns(this.apiClient,e);s=eN("{model}:streamGenerateContent?alt=sse",t._url),o=t._query,delete t.config,delete t._url,delete t._query;let n=this.apiClient;return n.requestStream({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(function(e){return tK(this,arguments,function*(){var t,r,i,s;try{for(var o,a=!0,l=tW(e);!(t=(o=yield tz(l.next())).done);a=!0){s=o.value,a=!1;let e=nc(n,(yield tz(s.json()))),t=new eX;Object.assign(t,e),yield yield tz(t)}}catch(e){r={error:e}}finally{try{!a&&!t&&(i=l.return)&&(yield tz(i.call(l)))}finally{if(r)throw r.error}}})})}}async embedContent(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["contents"]);null!=i&&eD(n,["instances[]","content"],tO(e,i));let s=eU(t,["config"]);return null!=s&&eD(n,["config"],function(e,t,n){let r=eU(t,["taskType"]);void 0!==n&&null!=r&&eD(n,["instances[]","task_type"],r);let i=eU(t,["title"]);void 0!==n&&null!=i&&eD(n,["instances[]","title"],i);let s=eU(t,["outputDimensionality"]);void 0!==n&&null!=s&&eD(n,["parameters","outputDimensionality"],s);let o=eU(t,["mimeType"]);void 0!==n&&null!=o&&eD(n,["instances[]","mimeType"],o);let a=eU(t,["autoTruncate"]);return void 0!==n&&null!=a&&eD(n,["parameters","autoTruncate"],a),{}}(0,s,n)),n}(this.apiClient,e);return s=eN("{model}:predict",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["predictions[]","embeddings"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["values"]);null!=r&&eD(n,["values"],r);let i=eU(t,["statistics"]);return null!=i&&eD(n,["statistics"],function(e,t){let n={},r=eU(t,["truncated"]);null!=r&&eD(n,["truncated"],r);let i=eU(t,["token_count"]);return null!=i&&eD(n,["tokenCount"],i),n}(0,i)),n})(0,e))),eD(n,["embeddings"],e)}let i=eU(t,["metadata"]);return null!=i&&eD(n,["metadata"],function(e,t){let n={},r=eU(t,["billableCharacterCount"]);return null!=r&&eD(n,["billableCharacterCount"],r),n}(0,i)),n}(this.apiClient,e),n=new eQ;return Object.assign(n,t),n})}{let t=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["contents"]);null!=i&&eD(n,["requests[]","content"],tO(e,i));let s=eU(t,["config"]);null!=s&&eD(n,["config"],function(e,t,n){let r=eU(t,["taskType"]);void 0!==n&&null!=r&&eD(n,["requests[]","taskType"],r);let i=eU(t,["title"]);void 0!==n&&null!=i&&eD(n,["requests[]","title"],i);let s=eU(t,["outputDimensionality"]);if(void 0!==n&&null!=s&&eD(n,["requests[]","outputDimensionality"],s),void 0!==eU(t,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==eU(t,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(0,s,n));let o=eU(t,["model"]);return void 0!==o&&eD(n,["requests[]","model"],tm(e,o)),n}(this.apiClient,e);return s=eN("{model}:batchEmbedContents",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["embeddings"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["values"]);return null!=r&&eD(n,["values"],r),n})(0,e))),eD(n,["embeddings"],e)}let i=eU(t,["metadata"]);return null!=i&&eD(n,["metadata"],{}),n}(this.apiClient,e),n=new eQ;return Object.assign(n,t),n})}}async generateImagesInternal(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["prompt"]);null!=i&&eD(n,["instances[0]","prompt"],i);let s=eU(t,["config"]);return null!=s&&eD(n,["config"],function(e,t,n){let r=eU(t,["outputGcsUri"]);void 0!==n&&null!=r&&eD(n,["parameters","storageUri"],r);let i=eU(t,["negativePrompt"]);void 0!==n&&null!=i&&eD(n,["parameters","negativePrompt"],i);let s=eU(t,["numberOfImages"]);void 0!==n&&null!=s&&eD(n,["parameters","sampleCount"],s);let o=eU(t,["aspectRatio"]);void 0!==n&&null!=o&&eD(n,["parameters","aspectRatio"],o);let a=eU(t,["guidanceScale"]);void 0!==n&&null!=a&&eD(n,["parameters","guidanceScale"],a);let l=eU(t,["seed"]);void 0!==n&&null!=l&&eD(n,["parameters","seed"],l);let u=eU(t,["safetyFilterLevel"]);void 0!==n&&null!=u&&eD(n,["parameters","safetySetting"],u);let c=eU(t,["personGeneration"]);void 0!==n&&null!=c&&eD(n,["parameters","personGeneration"],c);let d=eU(t,["includeSafetyAttributes"]);void 0!==n&&null!=d&&eD(n,["parameters","includeSafetyAttributes"],d);let p=eU(t,["includeRaiReason"]);void 0!==n&&null!=p&&eD(n,["parameters","includeRaiReason"],p);let f=eU(t,["language"]);void 0!==n&&null!=f&&eD(n,["parameters","language"],f);let h=eU(t,["outputMimeType"]);void 0!==n&&null!=h&&eD(n,["parameters","outputOptions","mimeType"],h);let m=eU(t,["outputCompressionQuality"]);void 0!==n&&null!=m&&eD(n,["parameters","outputOptions","compressionQuality"],m);let g=eU(t,["addWatermark"]);void 0!==n&&null!=g&&eD(n,["parameters","addWatermark"],g);let y=eU(t,["enhancePrompt"]);return void 0!==n&&null!=y&&eD(n,["parameters","enhancePrompt"],y),{}}(0,s,n)),n}(this.apiClient,e);return s=eN("{model}:predict",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["predictions"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>nm(e,t))),eD(n,["generatedImages"],t)}let i=eU(t,["positivePromptSafetyAttributes"]);return null!=i&&eD(n,["positivePromptSafetyAttributes"],nh(e,i)),n}(this.apiClient,e),n=new e0;return Object.assign(n,t),n})}{let t=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["prompt"]);null!=i&&eD(n,["instances[0]","prompt"],i);let s=eU(t,["config"]);return null!=s&&eD(n,["config"],function(e,t,n){if(void 0!==eU(t,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==eU(t,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let r=eU(t,["numberOfImages"]);void 0!==n&&null!=r&&eD(n,["parameters","sampleCount"],r);let i=eU(t,["aspectRatio"]);void 0!==n&&null!=i&&eD(n,["parameters","aspectRatio"],i);let s=eU(t,["guidanceScale"]);if(void 0!==n&&null!=s&&eD(n,["parameters","guidanceScale"],s),void 0!==eU(t,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let o=eU(t,["safetyFilterLevel"]);void 0!==n&&null!=o&&eD(n,["parameters","safetySetting"],o);let a=eU(t,["personGeneration"]);void 0!==n&&null!=a&&eD(n,["parameters","personGeneration"],a);let l=eU(t,["includeSafetyAttributes"]);void 0!==n&&null!=l&&eD(n,["parameters","includeSafetyAttributes"],l);let u=eU(t,["includeRaiReason"]);void 0!==n&&null!=u&&eD(n,["parameters","includeRaiReason"],u);let c=eU(t,["language"]);void 0!==n&&null!=c&&eD(n,["parameters","language"],c);let d=eU(t,["outputMimeType"]);void 0!==n&&null!=d&&eD(n,["parameters","outputOptions","mimeType"],d);let p=eU(t,["outputCompressionQuality"]);if(void 0!==n&&null!=p&&eD(n,["parameters","outputOptions","compressionQuality"],p),void 0!==eU(t,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==eU(t,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.");return{}}(0,s,n)),n}(this.apiClient,e);return s=eN("{model}:predict",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["predictions"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["_self"]);null!=r&&eD(n,["image"],function(e,t){let n={},r=eU(t,["bytesBase64Encoded"]);null!=r&&eD(n,["imageBytes"],tL(e,r));let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(e,r));let i=eU(t,["raiFilteredReason"]);null!=i&&eD(n,["raiFilteredReason"],i);let s=eU(t,["_self"]);return null!=s&&eD(n,["safetyAttributes"],nd(e,s)),n})(e,t))),eD(n,["generatedImages"],t)}let i=eU(t,["positivePromptSafetyAttributes"]);return null!=i&&eD(n,["positivePromptSafetyAttributes"],nd(e,i)),n}(this.apiClient,e),n=new e0;return Object.assign(n,t),n})}}async editImageInternal(e){var t,n;let r="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["prompt"]);null!=i&&eD(n,["instances[0]","prompt"],i);let s=eU(t,["referenceImages"]);if(null!=s){let t=s;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["referenceImage"]);null!=r&&eD(n,["referenceImage"],nu(e,r));let i=eU(t,["referenceId"]);null!=i&&eD(n,["referenceId"],i);let s=eU(t,["referenceType"]);null!=s&&eD(n,["referenceType"],s);let o=eU(t,["maskImageConfig"]);null!=o&&eD(n,["maskImageConfig"],function(e,t){let n={},r=eU(t,["maskMode"]);null!=r&&eD(n,["maskMode"],r);let i=eU(t,["segmentationClasses"]);null!=i&&eD(n,["maskClasses"],i);let s=eU(t,["maskDilation"]);return null!=s&&eD(n,["dilation"],s),n}(0,o));let a=eU(t,["controlImageConfig"]);null!=a&&eD(n,["controlImageConfig"],function(e,t){let n={},r=eU(t,["controlType"]);null!=r&&eD(n,["controlType"],r);let i=eU(t,["enableControlImageComputation"]);return null!=i&&eD(n,["computeControl"],i),n}(0,a));let l=eU(t,["styleImageConfig"]);null!=l&&eD(n,["styleImageConfig"],function(e,t){let n={},r=eU(t,["styleDescription"]);return null!=r&&eD(n,["styleDescription"],r),n}(0,l));let u=eU(t,["subjectImageConfig"]);return null!=u&&eD(n,["subjectImageConfig"],function(e,t){let n={},r=eU(t,["subjectType"]);null!=r&&eD(n,["subjectType"],r);let i=eU(t,["subjectDescription"]);return null!=i&&eD(n,["subjectDescription"],i),n}(0,u)),n})(e,t))),eD(n,["instances[0]","referenceImages"],t)}let o=eU(t,["config"]);return null!=o&&eD(n,["config"],function(e,t,n){let r=eU(t,["outputGcsUri"]);void 0!==n&&null!=r&&eD(n,["parameters","storageUri"],r);let i=eU(t,["negativePrompt"]);void 0!==n&&null!=i&&eD(n,["parameters","negativePrompt"],i);let s=eU(t,["numberOfImages"]);void 0!==n&&null!=s&&eD(n,["parameters","sampleCount"],s);let o=eU(t,["aspectRatio"]);void 0!==n&&null!=o&&eD(n,["parameters","aspectRatio"],o);let a=eU(t,["guidanceScale"]);void 0!==n&&null!=a&&eD(n,["parameters","guidanceScale"],a);let l=eU(t,["seed"]);void 0!==n&&null!=l&&eD(n,["parameters","seed"],l);let u=eU(t,["safetyFilterLevel"]);void 0!==n&&null!=u&&eD(n,["parameters","safetySetting"],u);let c=eU(t,["personGeneration"]);void 0!==n&&null!=c&&eD(n,["parameters","personGeneration"],c);let d=eU(t,["includeSafetyAttributes"]);void 0!==n&&null!=d&&eD(n,["parameters","includeSafetyAttributes"],d);let p=eU(t,["includeRaiReason"]);void 0!==n&&null!=p&&eD(n,["parameters","includeRaiReason"],p);let f=eU(t,["language"]);void 0!==n&&null!=f&&eD(n,["parameters","language"],f);let h=eU(t,["outputMimeType"]);void 0!==n&&null!=h&&eD(n,["parameters","outputOptions","mimeType"],h);let m=eU(t,["outputCompressionQuality"]);void 0!==n&&null!=m&&eD(n,["parameters","outputOptions","compressionQuality"],m);let g=eU(t,["editMode"]);void 0!==n&&null!=g&&eD(n,["parameters","editMode"],g);let y=eU(t,["baseSteps"]);return void 0!==n&&null!=y&&eD(n,["parameters","editConfig","baseSteps"],y),{}}(0,o,n)),n}(this.apiClient,e);return r=eN("{model}:predict",s._url),i=s._query,delete s.config,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["predictions"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>nm(e,t))),eD(n,["generatedImages"],t)}return n}(this.apiClient,e),n=new e1;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let r="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["image"]);null!=i&&eD(n,["instances[0]","image"],nu(e,i));let s=eU(t,["upscaleFactor"]);null!=s&&eD(n,["parameters","upscaleConfig","upscaleFactor"],s);let o=eU(t,["config"]);return null!=o&&eD(n,["config"],function(e,t,n){let r=eU(t,["includeRaiReason"]);void 0!==n&&null!=r&&eD(n,["parameters","includeRaiReason"],r);let i=eU(t,["outputMimeType"]);void 0!==n&&null!=i&&eD(n,["parameters","outputOptions","mimeType"],i);let s=eU(t,["outputCompressionQuality"]);void 0!==n&&null!=s&&eD(n,["parameters","outputOptions","compressionQuality"],s);let o=eU(t,["numberOfImages"]);void 0!==n&&null!=o&&eD(n,["parameters","sampleCount"],o);let a=eU(t,["mode"]);return void 0!==n&&null!=a&&eD(n,["parameters","mode"],a),{}}(0,o,n)),n}(this.apiClient,e);return r=eN("{model}:predict",s._url),i=s._query,delete s.config,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["predictions"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>nm(e,t))),eD(n,["generatedImages"],t)}return n}(this.apiClient,e),n=new e2;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","name"],tm(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return s=eN("{name}",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=ng(this.apiClient,e);return t})}{let t=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","name"],tm(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return s=eN("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=np(this.apiClient,e);return t})}}async listInternal(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["config"]);return null!=r&&eD(n,["config"],function(e,t,n){let r=eU(t,["pageSize"]);void 0!==n&&null!=r&&eD(n,["_query","pageSize"],r);let i=eU(t,["pageToken"]);void 0!==n&&null!=i&&eD(n,["_query","pageToken"],i);let s=eU(t,["filter"]);void 0!==n&&null!=s&&eD(n,["_query","filter"],s);let o=eU(t,["queryBase"]);return void 0!==n&&null!=o&&eD(n,["_url","models_url"],tB(e,o)),{}}(e,r,n)),n}(this.apiClient,e);return s=eN("{models_url}",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["nextPageToken"]);null!=r&&eD(n,["nextPageToken"],r);let i=eU(t,["_self"]);if(null!=i){let t=tq(e,i);Array.isArray(t)&&(t=t.map(t=>ng(e,t))),eD(n,["models"],t)}return n}(this.apiClient,e),n=new e6;return Object.assign(n,t),n})}{let t=function(e,t){let n={},r=eU(t,["config"]);return null!=r&&eD(n,["config"],function(e,t,n){let r=eU(t,["pageSize"]);void 0!==n&&null!=r&&eD(n,["_query","pageSize"],r);let i=eU(t,["pageToken"]);void 0!==n&&null!=i&&eD(n,["_query","pageToken"],i);let s=eU(t,["filter"]);void 0!==n&&null!=s&&eD(n,["_query","filter"],s);let o=eU(t,["queryBase"]);return void 0!==n&&null!=o&&eD(n,["_url","models_url"],tB(e,o)),{}}(e,r,n)),n}(this.apiClient,e);return s=eN("{models_url}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["nextPageToken"]);null!=r&&eD(n,["nextPageToken"],r);let i=eU(t,["_self"]);if(null!=i){let t=tq(e,i);Array.isArray(t)&&(t=t.map(t=>np(e,t))),eD(n,["models"],t)}return n}(this.apiClient,e),n=new e6;return Object.assign(n,t),n})}}async update(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],function(e,t,n){let r=eU(t,["displayName"]);void 0!==n&&null!=r&&eD(n,["displayName"],r);let i=eU(t,["description"]);void 0!==n&&null!=i&&eD(n,["description"],i);let s=eU(t,["defaultCheckpointId"]);return void 0!==n&&null!=s&&eD(n,["defaultCheckpointId"],s),{}}(0,i,n)),n}(this.apiClient,e);return s=eN("{model}",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=ng(this.apiClient,e);return t})}{let t=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","name"],tm(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],function(e,t,n){let r=eU(t,["displayName"]);void 0!==n&&null!=r&&eD(n,["displayName"],r);let i=eU(t,["description"]);void 0!==n&&null!=i&&eD(n,["description"],i);let s=eU(t,["defaultCheckpointId"]);return void 0!==n&&null!=s&&eD(n,["defaultCheckpointId"],s),{}}(0,i,n)),n}(this.apiClient,e);return s=eN("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=np(this.apiClient,e);return t})}}async delete(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","name"],tm(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return s=eN("{name}",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(()=>{let e=new e8;return Object.assign(e,{}),e})}{let t=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","name"],tm(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return s=eN("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(()=>{let e=new e8;return Object.assign(e,{}),e})}}async countTokens(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["contents"]);if(null!=i){let t=tT(e,i);Array.isArray(t)&&(t=t.map(t=>no(e,t))),eD(n,["contents"],t)}let s=eU(t,["config"]);return null!=s&&eD(n,["config"],function(e,t,n){let r=eU(t,["systemInstruction"]);void 0!==n&&null!=r&&eD(n,["systemInstruction"],no(e,tw(e,r)));let i=eU(t,["tools"]);if(void 0!==n&&null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>na(e,t))),eD(n,["tools"],t)}let s=eU(t,["generationConfig"]);return void 0!==n&&null!=s&&eD(n,["generationConfig"],s),{}}(e,s,n)),n}(this.apiClient,e);return s=eN("{model}:countTokens",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["totalTokens"]);return null!=r&&eD(n,["totalTokens"],r),n}(this.apiClient,e),n=new e5;return Object.assign(n,t),n})}{let t=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["contents"]);if(null!=i){let t=tT(e,i);Array.isArray(t)&&(t=t.map(t=>nr(e,t))),eD(n,["contents"],t)}let s=eU(t,["config"]);return null!=s&&eD(n,["config"],function(e,t){if(void 0!==eU(t,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==eU(t,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==eU(t,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.");return{}}(0,s)),n}(this.apiClient,e);return s=eN("{model}:countTokens",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["totalTokens"]);null!=r&&eD(n,["totalTokens"],r);let i=eU(t,["cachedContentTokenCount"]);return null!=i&&eD(n,["cachedContentTokenCount"],i),n}(this.apiClient,e),n=new e5;return Object.assign(n,t),n})}}async computeTokens(e){var t,n;let r="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["contents"]);if(null!=i){let t=tT(e,i);Array.isArray(t)&&(t=t.map(t=>no(e,t))),eD(n,["contents"],t)}let s=eU(t,["config"]);return null!=s&&eD(n,["config"],s),n}(this.apiClient,e);return r=eN("{model}:computeTokens",s._url),i=s._query,delete s.config,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["tokensInfo"]);return null!=r&&eD(n,["tokensInfo"],r),n}(this.apiClient,e),n=new e4;return Object.assign(n,t),n})}throw Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["prompt"]);null!=i&&eD(n,["instances[0]","prompt"],i);let s=eU(t,["image"]);null!=s&&eD(n,["instances[0]","image"],nu(e,s));let o=eU(t,["config"]);return null!=o&&eD(n,["config"],function(e,t,n){let r=eU(t,["numberOfVideos"]);void 0!==n&&null!=r&&eD(n,["parameters","sampleCount"],r);let i=eU(t,["outputGcsUri"]);void 0!==n&&null!=i&&eD(n,["parameters","storageUri"],i);let s=eU(t,["fps"]);void 0!==n&&null!=s&&eD(n,["parameters","fps"],s);let o=eU(t,["durationSeconds"]);void 0!==n&&null!=o&&eD(n,["parameters","durationSeconds"],o);let a=eU(t,["seed"]);void 0!==n&&null!=a&&eD(n,["parameters","seed"],a);let l=eU(t,["aspectRatio"]);void 0!==n&&null!=l&&eD(n,["parameters","aspectRatio"],l);let u=eU(t,["resolution"]);void 0!==n&&null!=u&&eD(n,["parameters","resolution"],u);let c=eU(t,["personGeneration"]);void 0!==n&&null!=c&&eD(n,["parameters","personGeneration"],c);let d=eU(t,["pubsubTopic"]);void 0!==n&&null!=d&&eD(n,["parameters","pubsubTopic"],d);let p=eU(t,["negativePrompt"]);void 0!==n&&null!=p&&eD(n,["parameters","negativePrompt"],p);let f=eU(t,["enhancePrompt"]);void 0!==n&&null!=f&&eD(n,["parameters","enhancePrompt"],f);let h=eU(t,["generateAudio"]);return void 0!==n&&null!=h&&eD(n,["parameters","generateAudio"],h),{}}(0,o,n)),n}(this.apiClient,e);return s=eN("{model}:predictLongRunning",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["metadata"]);null!=i&&eD(n,["metadata"],i);let s=eU(t,["done"]);null!=s&&eD(n,["done"],s);let o=eU(t,["error"]);null!=o&&eD(n,["error"],o);let a=eU(t,["response"]);return null!=a&&eD(n,["response"],function(e,t){let n={},r=eU(t,["videos"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["_self"]);return null!=r&&eD(n,["video"],function(e,t){let n={},r=eU(t,["gcsUri"]);null!=r&&eD(n,["uri"],r);let i=eU(t,["bytesBase64Encoded"]);null!=i&&eD(n,["videoBytes"],tL(e,i));let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(e,r)),n})(e,t))),eD(n,["generatedVideos"],t)}let i=eU(t,["raiMediaFilteredCount"]);null!=i&&eD(n,["raiMediaFilteredCount"],i);let s=eU(t,["raiMediaFilteredReasons"]);return null!=s&&eD(n,["raiMediaFilteredReasons"],s),n}(e,a)),n}(this.apiClient,e);return t})}{let t=function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["_url","model"],tm(e,r));let i=eU(t,["prompt"]);null!=i&&eD(n,["instances[0]","prompt"],i);let s=eU(t,["image"]);null!=s&&eD(n,["instances[0]","image"],function(e,t){let n={};if(void 0!==eU(t,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let r=eU(t,["imageBytes"]);null!=r&&eD(n,["bytesBase64Encoded"],tL(e,r));let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(e,s));let o=eU(t,["config"]);return null!=o&&eD(n,["config"],function(e,t,n){let r=eU(t,["numberOfVideos"]);if(void 0!==n&&null!=r&&eD(n,["parameters","sampleCount"],r),void 0!==eU(t,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==eU(t,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let i=eU(t,["durationSeconds"]);if(void 0!==n&&null!=i&&eD(n,["parameters","durationSeconds"],i),void 0!==eU(t,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let s=eU(t,["aspectRatio"]);if(void 0!==n&&null!=s&&eD(n,["parameters","aspectRatio"],s),void 0!==eU(t,["resolution"]))throw Error("resolution parameter is not supported in Gemini API.");let o=eU(t,["personGeneration"]);if(void 0!==n&&null!=o&&eD(n,["parameters","personGeneration"],o),void 0!==eU(t,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let a=eU(t,["negativePrompt"]);if(void 0!==n&&null!=a&&eD(n,["parameters","negativePrompt"],a),void 0!==eU(t,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.");if(void 0!==eU(t,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");return{}}(0,o,n)),n}(this.apiClient,e);return s=eN("{model}:predictLongRunning",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["metadata"]);null!=i&&eD(n,["metadata"],i);let s=eU(t,["done"]);null!=s&&eD(n,["done"],s);let o=eU(t,["error"]);null!=o&&eD(n,["error"],o);let a=eU(t,["response","generateVideoResponse"]);return null!=a&&eD(n,["response"],function(e,t){let n={},r=eU(t,["generatedSamples"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["_self"]);return null!=r&&eD(n,["video"],function(e,t){let n={},r=eU(t,["video","uri"]);null!=r&&eD(n,["uri"],r);let i=eU(t,["video","encodedVideo"]);null!=i&&eD(n,["videoBytes"],tL(e,i));let s=eU(t,["encoding"]);return null!=s&&eD(n,["mimeType"],s),n}(e,r)),n})(e,t))),eD(n,["generatedVideos"],t)}let i=eU(t,["raiMediaFilteredCount"]);null!=i&&eD(n,["raiMediaFilteredCount"],i);let s=eU(t,["raiMediaFilteredReasons"]);return null!=s&&eD(n,["raiMediaFilteredReasons"],s),n}(e,a)),n}(this.apiClient,e);return t})}}}function nF(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["metadata"]);null!=i&&eD(n,["metadata"],i);let s=eU(t,["done"]);null!=s&&eD(n,["done"],s);let o=eU(t,["error"]);null!=o&&eD(n,["error"],o);let a=eU(t,["response"]);return null!=a&&eD(n,["response"],function(e,t){let n={},r=eU(t,["videos"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["_self"]);return null!=r&&eD(n,["video"],function(e,t){let n={},r=eU(t,["gcsUri"]);null!=r&&eD(n,["uri"],r);let i=eU(t,["bytesBase64Encoded"]);null!=i&&eD(n,["videoBytes"],tL(e,i));let s=eU(t,["mimeType"]);return null!=s&&eD(n,["mimeType"],s),n}(e,r)),n})(e,t))),eD(n,["generatedVideos"],t)}let i=eU(t,["raiMediaFilteredCount"]);null!=i&&eD(n,["raiMediaFilteredCount"],i);let s=eU(t,["raiMediaFilteredReasons"]);return null!=s&&eD(n,["raiMediaFilteredReasons"],s),n}(e,a)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nB extends ej{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){let t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(!this.apiClient.isVertexAI())return this.getVideosOperationInternal({operationName:t.name,config:n});{let e;let r=t.name.split("/operations/")[0];return n&&"httpOptions"in n&&(e=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:e}})}}async getVideosOperationInternal(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["operationName"]);null!=r&&eD(n,["_url","operationName"],r);let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return s=eN("{operationName}",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=nF(this.apiClient,e);return t})}{let t=/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e,t){let n={},r=eU(t,["operationName"]);null!=r&&eD(n,["_url","operationName"],r);let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return s=eN("{operationName}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["metadata"]);null!=i&&eD(n,["metadata"],i);let s=eU(t,["done"]);null!=s&&eD(n,["done"],s);let o=eU(t,["error"]);null!=o&&eD(n,["error"],o);let a=eU(t,["response","generateVideoResponse"]);return null!=a&&eD(n,["response"],function(e,t){let n={},r=eU(t,["generatedSamples"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["_self"]);return null!=r&&eD(n,["video"],function(e,t){let n={},r=eU(t,["video","uri"]);null!=r&&eD(n,["uri"],r);let i=eU(t,["video","encodedVideo"]);null!=i&&eD(n,["videoBytes"],tL(e,i));let s=eU(t,["encoding"]);return null!=s&&eD(n,["mimeType"],s),n}(e,r)),n})(e,t))),eD(n,["generatedVideos"],t)}let i=eU(t,["raiMediaFilteredCount"]);null!=i&&eD(n,["raiMediaFilteredCount"],i);let s=eU(t,["raiMediaFilteredReasons"]);return null!=s&&eD(n,["raiMediaFilteredReasons"],s),n}(e,a)),n}(this.apiClient,e);return t})}}async fetchPredictVideosOperationInternal(e){var t,n;let r="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let n={},r=eU(t,["operationName"]);null!=r&&eD(n,["operationName"],r);let i=eU(t,["resourceName"]);null!=i&&eD(n,["_url","resourceName"],i);let s=eU(t,["config"]);return null!=s&&eD(n,["config"],s),n}(this.apiClient,e);return r=eN("{resourceName}:fetchPredictOperation",s._url),i=s._query,delete s.config,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=nF(this.apiClient,e);return t})}throw Error("This method is only supported by the Vertex AI.")}}function nq(e,t){let n={},r=eU(t,["prebuiltVoiceConfig"]);return null!=r&&eD(n,["prebuiltVoiceConfig"],/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e,t){let n={},r=eU(t,["voiceName"]);return null!=r&&eD(n,["voiceName"],r),n}(0,r)),n}class n$ extends ej{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let r="",i={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let s=function(e,t){let n={},r=eU(t,["config"]);return null!=r&&eD(n,["config"],function(e,t,n){let r=eU(t,["expireTime"]);void 0!==n&&null!=r&&eD(n,["expireTime"],r);let i=eU(t,["newSessionExpireTime"]);void 0!==n&&null!=i&&eD(n,["newSessionExpireTime"],i);let s=eU(t,["uses"]);void 0!==n&&null!=s&&eD(n,["uses"],s);let o=eU(t,["liveConnectConstraints"]);void 0!==n&&null!=o&&eD(n,["bidiGenerateContentSetup"],function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["setup","model"],tm(e,r));let i=eU(t,["config"]);return null!=i&&eD(n,["config"],function(e,t,n){let r=eU(t,["generationConfig"]);void 0!==n&&null!=r&&eD(n,["setup","generationConfig"],r);let i=eU(t,["responseModalities"]);void 0!==n&&null!=i&&eD(n,["setup","generationConfig","responseModalities"],i);let s=eU(t,["temperature"]);void 0!==n&&null!=s&&eD(n,["setup","generationConfig","temperature"],s);let o=eU(t,["topP"]);void 0!==n&&null!=o&&eD(n,["setup","generationConfig","topP"],o);let a=eU(t,["topK"]);void 0!==n&&null!=a&&eD(n,["setup","generationConfig","topK"],a);let l=eU(t,["maxOutputTokens"]);void 0!==n&&null!=l&&eD(n,["setup","generationConfig","maxOutputTokens"],l);let u=eU(t,["mediaResolution"]);void 0!==n&&null!=u&&eD(n,["setup","generationConfig","mediaResolution"],u);let c=eU(t,["seed"]);void 0!==n&&null!=c&&eD(n,["setup","generationConfig","seed"],c);let d=eU(t,["speechConfig"]);void 0!==n&&null!=d&&eD(n,["setup","generationConfig","speechConfig"],function(e,t){let n={},r=eU(t,["voiceConfig"]);null!=r&&eD(n,["voiceConfig"],nq(e,r));let i=eU(t,["multiSpeakerVoiceConfig"]);null!=i&&eD(n,["multiSpeakerVoiceConfig"],function(e,t){let n={},r=eU(t,["speakerVoiceConfigs"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["speaker"]);null!=r&&eD(n,["speaker"],r);let i=eU(t,["voiceConfig"]);return null!=i&&eD(n,["voiceConfig"],nq(e,i)),n})(e,t))),eD(n,["speakerVoiceConfigs"],t)}return n}(e,i));let s=eU(t,["languageCode"]);return null!=s&&eD(n,["languageCode"],s),n}(e,tM(e,d)));let p=eU(t,["enableAffectiveDialog"]);void 0!==n&&null!=p&&eD(n,["setup","generationConfig","enableAffectiveDialog"],p);let f=eU(t,["systemInstruction"]);void 0!==n&&null!=f&&eD(n,["setup","systemInstruction"],function(e,t){let n={},r=eU(t,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["videoMetadata"]);null!=r&&eD(n,["videoMetadata"],function(e,t){let n={},r=eU(t,["fps"]);null!=r&&eD(n,["fps"],r);let i=eU(t,["endOffset"]);null!=i&&eD(n,["endOffset"],i);let s=eU(t,["startOffset"]);return null!=s&&eD(n,["startOffset"],s),n}(0,r));let i=eU(t,["thought"]);null!=i&&eD(n,["thought"],i);let s=eU(t,["inlineData"]);null!=s&&eD(n,["inlineData"],function(e,t){let n={};if(void 0!==eU(t,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eU(t,["data"]);null!=r&&eD(n,["data"],r);let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(0,s));let o=eU(t,["fileData"]);null!=o&&eD(n,["fileData"],function(e,t){let n={};if(void 0!==eU(t,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eU(t,["fileUri"]);null!=r&&eD(n,["fileUri"],r);let i=eU(t,["mimeType"]);return null!=i&&eD(n,["mimeType"],i),n}(0,o));let a=eU(t,["thoughtSignature"]);null!=a&&eD(n,["thoughtSignature"],a);let l=eU(t,["codeExecutionResult"]);null!=l&&eD(n,["codeExecutionResult"],l);let u=eU(t,["executableCode"]);null!=u&&eD(n,["executableCode"],u);let c=eU(t,["functionCall"]);null!=c&&eD(n,["functionCall"],c);let d=eU(t,["functionResponse"]);null!=d&&eD(n,["functionResponse"],d);let p=eU(t,["text"]);return null!=p&&eD(n,["text"],p),n})(0,e))),eD(n,["parts"],e)}let i=eU(t,["role"]);return null!=i&&eD(n,["role"],i),n}(0,tw(e,f)));let h=eU(t,["tools"]);if(void 0!==n&&null!=h){let t=tN(e,h);Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},r=eU(t,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["behavior"]);null!=r&&eD(n,["behavior"],r);let i=eU(t,["description"]);null!=i&&eD(n,["description"],i);let s=eU(t,["name"]);null!=s&&eD(n,["name"],s);let o=eU(t,["parameters"]);null!=o&&eD(n,["parameters"],o);let a=eU(t,["response"]);return null!=a&&eD(n,["response"],a),n})(0,e))),eD(n,["functionDeclarations"],e)}if(void 0!==eU(t,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=eU(t,["googleSearch"]);null!=i&&eD(n,["googleSearch"],function(e,t){let n={},r=eU(t,["timeRangeFilter"]);return null!=r&&eD(n,["timeRangeFilter"],function(e,t){let n={},r=eU(t,["startTime"]);null!=r&&eD(n,["startTime"],r);let i=eU(t,["endTime"]);return null!=i&&eD(n,["endTime"],i),n}(0,r)),n}(0,i));let s=eU(t,["googleSearchRetrieval"]);if(null!=s&&eD(n,["googleSearchRetrieval"],function(e,t){let n={},r=eU(t,["dynamicRetrievalConfig"]);return null!=r&&eD(n,["dynamicRetrievalConfig"],function(e,t){let n={},r=eU(t,["mode"]);null!=r&&eD(n,["mode"],r);let i=eU(t,["dynamicThreshold"]);return null!=i&&eD(n,["dynamicThreshold"],i),n}(0,r)),n}(0,s)),void 0!==eU(t,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(void 0!==eU(t,["googleMaps"]))throw Error("googleMaps parameter is not supported in Gemini API.");let o=eU(t,["urlContext"]);null!=o&&eD(n,["urlContext"],{});let a=eU(t,["codeExecution"]);return null!=a&&eD(n,["codeExecution"],a),n})(0,tj(e,t)))),eD(n,["setup","tools"],t)}let m=eU(t,["sessionResumption"]);void 0!==n&&null!=m&&eD(n,["setup","sessionResumption"],function(e,t){let n={},r=eU(t,["handle"]);if(null!=r&&eD(n,["handle"],r),void 0!==eU(t,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return n}(0,m));let g=eU(t,["inputAudioTranscription"]);void 0!==n&&null!=g&&eD(n,["setup","inputAudioTranscription"],{});let y=eU(t,["outputAudioTranscription"]);void 0!==n&&null!=y&&eD(n,["setup","outputAudioTranscription"],{});let b=eU(t,["realtimeInputConfig"]);void 0!==n&&null!=b&&eD(n,["setup","realtimeInputConfig"],function(e,t){let n={},r=eU(t,["automaticActivityDetection"]);null!=r&&eD(n,["automaticActivityDetection"],function(e,t){let n={},r=eU(t,["disabled"]);null!=r&&eD(n,["disabled"],r);let i=eU(t,["startOfSpeechSensitivity"]);null!=i&&eD(n,["startOfSpeechSensitivity"],i);let s=eU(t,["endOfSpeechSensitivity"]);null!=s&&eD(n,["endOfSpeechSensitivity"],s);let o=eU(t,["prefixPaddingMs"]);null!=o&&eD(n,["prefixPaddingMs"],o);let a=eU(t,["silenceDurationMs"]);return null!=a&&eD(n,["silenceDurationMs"],a),n}(0,r));let i=eU(t,["activityHandling"]);null!=i&&eD(n,["activityHandling"],i);let s=eU(t,["turnCoverage"]);return null!=s&&eD(n,["turnCoverage"],s),n}(0,b));let v=eU(t,["contextWindowCompression"]);void 0!==n&&null!=v&&eD(n,["setup","contextWindowCompression"],function(e,t){let n={},r=eU(t,["triggerTokens"]);null!=r&&eD(n,["triggerTokens"],r);let i=eU(t,["slidingWindow"]);return null!=i&&eD(n,["slidingWindow"],function(e,t){let n={},r=eU(t,["targetTokens"]);return null!=r&&eD(n,["targetTokens"],r),n}(0,i)),n}(0,v));let _=eU(t,["proactivity"]);return void 0!==n&&null!=_&&eD(n,["setup","proactivity"],function(e,t){let n={},r=eU(t,["proactiveAudio"]);return null!=r&&eD(n,["proactiveAudio"],r),n}(0,_)),{}}(e,i,n)),n}(e,o));let a=eU(t,["lockAdditionalFields"]);return void 0!==n&&null!=a&&eD(n,["fieldMask"],a),{}}(e,r,n)),n}(this.apiClient,e);r=eN("auth_tokens",s._url),i=s._query,delete s.config,delete s._url,delete s._query;let o=function(e,t){let n=null,r=e.bidiGenerateContentSetup;if("object"==typeof r&&null!==r&&"setup"in r){let t=r.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup}else void 0!==r&&delete e.bidiGenerateContentSetup;let i=e.fieldMask;if(n){let r=/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e){let t=[];for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let r=e[n];if("object"==typeof r&&null!=r&&Object.keys(r).length>0){let e=Object.keys(r).map(e=>`${n}.${e}`);t.push(...e)}else t.push(n)}return t.join(",")}(n);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&(null==t?void 0:t.lockAdditionalFields.length)===0)r?e.fieldMask=r:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==i&&Array.isArray(i)&&i.length>0){let t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],n=[];i.length>0&&(n=i.map(e=>t.includes(e)?`generationConfig.${e}`:e));let s=[];r&&s.push(r),n.length>0&&s.push(...n),s.length>0?e.fieldMask=s.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==i&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}(s,e.config);return this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["name"]);return null!=r&&eD(n,["name"],r),n}(this.apiClient,e);return t})}}}function nV(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["state"]);null!=i&&eD(n,["state"],tU(e,i));let s=eU(t,["createTime"]);null!=s&&eD(n,["createTime"],s);let o=eU(t,["tuningTask","startTime"]);null!=o&&eD(n,["startTime"],o);let a=eU(t,["tuningTask","completeTime"]);null!=a&&eD(n,["endTime"],a);let l=eU(t,["updateTime"]);null!=l&&eD(n,["updateTime"],l);let u=eU(t,["description"]);null!=u&&eD(n,["description"],u);let c=eU(t,["baseModel"]);null!=c&&eD(n,["baseModel"],c);let d=eU(t,["_self"]);null!=d&&eD(n,["tunedModel"],function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["model"],r);let i=eU(t,["name"]);return null!=i&&eD(n,["endpoint"],i),n}(0,d));let p=eU(t,["distillationSpec"]);null!=p&&eD(n,["distillationSpec"],p);let f=eU(t,["experiment"]);null!=f&&eD(n,["experiment"],f);let h=eU(t,["labels"]);null!=h&&eD(n,["labels"],h);let m=eU(t,["pipelineJob"]);null!=m&&eD(n,["pipelineJob"],m);let g=eU(t,["serviceAccount"]);null!=g&&eD(n,["serviceAccount"],g);let y=eU(t,["tunedModelDisplayName"]);return null!=y&&eD(n,["tunedModelDisplayName"],y),n}function nZ(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["state"]);null!=i&&eD(n,["state"],tU(e,i));let s=eU(t,["createTime"]);null!=s&&eD(n,["createTime"],s);let o=eU(t,["startTime"]);null!=o&&eD(n,["startTime"],o);let a=eU(t,["endTime"]);null!=a&&eD(n,["endTime"],a);let l=eU(t,["updateTime"]);null!=l&&eD(n,["updateTime"],l);let u=eU(t,["error"]);null!=u&&eD(n,["error"],u);let c=eU(t,["description"]);null!=c&&eD(n,["description"],c);let d=eU(t,["baseModel"]);null!=d&&eD(n,["baseModel"],d);let p=eU(t,["tunedModel"]);null!=p&&eD(n,["tunedModel"],function(e,t){let n={},r=eU(t,["model"]);null!=r&&eD(n,["model"],r);let i=eU(t,["endpoint"]);null!=i&&eD(n,["endpoint"],i);let s=eU(t,["checkpoints"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["checkpointId"]);null!=r&&eD(n,["checkpointId"],r);let i=eU(t,["epoch"]);null!=i&&eD(n,["epoch"],i);let s=eU(t,["step"]);null!=s&&eD(n,["step"],s);let o=eU(t,["endpoint"]);return null!=o&&eD(n,["endpoint"],o),n})(0,e))),eD(n,["checkpoints"],e)}return n}(0,p));let f=eU(t,["supervisedTuningSpec"]);null!=f&&eD(n,["supervisedTuningSpec"],f);let h=eU(t,["tuningDataStats"]);null!=h&&eD(n,["tuningDataStats"],h);let m=eU(t,["encryptionSpec"]);null!=m&&eD(n,["encryptionSpec"],m);let g=eU(t,["partnerModelTuningSpec"]);null!=g&&eD(n,["partnerModelTuningSpec"],g);let y=eU(t,["distillationSpec"]);null!=y&&eD(n,["distillationSpec"],y);let b=eU(t,["experiment"]);null!=b&&eD(n,["experiment"],b);let v=eU(t,["labels"]);null!=v&&eD(n,["labels"],v);let _=eU(t,["pipelineJob"]);null!=_&&eD(n,["pipelineJob"],_);let A=eU(t,["serviceAccount"]);null!=A&&eD(n,["serviceAccount"],A);let C=eU(t,["tunedModelDisplayName"]);return null!=C&&eD(n,["tunedModelDisplayName"],C),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nG extends ej{constructor(e){super(),this.apiClient=e,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new tJ(eP.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.tune=async e=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(e);{let t=await this.tuneMldevInternal(e),n="";void 0!==t.metadata&&void 0!==t.metadata.tunedModel?n=t.metadata.tunedModel:void 0!==t.name&&t.name.includes("/operations/")&&(n=t.name.split("/operations/")[0]);let r={name:n,state:eo.JOB_STATE_QUEUED};return r}}}async getInternal(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["_url","name"],r);let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return s=eN("{name}",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=nZ(this.apiClient,e);return t})}{let t=/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["_url","name"],r);let i=eU(t,["config"]);return null!=i&&eD(n,["config"],i),n}(this.apiClient,e);return s=eN("{name}",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=nV(this.apiClient,e);return t})}}async listInternal(e){var t,n,r,i;let s="",o={};if(this.apiClient.isVertexAI()){let r=function(e,t){let n={},r=eU(t,["config"]);return null!=r&&eD(n,["config"],function(e,t,n){let r=eU(t,["pageSize"]);void 0!==n&&null!=r&&eD(n,["_query","pageSize"],r);let i=eU(t,["pageToken"]);void 0!==n&&null!=i&&eD(n,["_query","pageToken"],i);let s=eU(t,["filter"]);return void 0!==n&&null!=s&&eD(n,["_query","filter"],s),{}}(0,r,n)),n}(this.apiClient,e);return s=eN("tuningJobs",r._url),o=r._query,delete r.config,delete r._url,delete r._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["nextPageToken"]);null!=r&&eD(n,["nextPageToken"],r);let i=eU(t,["tuningJobs"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>nZ(e,t))),eD(n,["tuningJobs"],t)}return n}(this.apiClient,e),n=new e9;return Object.assign(n,t),n})}{let t=function(e,t){let n={},r=eU(t,["config"]);return null!=r&&eD(n,["config"],function(e,t,n){let r=eU(t,["pageSize"]);void 0!==n&&null!=r&&eD(n,["_query","pageSize"],r);let i=eU(t,["pageToken"]);void 0!==n&&null!=i&&eD(n,["_query","pageToken"],i);let s=eU(t,["filter"]);return void 0!==n&&null!=s&&eD(n,["_query","filter"],s),{}}(0,r,n)),n}(this.apiClient,e);return s=eN("tunedModels",t._url),o=t._query,delete t.config,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["nextPageToken"]);null!=r&&eD(n,["nextPageToken"],r);let i=eU(t,["tunedModels"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>nV(e,t))),eD(n,["tuningJobs"],t)}return n}(this.apiClient,e),n=new e9;return Object.assign(n,t),n})}}async tuneInternal(e){var t,n;let r="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let n={},r=eU(t,["baseModel"]);null!=r&&eD(n,["baseModel"],r);let i=eU(t,["trainingDataset"]);null!=i&&eD(n,["supervisedTuningSpec","trainingDatasetUri"],function(e,t,n){let r=eU(t,["gcsUri"]);if(void 0!==n&&null!=r&&eD(n,["supervisedTuningSpec","trainingDatasetUri"],r),void 0!==eU(t,["examples"]))throw Error("examples parameter is not supported in Vertex AI.");return{}}(0,i,n));let s=eU(t,["config"]);return null!=s&&eD(n,["config"],function(e,t,n){let r=eU(t,["validationDataset"]);void 0!==n&&null!=r&&eD(n,["supervisedTuningSpec"],function(e,t){let n={},r=eU(t,["gcsUri"]);return null!=r&&eD(n,["validationDatasetUri"],r),n}(0,r));let i=eU(t,["tunedModelDisplayName"]);void 0!==n&&null!=i&&eD(n,["tunedModelDisplayName"],i);let s=eU(t,["description"]);void 0!==n&&null!=s&&eD(n,["description"],s);let o=eU(t,["epochCount"]);void 0!==n&&null!=o&&eD(n,["supervisedTuningSpec","hyperParameters","epochCount"],o);let a=eU(t,["learningRateMultiplier"]);void 0!==n&&null!=a&&eD(n,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],a);let l=eU(t,["exportLastCheckpointOnly"]);void 0!==n&&null!=l&&eD(n,["supervisedTuningSpec","exportLastCheckpointOnly"],l);let u=eU(t,["adapterSize"]);if(void 0!==n&&null!=u&&eD(n,["supervisedTuningSpec","hyperParameters","adapterSize"],u),void 0!==eU(t,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==eU(t,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");return{}}(0,s,n)),n}(this.apiClient,e);return r=eN("tuningJobs",s._url),i=s._query,delete s.config,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=nZ(this.apiClient,e);return t})}throw Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let r="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e,t){let n={},r=eU(t,["baseModel"]);null!=r&&eD(n,["baseModel"],r);let i=eU(t,["trainingDataset"]);null!=i&&eD(n,["tuningTask","trainingData"],function(e,t){let n={};if(void 0!==eU(t,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let r=eU(t,["examples"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e,t){let n={},r=eU(t,["textInput"]);null!=r&&eD(n,["textInput"],r);let i=eU(t,["output"]);return null!=i&&eD(n,["output"],i),n})(0,e))),eD(n,["examples","examples"],e)}return n}(0,i));let s=eU(t,["config"]);return null!=s&&eD(n,["config"],function(e,t,n){let r={};if(void 0!==eU(t,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let i=eU(t,["tunedModelDisplayName"]);if(void 0!==n&&null!=i&&eD(n,["displayName"],i),void 0!==eU(t,["description"]))throw Error("description parameter is not supported in Gemini API.");let s=eU(t,["epochCount"]);void 0!==n&&null!=s&&eD(n,["tuningTask","hyperparameters","epochCount"],s);let o=eU(t,["learningRateMultiplier"]);if(null!=o&&eD(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),void 0!==eU(t,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==eU(t,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let a=eU(t,["batchSize"]);void 0!==n&&null!=a&&eD(n,["tuningTask","hyperparameters","batchSize"],a);let l=eU(t,["learningRate"]);return void 0!==n&&null!=l&&eD(n,["tuningTask","hyperparameters","learningRate"],l),r}(0,s,n)),n}(this.apiClient,e);return r=eN("tunedModels",s._url),i=s._query,delete s.config,delete s._url,delete s._query,this.apiClient.request({path:r,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e,t){let n={},r=eU(t,["name"]);null!=r&&eD(n,["name"],r);let i=eU(t,["metadata"]);null!=i&&eD(n,["metadata"],i);let s=eU(t,["done"]);null!=s&&eD(n,["done"],s);let o=eU(t,["error"]);return null!=o&&eD(n,["error"],o),n}(this.apiClient,e);return t})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nJ{async download(e,t){throw Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}let nH="x-goog-upload-status";async function nz(e,t,n){var r,i,s;let o=0,a=0,l=new tn(new Response),u="upload";for(o=e.size;a<o;){let s=Math.min(8388608,o-a),c=e.slice(a,a+s);a+s>=o&&(u+=", finalize");let d=0,p=1e3;for(;d<3&&(null===(r=null==(l=await n.request({path:"",body:c,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(s)}}}))?void 0:l.headers)||void 0===r||!r[nH]);)d++,await function(e){return new Promise(t=>setTimeout(t,e))}(p),p*=2;if(a+=s,(null===(i=null==l?void 0:l.headers)||void 0===i?void 0:i[nH])!=="active")break;if(o<=a)throw Error("All content has been uploaded, but the upload status is not finalized.")}let c=await (null==l?void 0:l.json());if((null===(s=null==l?void 0:l.headers)||void 0===s?void 0:s[nH])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return c.file}async function nK(e){let t={size:e.size,type:e.type};return t}class nW{async upload(e,t,n){if("string"==typeof e)throw Error("File path is not supported in browser uploader.");return await nz(e,t,n)}async stat(e){if("string"!=typeof e)return await nK(e);throw Error("File path is not supported in browser uploader.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nY{create(e,t,n){return new nX(e,t,n)}}class nX{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let nQ="x-goog-api-key";class n0{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(null===e.get(nQ)){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw Error("API key is missing. Please provide a valid API key.");e.append(nQ,this.apiKey)}}}class n1{constructor(e){var t;if(null==e.apiKey)throw Error("An API Key must be set when running in a browser");if(e.project||e.location)throw Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(t=e.vertexai)&&void 0!==t&&t,this.apiKey=e.apiKey;let n=function(e,t,n){var s,o,a;if(!(null===(s=e.httpOptions)||void 0===s?void 0:s.baseUrl)){let s={geminiUrl:r,vertexUrl:i};return e.vertexai?null!==(o=s.vertexUrl)&&void 0!==o?o:t:null!==(a=s.geminiUrl)&&void 0!==a?a:n}return e.httpOptions.baseUrl}(e,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion;let s=new n0(this.apiKey);this.apiClient=new nA({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:"gl-node/web",uploader:new nW,downloader:new nJ}),this.models=new nL(this.apiClient),this.live=new nk(this.apiClient,s,new nY),this.chats=new tQ(this.models,this.apiClient),this.caches=new tH(this.apiClient),this.files=new t2(this.apiClient),this.operations=new nB(this.apiClient),this.authTokens=new n$(this.apiClient),this.tunings=new nG(this.apiClient)}}},{zod:"4FiJy","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"4FiJy":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n);var i=e("./v3/index.js"),s=r.interopDefault(i);r.exportAll(i,n),n.default=s.default},{"./v3/index.js":"84O9Q","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"84O9Q":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"z",()=>i);var i=e("./external.js");r.exportAll(i,n),n.default=i},{"./external.js":"5VW2T","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"5VW2T":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n);var i=e("./errors.js");r.exportAll(i,n);var s=e("./helpers/parseUtil.js");r.exportAll(s,n);var o=e("./helpers/typeAliases.js");r.exportAll(o,n);var a=e("./helpers/util.js");r.exportAll(a,n);var l=e("./types.js");r.exportAll(l,n);var u=e("./ZodError.js");r.exportAll(u,n)},{"./errors.js":"k1pQA","./helpers/parseUtil.js":"2MDG0","./helpers/typeAliases.js":"7xIKl","./helpers/util.js":"6z6A6","./types.js":"FW75B","./ZodError.js":"lLPZS","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],k1pQA:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"defaultErrorMap",()=>s.default),r.export(n,"setErrorMap",()=>a),r.export(n,"getErrorMap",()=>l);var i=e("./locales/en.js"),s=r.interopDefault(i);let o=s.default;function a(e){o=e}function l(){return o}},{"./locales/en.js":"io7Q3","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],io7Q3:[function(e,t,n){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(n);var r=e("../ZodError.js"),i=e("../helpers/util.js");n.default=(e,t)=>{let n;switch(e.code){case r.ZodIssueCode.invalid_type:n=e.received===i.ZodParsedType.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case r.ZodIssueCode.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,i.util.jsonStringifyReplacer)}`;break;case r.ZodIssueCode.unrecognized_keys:n=`Unrecognized key(s) in object: ${(0,i.util).joinValues(e.keys,", ")}`;break;case r.ZodIssueCode.invalid_union:n="Invalid input";break;case r.ZodIssueCode.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${(0,i.util).joinValues(e.options)}`;break;case r.ZodIssueCode.invalid_enum_value:n=`Invalid enum value. Expected ${(0,i.util).joinValues(e.options)}, received '${e.received}'`;break;case r.ZodIssueCode.invalid_arguments:n="Invalid function arguments";break;case r.ZodIssueCode.invalid_return_type:n="Invalid function return type";break;case r.ZodIssueCode.invalid_date:n="Invalid date";break;case r.ZodIssueCode.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:(0,i.util).assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case r.ZodIssueCode.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case r.ZodIssueCode.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case r.ZodIssueCode.custom:n="Invalid input";break;case r.ZodIssueCode.invalid_intersection_types:n="Intersection results could not be merged";break;case r.ZodIssueCode.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case r.ZodIssueCode.not_finite:n="Number must be finite";break;default:n=t.defaultError,(0,i.util).assertNever(e)}return{message:n}}},{"../ZodError.js":"lLPZS","../helpers/util.js":"6z6A6","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],lLPZS:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"ZodIssueCode",()=>s),r.export(n,"quotelessJson",()=>o),r.export(n,"ZodError",()=>a);var i=e("./helpers/util.js");let s=(0,i.util).arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),o=e=>{let t=JSON.stringify(e,null,2);return t.replace(/"([^"]+)":/g,"$1:")};class a extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},n={_errors:[]},r=e=>{for(let i of e.issues)if("invalid_union"===i.code)i.unionErrors.map(r);else if("invalid_return_type"===i.code)r(i.returnTypeError);else if("invalid_arguments"===i.code)r(i.argumentsError);else if(0===i.path.length)n._errors.push(t(i));else{let e=n,r=0;for(;r<i.path.length;){let n=i.path[r],s=r===i.path.length-1;s?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(i))):e[n]=e[n]||{_errors:[]},e=e[n],r++}}};return r(this),n}static assert(e){if(!(e instanceof a))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,i.util.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},n=[];for(let r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}a.create=e=>{let t=new a(e);return t}},{"./helpers/util.js":"6z6A6","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"6z6A6":[function(e,t,n){var r,i,s,o=e("@parcel/transformer-js/src/esmodule-helpers.js");o.defineInteropFlag(n),o.export(n,"util",()=>i),o.export(n,"objectUtil",()=>s),o.export(n,"ZodParsedType",()=>a),o.export(n,"getParsedType",()=>l),(r=i||(i={})).assertEqual=e=>{},r.assertIs=function(e){},r.assertNever=function(e){throw Error()},r.arrayToEnum=e=>{let t={};for(let n of e)t[n]=n;return t},r.getValidEnumValues=e=>{let t=r.objectKeys(e).filter(t=>"number"!=typeof e[e[t]]),n={};for(let r of t)n[r]=e[r];return r.objectValues(n)},r.objectValues=e=>r.objectKeys(e).map(function(t){return e[t]}),r.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},r.find=(e,t)=>{for(let n of e)if(t(n))return n},r.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,r.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},r.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(s||(s={})).mergeShapes=(e,t)=>({...e,...t});let a=i.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),l=e=>{let t=typeof e;switch(t){case"undefined":return a.undefined;case"string":return a.string;case"number":return Number.isNaN(e)?a.nan:a.number;case"boolean":return a.boolean;case"function":return a.function;case"bigint":return a.bigint;case"symbol":return a.symbol;case"object":if(Array.isArray(e))return a.array;if(null===e)return a.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return a.promise;if("undefined"!=typeof Map&&e instanceof Map)return a.map;if("undefined"!=typeof Set&&e instanceof Set)return a.set;if("undefined"!=typeof Date&&e instanceof Date)return a.date;return a.object;default:return a.unknown}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"2MDG0":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"makeIssue",()=>a),r.export(n,"EMPTY_PATH",()=>l),r.export(n,"addIssueToContext",()=>u),r.export(n,"ParseStatus",()=>c),r.export(n,"INVALID",()=>d),r.export(n,"DIRTY",()=>p),r.export(n,"OK",()=>f),r.export(n,"isAborted",()=>h),r.export(n,"isDirty",()=>m),r.export(n,"isValid",()=>g),r.export(n,"isAsync",()=>y);var i=e("../errors.js"),s=e("../locales/en.js"),o=r.interopDefault(s);let a=e=>{let{data:t,path:n,errorMaps:r,issueData:i}=e,s=[...n,...i.path||[]],o={...i,path:s};if(void 0!==i.message)return{...i,path:s,message:i.message};let a="",l=r.filter(e=>!!e).slice().reverse();for(let e of l)a=e(o,{data:t,defaultError:a}).message;return{...i,path:s,message:a}},l=[];function u(e,t){let n=(0,i.getErrorMap)(),r=a({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===(0,o.default)?void 0:(0,o.default)].filter(e=>!!e)});e.common.issues.push(r)}class c{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let r of t){if("aborted"===r.status)return d;"dirty"===r.status&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let e of t){let t=await e.key,r=await e.value;n.push({key:t,value:r})}return c.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let r of t){let{key:t,value:i}=r;if("aborted"===t.status||"aborted"===i.status)return d;"dirty"===t.status&&e.dirty(),"dirty"===i.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==i.value||r.alwaysSet)&&(n[t.value]=i.value)}return{status:e.value,value:n}}}let d=Object.freeze({status:"aborted"}),p=e=>({status:"dirty",value:e}),f=e=>({status:"valid",value:e}),h=e=>"aborted"===e.status,m=e=>"dirty"===e.status,g=e=>"valid"===e.status,y=e=>"undefined"!=typeof Promise&&e instanceof Promise},{"../errors.js":"k1pQA","../locales/en.js":"io7Q3","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"7xIKl":[function(e,t,n){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(n)},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],FW75B:[function(e,t,n){let r;var i,s,o=e("@parcel/transformer-js/src/esmodule-helpers.js");o.defineInteropFlag(n),o.export(n,"ZodType",()=>m),o.export(n,"datetimeRegex",()=>M),o.export(n,"ZodString",()=>j),o.export(n,"ZodNumber",()=>N),o.export(n,"ZodBigInt",()=>D),o.export(n,"ZodBoolean",()=>U),o.export(n,"ZodDate",()=>L),o.export(n,"ZodSymbol",()=>F),o.export(n,"ZodUndefined",()=>B),o.export(n,"ZodNull",()=>q),o.export(n,"ZodAny",()=>$),o.export(n,"ZodUnknown",()=>V),o.export(n,"ZodNever",()=>Z),o.export(n,"ZodVoid",()=>G),o.export(n,"ZodArray",()=>J),o.export(n,"ZodObject",()=>H),o.export(n,"ZodUnion",()=>z),o.export(n,"ZodDiscriminatedUnion",()=>W),o.export(n,"ZodIntersection",()=>Y),o.export(n,"ZodTuple",()=>X),o.export(n,"ZodRecord",()=>Q),o.export(n,"ZodMap",()=>ee),o.export(n,"ZodSet",()=>et),o.export(n,"ZodFunction",()=>en),o.export(n,"ZodLazy",()=>er),o.export(n,"ZodLiteral",()=>ei),o.export(n,"ZodEnum",()=>eo),o.export(n,"ZodNativeEnum",()=>ea),o.export(n,"ZodPromise",()=>el),o.export(n,"ZodEffects",()=>eu),o.export(n,"ZodTransformer",()=>eu),o.export(n,"ZodOptional",()=>ec),o.export(n,"ZodNullable",()=>ed),o.export(n,"ZodDefault",()=>ep),o.export(n,"ZodCatch",()=>ef),o.export(n,"ZodNaN",()=>eh),o.export(n,"BRAND",()=>em),o.export(n,"ZodBranded",()=>eg),o.export(n,"ZodPipeline",()=>ey),o.export(n,"ZodReadonly",()=>eb),o.export(n,"custom",()=>e_),o.export(n,"Schema",()=>m),o.export(n,"ZodSchema",()=>m),o.export(n,"late",()=>eA),o.export(n,"ZodFirstPartyTypeKind",()=>s),o.export(n,"coerce",()=>e4),o.export(n,"any",()=>ek),o.export(n,"array",()=>eD),o.export(n,"bigint",()=>eT),o.export(n,"boolean",()=>eE),o.export(n,"date",()=>eS),o.export(n,"discriminatedUnion",()=>eB),o.export(n,"effect",()=>eX),o.export(n,"enum",()=>eK),o.export(n,"function",()=>eJ),o.export(n,"instanceof",()=>eC),o.export(n,"intersection",()=>eq),o.export(n,"lazy",()=>eH),o.export(n,"literal",()=>ez),o.export(n,"map",()=>eZ),o.export(n,"nan",()=>eO),o.export(n,"nativeEnum",()=>eW),o.export(n,"never",()=>ej),o.export(n,"null",()=>eR),o.export(n,"nullable",()=>e0),o.export(n,"number",()=>ew),o.export(n,"object",()=>eU),o.export(n,"oboolean",()=>e5),o.export(n,"onumber",()=>e8),o.export(n,"optional",()=>eQ),o.export(n,"ostring",()=>e6),o.export(n,"pipeline",()=>e2),o.export(n,"preprocess",()=>e1),o.export(n,"promise",()=>eY),o.export(n,"record",()=>eV),o.export(n,"set",()=>eG),o.export(n,"strictObject",()=>eL),o.export(n,"string",()=>eI),o.export(n,"symbol",()=>ex),o.export(n,"transformer",()=>eX),o.export(n,"tuple",()=>e$),o.export(n,"undefined",()=>eP),o.export(n,"union",()=>eF),o.export(n,"unknown",()=>eM),o.export(n,"void",()=>eN),o.export(n,"NEVER",()=>e3);var a=e("./ZodError.js"),l=e("./errors.js"),u=e("./helpers/errorUtil.js"),c=e("./helpers/parseUtil.js"),d=e("./helpers/util.js");class p{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let f=(e,t)=>{if((0,c.isValid)(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new a.ZodError(e.common.issues);return this._error=t,this._error}}};function h(e){if(!e)return{};let{errorMap:t,invalid_type_error:n,required_error:r,description:i}=e;if(t&&(n||r))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:i}:{errorMap:(t,i)=>{let{message:s}=e;return"invalid_enum_value"===t.code?{message:s??i.defaultError}:void 0===i.data?{message:s??r??i.defaultError}:"invalid_type"!==t.code?{message:i.defaultError}:{message:s??n??i.defaultError}},description:i}}class m{get description(){return this._def.description}_getType(e){return(0,d.getParsedType)(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:(0,d.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new c.ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:(0,d.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if((0,c.isAsync)(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){let n={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,d.getParsedType)(e)},r=this._parseSync({data:e,path:n.path,parent:n});return f(n,r)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,d.getParsedType)(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:t});return(0,c.isValid)(n)?{value:n.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>(0,c.isValid)(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,d.getParsedType)(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await ((0,c.isAsync)(r)?r:Promise.resolve(r));return f(n,i)}refine(e,t){let n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,r)=>{let i=e(t),s=()=>r.addIssue({code:a.ZodIssueCode.custom,...n(t)});return"undefined"!=typeof Promise&&i instanceof Promise?i.then(e=>!!e||(s(),!1)):!!i||(s(),!1)})}refinement(e,t){return this._refinement((n,r)=>!!e(n)||(r.addIssue("function"==typeof t?t(n,r):t),!1))}_refinement(e){return new eu({schema:this,typeName:s.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return ec.create(this,this._def)}nullable(){return ed.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return J.create(this)}promise(){return el.create(this,this._def)}or(e){return z.create([this,e],this._def)}and(e){return Y.create(this,e,this._def)}transform(e){return new eu({...h(this._def),schema:this,typeName:s.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new ep({...h(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:s.ZodDefault})}brand(){return new eg({typeName:s.ZodBranded,type:this,...h(this._def)})}catch(e){return new ef({...h(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:s.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return ey.create(this,e)}readonly(){return eb.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let g=/^c[^\s-]{8,}$/i,y=/^[0-9a-z]+$/,b=/^[0-9A-HJKMNP-TV-Z]{26}$/i,v=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,_=/^[a-z0-9_-]{21}$/i,A=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,C=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,I=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,w=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,O=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,T=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,E=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,S=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,x=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,P="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",R=RegExp(`^${P}$`);function k(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function M(e){let t=`${P}T${k(e)}`,n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,RegExp(`^${t}$`)}class j extends m{_parse(e){var t,n,i,s;let o;this._def.coerce&&(e.data=String(e.data));let l=this._getType(e);if(l!==d.ZodParsedType.string){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.string,received:t.parsedType}),c.INVALID}let u=new c.ParseStatus;for(let l of this._def.checks)if("min"===l.kind)e.data.length<l.value&&(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{code:a.ZodIssueCode.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),u.dirty());else if("max"===l.kind)e.data.length>l.value&&(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{code:a.ZodIssueCode.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),u.dirty());else if("length"===l.kind){let t=e.data.length>l.value,n=e.data.length<l.value;(t||n)&&(o=this._getOrReturnCtx(e,o),t?(0,c.addIssueToContext)(o,{code:a.ZodIssueCode.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):n&&(0,c.addIssueToContext)(o,{code:a.ZodIssueCode.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),u.dirty())}else if("email"===l.kind)I.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"email",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty());else if("emoji"===l.kind)r||(r=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),r.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"emoji",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty());else if("uuid"===l.kind)v.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"uuid",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty());else if("nanoid"===l.kind)_.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"nanoid",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty());else if("cuid"===l.kind)g.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"cuid",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty());else if("cuid2"===l.kind)y.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"cuid2",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty());else if("ulid"===l.kind)b.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"ulid",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty());else if("url"===l.kind)try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"url",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty()}else if("regex"===l.kind){l.regex.lastIndex=0;let t=l.regex.test(e.data);t||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"regex",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty())}else if("trim"===l.kind)e.data=e.data.trim();else if("includes"===l.kind)e.data.includes(l.value,l.position)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{code:a.ZodIssueCode.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),u.dirty());else if("toLowerCase"===l.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===l.kind)e.data=e.data.toUpperCase();else if("startsWith"===l.kind)e.data.startsWith(l.value)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{code:a.ZodIssueCode.invalid_string,validation:{startsWith:l.value},message:l.message}),u.dirty());else if("endsWith"===l.kind)e.data.endsWith(l.value)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{code:a.ZodIssueCode.invalid_string,validation:{endsWith:l.value},message:l.message}),u.dirty());else if("datetime"===l.kind){let t=M(l);t.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{code:a.ZodIssueCode.invalid_string,validation:"datetime",message:l.message}),u.dirty())}else if("date"===l.kind)R.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{code:a.ZodIssueCode.invalid_string,validation:"date",message:l.message}),u.dirty());else if("time"===l.kind){let t=RegExp(`^${k(l)}$`);t.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{code:a.ZodIssueCode.invalid_string,validation:"time",message:l.message}),u.dirty())}else"duration"===l.kind?C.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"duration",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty()):"ip"===l.kind?(t=e.data,("v4"===(n=l.version)||!n)&&w.test(t)||("v6"===n||!n)&&T.test(t)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"ip",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty())):"jwt"===l.kind?!function(e,t){if(!A.test(e))return!1;try{let[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));if("object"!=typeof i||null===i||"typ"in i&&i?.typ!=="JWT"||!i.alg||t&&i.alg!==t)return!1;return!0}catch{return!1}}(e.data,l.alg)&&(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"jwt",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty()):"cidr"===l.kind?(i=e.data,("v4"===(s=l.version)||!s)&&O.test(i)||("v6"===s||!s)&&E.test(i)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"cidr",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty())):"base64"===l.kind?S.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"base64",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty()):"base64url"===l.kind?x.test(e.data)||(o=this._getOrReturnCtx(e,o),(0,c.addIssueToContext)(o,{validation:"base64url",code:a.ZodIssueCode.invalid_string,message:l.message}),u.dirty()):(0,d.util).assertNever(l);return{status:u.value,value:e.data}}_regex(e,t,n){return this.refinement(t=>e.test(t),{validation:t,code:a.ZodIssueCode.invalid_string,...(0,u.errorUtil).errToObj(n)})}_addCheck(e){return new j({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...(0,u.errorUtil).errToObj(e)})}url(e){return this._addCheck({kind:"url",...(0,u.errorUtil).errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...(0,u.errorUtil).errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...(0,u.errorUtil).errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...(0,u.errorUtil).errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...(0,u.errorUtil).errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...(0,u.errorUtil).errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...(0,u.errorUtil).errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...(0,u.errorUtil).errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...(0,u.errorUtil).errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...(0,u.errorUtil).errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...(0,u.errorUtil).errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...(0,u.errorUtil).errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...(0,u.errorUtil).errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...(0,u.errorUtil).errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...(0,u.errorUtil).errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...(0,u.errorUtil).errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...(0,u.errorUtil).errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...(0,u.errorUtil).errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...(0,u.errorUtil).errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...(0,u.errorUtil).errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...(0,u.errorUtil).errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...(0,u.errorUtil).errToObj(t)})}nonempty(e){return this.min(1,(0,u.errorUtil).errToObj(e))}trim(){return new j({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new j({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new j({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}j.create=e=>new j({checks:[],typeName:s.ZodString,coerce:e?.coerce??!1,...h(e)});class N extends m{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;this._def.coerce&&(e.data=Number(e.data));let n=this._getType(e);if(n!==d.ZodParsedType.number){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.number,received:t.parsedType}),c.INVALID}let r=new c.ParseStatus;for(let n of this._def.checks)if("int"===n.kind)(0,d.util).isInteger(e.data)||(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty());else if("min"===n.kind){let i=n.inclusive?e.data<n.value:e.data<=n.value;i&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty())}else if("max"===n.kind){let i=n.inclusive?e.data>n.value:e.data>=n.value;i&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty())}else"multipleOf"===n.kind?0!==function(e,t){let n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,i=n>r?n:r,s=Number.parseInt(e.toFixed(i).replace(".","")),o=Number.parseInt(t.toFixed(i).replace(".",""));return s%o/10**i}(e.data,n.value)&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.not_finite,message:n.message}),r.dirty()):(0,d.util).assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,(0,u.errorUtil).toString(t))}gt(e,t){return this.setLimit("min",e,!1,(0,u.errorUtil).toString(t))}lte(e,t){return this.setLimit("max",e,!0,(0,u.errorUtil).toString(t))}lt(e,t){return this.setLimit("max",e,!1,(0,u.errorUtil).toString(t))}setLimit(e,t,n,r){return new N({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:(0,u.errorUtil).toString(r)}]})}_addCheck(e){return new N({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:(0,u.errorUtil).toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:(0,u.errorUtil).toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:(0,u.errorUtil).toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:(0,u.errorUtil).toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:(0,u.errorUtil).toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:(0,u.errorUtil).toString(t)})}finite(e){return this._addCheck({kind:"finite",message:(0,u.errorUtil).toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:(0,u.errorUtil).toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:(0,u.errorUtil).toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&(0,d.util).isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}N.create=e=>new N({checks:[],typeName:s.ZodNumber,coerce:e?.coerce||!1,...h(e)});class D extends m{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}let n=this._getType(e);if(n!==d.ZodParsedType.bigint)return this._getInvalidInput(e);let r=new c.ParseStatus;for(let n of this._def.checks)if("min"===n.kind){let i=n.inclusive?e.data<n.value:e.data<=n.value;i&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty())}else if("max"===n.kind){let i=n.inclusive?e.data>n.value:e.data>=n.value;i&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty())}else"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):(0,d.util).assertNever(n);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.bigint,received:t.parsedType}),c.INVALID}gte(e,t){return this.setLimit("min",e,!0,(0,u.errorUtil).toString(t))}gt(e,t){return this.setLimit("min",e,!1,(0,u.errorUtil).toString(t))}lte(e,t){return this.setLimit("max",e,!0,(0,u.errorUtil).toString(t))}lt(e,t){return this.setLimit("max",e,!1,(0,u.errorUtil).toString(t))}setLimit(e,t,n,r){return new D({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:(0,u.errorUtil).toString(r)}]})}_addCheck(e){return new D({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:(0,u.errorUtil).toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:(0,u.errorUtil).toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:(0,u.errorUtil).toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:(0,u.errorUtil).toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:(0,u.errorUtil).toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}D.create=e=>new D({checks:[],typeName:s.ZodBigInt,coerce:e?.coerce??!1,...h(e)});class U extends m{_parse(e){this._def.coerce&&(e.data=!!e.data);let t=this._getType(e);if(t!==d.ZodParsedType.boolean){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.boolean,received:t.parsedType}),c.INVALID}return(0,c.OK)(e.data)}}U.create=e=>new U({typeName:s.ZodBoolean,coerce:e?.coerce||!1,...h(e)});class L extends m{_parse(e){let t;this._def.coerce&&(e.data=new Date(e.data));let n=this._getType(e);if(n!==d.ZodParsedType.date){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.date,received:t.parsedType}),c.INVALID}if(Number.isNaN(e.data.getTime())){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_date}),c.INVALID}let r=new c.ParseStatus;for(let n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),r.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),r.dirty()):(0,d.util).assertNever(n);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new L({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:(0,u.errorUtil).toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:(0,u.errorUtil).toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}L.create=e=>new L({checks:[],coerce:e?.coerce||!1,typeName:s.ZodDate,...h(e)});class F extends m{_parse(e){let t=this._getType(e);if(t!==d.ZodParsedType.symbol){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.symbol,received:t.parsedType}),c.INVALID}return(0,c.OK)(e.data)}}F.create=e=>new F({typeName:s.ZodSymbol,...h(e)});class B extends m{_parse(e){let t=this._getType(e);if(t!==d.ZodParsedType.undefined){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.undefined,received:t.parsedType}),c.INVALID}return(0,c.OK)(e.data)}}B.create=e=>new B({typeName:s.ZodUndefined,...h(e)});class q extends m{_parse(e){let t=this._getType(e);if(t!==d.ZodParsedType.null){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.null,received:t.parsedType}),c.INVALID}return(0,c.OK)(e.data)}}q.create=e=>new q({typeName:s.ZodNull,...h(e)});class $ extends m{constructor(){super(...arguments),this._any=!0}_parse(e){return(0,c.OK)(e.data)}}$.create=e=>new $({typeName:s.ZodAny,...h(e)});class V extends m{constructor(){super(...arguments),this._unknown=!0}_parse(e){return(0,c.OK)(e.data)}}V.create=e=>new V({typeName:s.ZodUnknown,...h(e)});class Z extends m{_parse(e){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.never,received:t.parsedType}),c.INVALID}}Z.create=e=>new Z({typeName:s.ZodNever,...h(e)});class G extends m{_parse(e){let t=this._getType(e);if(t!==d.ZodParsedType.undefined){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.void,received:t.parsedType}),c.INVALID}return(0,c.OK)(e.data)}}G.create=e=>new G({typeName:s.ZodVoid,...h(e)});class J extends m{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==d.ZodParsedType.array)return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.array,received:t.parsedType}),c.INVALID;if(null!==r.exactLength){let e=t.data.length>r.exactLength.value,i=t.data.length<r.exactLength.value;(e||i)&&((0,c.addIssueToContext)(t,{code:e?a.ZodIssueCode.too_big:a.ZodIssueCode.too_small,minimum:i?r.exactLength.value:void 0,maximum:e?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(null!==r.minLength&&t.data.length<r.minLength.value&&((0,c.addIssueToContext)(t,{code:a.ZodIssueCode.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),null!==r.maxLength&&t.data.length>r.maxLength.value&&((0,c.addIssueToContext)(t,{code:a.ZodIssueCode.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((e,n)=>r.type._parseAsync(new p(t,e,t.path,n)))).then(e=>(0,c.ParseStatus).mergeArray(n,e));let i=[...t.data].map((e,n)=>r.type._parseSync(new p(t,e,t.path,n)));return(0,c.ParseStatus).mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new J({...this._def,minLength:{value:e,message:(0,u.errorUtil).toString(t)}})}max(e,t){return new J({...this._def,maxLength:{value:e,message:(0,u.errorUtil).toString(t)}})}length(e,t){return new J({...this._def,exactLength:{value:e,message:(0,u.errorUtil).toString(t)}})}nonempty(e){return this.min(1,e)}}J.create=(e,t)=>new J({type:e,minLength:null,maxLength:null,exactLength:null,typeName:s.ZodArray,...h(t)});class H extends m{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=(0,d.util).objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){let t=this._getType(e);if(t!==d.ZodParsedType.object){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.object,received:t.parsedType}),c.INVALID}let{status:n,ctx:r}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Z&&"strip"===this._def.unknownKeys))for(let e in r.data)s.includes(e)||o.push(e);let l=[];for(let e of s){let t=i[e],n=r.data[e];l.push({key:{status:"valid",value:e},value:t._parse(new p(r,n,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof Z){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of o)l.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)o.length>0&&((0,c.addIssueToContext)(r,{code:a.ZodIssueCode.unrecognized_keys,keys:o}),n.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of o){let n=r.data[t];l.push({key:{status:"valid",value:t},value:e._parse(new p(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of l){let n=await t.key,r=await t.value;e.push({key:n,value:r,alwaysSet:t.alwaysSet})}return e}).then(e=>(0,c.ParseStatus).mergeObjectSync(n,e)):(0,c.ParseStatus).mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(e){return u.errorUtil.errToObj,new H({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{let r=this._def.errorMap?.(t,n).message??n.defaultError;return"unrecognized_keys"===t.code?{message:(0,u.errorUtil).errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new H({...this._def,unknownKeys:"strip"})}passthrough(){return new H({...this._def,unknownKeys:"passthrough"})}extend(e){return new H({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){let t=new H({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:s.ZodObject});return t}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new H({...this._def,catchall:e})}pick(e){let t={};for(let n of(0,d.util).objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new H({...this._def,shape:()=>t})}omit(e){let t={};for(let n of(0,d.util).objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new H({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof H){let n={};for(let r in t.shape){let i=t.shape[r];n[r]=ec.create(e(i))}return new H({...t._def,shape:()=>n})}return t instanceof J?new J({...t._def,type:e(t.element)}):t instanceof ec?ec.create(e(t.unwrap())):t instanceof ed?ed.create(e(t.unwrap())):t instanceof X?X.create(t.items.map(t=>e(t))):t}(this)}partial(e){let t={};for(let n of(0,d.util).objectKeys(this.shape)){let r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()}return new H({...this._def,shape:()=>t})}required(e){let t={};for(let n of(0,d.util).objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n],r=e;for(;r instanceof ec;)r=r._def.innerType;t[n]=r}return new H({...this._def,shape:()=>t})}keyof(){return es((0,d.util).objectKeys(this.shape))}}H.create=(e,t)=>new H({shape:()=>e,unknownKeys:"strip",catchall:Z.create(),typeName:s.ZodObject,...h(t)}),H.strictCreate=(e,t)=>new H({shape:()=>e,unknownKeys:"strict",catchall:Z.create(),typeName:s.ZodObject,...h(t)}),H.lazycreate=(e,t)=>new H({shape:e,unknownKeys:"strip",catchall:Z.create(),typeName:s.ZodObject,...h(t)});class z extends m{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map(async e=>{let n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;let n=e.map(e=>new a.ZodError(e.ctx.common.issues));return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_union,unionErrors:n}),c.INVALID});{let e;let r=[];for(let i of n){let n={...t,common:{...t.common,issues:[]},parent:null},s=i._parseSync({data:t.data,path:t.path,parent:n});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:n}),n.common.issues.length&&r.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let i=r.map(e=>new a.ZodError(e));return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_union,unionErrors:i}),c.INVALID}}get options(){return this._def.options}}z.create=(e,t)=>new z({options:e,typeName:s.ZodUnion,...h(t)});let K=e=>{if(e instanceof er)return K(e.schema);if(e instanceof eu)return K(e.innerType());if(e instanceof ei)return[e.value];if(e instanceof eo)return e.options;if(e instanceof ea)return(0,d.util).objectValues(e.enum);if(e instanceof ep)return K(e._def.innerType);if(e instanceof B)return[void 0];else if(e instanceof q)return[null];else if(e instanceof ec)return[void 0,...K(e.unwrap())];else if(e instanceof ed)return[null,...K(e.unwrap())];else if(e instanceof eg)return K(e.unwrap());else if(e instanceof eb)return K(e.unwrap());else if(e instanceof ef)return K(e._def.innerType);else return[]};class W extends m{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==d.ZodParsedType.object)return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.object,received:t.parsedType}),c.INVALID;let n=this.discriminator,r=t.data[n],i=this.optionsMap.get(r);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):((0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),c.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let r=new Map;for(let n of t){let t=K(n.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let i of t){if(r.has(i))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(i)}`);r.set(i,n)}}return new W({typeName:s.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...h(n)})}}class Y extends m{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),r=(e,r)=>{if((0,c.isAborted)(e)||(0,c.isAborted)(r))return c.INVALID;let i=function e(t,n){let r=(0,d.getParsedType)(t),i=(0,d.getParsedType)(n);if(t===n)return{valid:!0,data:t};if(r===d.ZodParsedType.object&&i===d.ZodParsedType.object){let r=(0,d.util).objectKeys(n),i=(0,d.util).objectKeys(t).filter(e=>-1!==r.indexOf(e)),s={...t,...n};for(let r of i){let i=e(t[r],n[r]);if(!i.valid)return{valid:!1};s[r]=i.data}return{valid:!0,data:s}}if(r===d.ZodParsedType.array&&i===d.ZodParsedType.array){if(t.length!==n.length)return{valid:!1};let r=[];for(let i=0;i<t.length;i++){let s=t[i],o=n[i],a=e(s,o);if(!a.valid)return{valid:!1};r.push(a.data)}return{valid:!0,data:r}}return r===d.ZodParsedType.date&&i===d.ZodParsedType.date&&+t==+n?{valid:!0,data:t}:{valid:!1}}(e.value,r.value);return i.valid?(((0,c.isDirty)(e)||(0,c.isDirty)(r))&&t.dirty(),{status:t.value,value:i.data}):((0,c.addIssueToContext)(n,{code:a.ZodIssueCode.invalid_intersection_types}),c.INVALID)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([e,t])=>r(e,t)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Y.create=(e,t,n)=>new Y({left:e,right:t,typeName:s.ZodIntersection,...h(n)});class X extends m{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==d.ZodParsedType.array)return(0,c.addIssueToContext)(n,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.array,received:n.parsedType}),c.INVALID;if(n.data.length<this._def.items.length)return(0,c.addIssueToContext)(n,{code:a.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),c.INVALID;let r=this._def.rest;!r&&n.data.length>this._def.items.length&&((0,c.addIssueToContext)(n,{code:a.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let i=[...n.data].map((e,t)=>{let r=this._def.items[t]||this._def.rest;return r?r._parse(new p(n,e,n.path,t)):null}).filter(e=>!!e);return n.common.async?Promise.all(i).then(e=>(0,c.ParseStatus).mergeArray(t,e)):(0,c.ParseStatus).mergeArray(t,i)}get items(){return this._def.items}rest(e){return new X({...this._def,rest:e})}}X.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new X({items:e,typeName:s.ZodTuple,rest:null,...h(t)})};class Q extends m{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==d.ZodParsedType.object)return(0,c.addIssueToContext)(n,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.object,received:n.parsedType}),c.INVALID;let r=[],i=this._def.keyType,s=this._def.valueType;for(let e in n.data)r.push({key:i._parse(new p(n,e,n.path,e)),value:s._parse(new p(n,n.data[e],n.path,e)),alwaysSet:e in n.data});return n.common.async?(0,c.ParseStatus).mergeObjectAsync(t,r):(0,c.ParseStatus).mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return new Q(t instanceof m?{keyType:e,valueType:t,typeName:s.ZodRecord,...h(n)}:{keyType:j.create(),valueType:e,typeName:s.ZodRecord,...h(t)})}}class ee extends m{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==d.ZodParsedType.map)return(0,c.addIssueToContext)(n,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.map,received:n.parsedType}),c.INVALID;let r=this._def.keyType,i=this._def.valueType,s=[...n.data.entries()].map(([e,t],s)=>({key:r._parse(new p(n,e,n.path,[s,"key"])),value:i._parse(new p(n,t,n.path,[s,"value"]))}));if(n.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let n of s){let r=await n.key,i=await n.value;if("aborted"===r.status||"aborted"===i.status)return c.INVALID;("dirty"===r.status||"dirty"===i.status)&&t.dirty(),e.set(r.value,i.value)}return{status:t.value,value:e}})}{let e=new Map;for(let n of s){let r=n.key,i=n.value;if("aborted"===r.status||"aborted"===i.status)return c.INVALID;("dirty"===r.status||"dirty"===i.status)&&t.dirty(),e.set(r.value,i.value)}return{status:t.value,value:e}}}}ee.create=(e,t,n)=>new ee({valueType:t,keyType:e,typeName:s.ZodMap,...h(n)});class et extends m{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==d.ZodParsedType.set)return(0,c.addIssueToContext)(n,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.set,received:n.parsedType}),c.INVALID;let r=this._def;null!==r.minSize&&n.data.size<r.minSize.value&&((0,c.addIssueToContext)(n,{code:a.ZodIssueCode.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),null!==r.maxSize&&n.data.size>r.maxSize.value&&((0,c.addIssueToContext)(n,{code:a.ZodIssueCode.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());let i=this._def.valueType;function s(e){let n=new Set;for(let r of e){if("aborted"===r.status)return c.INVALID;"dirty"===r.status&&t.dirty(),n.add(r.value)}return{status:t.value,value:n}}let o=[...n.data.values()].map((e,t)=>i._parse(new p(n,e,n.path,t)));return n.common.async?Promise.all(o).then(e=>s(e)):s(o)}min(e,t){return new et({...this._def,minSize:{value:e,message:(0,u.errorUtil).toString(t)}})}max(e,t){return new et({...this._def,maxSize:{value:e,message:(0,u.errorUtil).toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}et.create=(e,t)=>new et({valueType:e,minSize:null,maxSize:null,typeName:s.ZodSet,...h(t)});class en extends m{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==d.ZodParsedType.function)return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.function,received:t.parsedType}),c.INVALID;function n(e,n){return(0,c.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,l.getErrorMap)(),(0,l.defaultErrorMap)].filter(e=>!!e),issueData:{code:a.ZodIssueCode.invalid_arguments,argumentsError:n}})}function r(e,n){return(0,c.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,l.getErrorMap)(),(0,l.defaultErrorMap)].filter(e=>!!e),issueData:{code:a.ZodIssueCode.invalid_return_type,returnTypeError:n}})}let i={errorMap:t.common.contextualErrorMap},s=t.data;if(this._def.returns instanceof el){let e=this;return(0,c.OK)(async function(...t){let o=new a.ZodError([]),l=await e._def.args.parseAsync(t,i).catch(e=>{throw o.addIssue(n(t,e)),o}),u=await Reflect.apply(s,this,l),c=await e._def.returns._def.type.parseAsync(u,i).catch(e=>{throw o.addIssue(r(u,e)),o});return c})}{let e=this;return(0,c.OK)(function(...t){let o=e._def.args.safeParse(t,i);if(!o.success)throw new a.ZodError([n(t,o.error)]);let l=Reflect.apply(s,this,o.data),u=e._def.returns.safeParse(l,i);if(!u.success)throw new a.ZodError([r(l,u.error)]);return u.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new en({...this._def,args:X.create(e).rest(V.create())})}returns(e){return new en({...this._def,returns:e})}implement(e){let t=this.parse(e);return t}strictImplement(e){let t=this.parse(e);return t}static create(e,t,n){return new en({args:e||X.create([]).rest(V.create()),returns:t||V.create(),typeName:s.ZodFunction,...h(n)})}}class er extends m{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.getter();return n._parse({data:t.data,path:t.path,parent:t})}}er.create=(e,t)=>new er({getter:e,typeName:s.ZodLazy,...h(t)});class ei extends m{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{received:t.data,code:a.ZodIssueCode.invalid_literal,expected:this._def.value}),c.INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}}function es(e,t){return new eo({values:e,typeName:s.ZodEnum,...h(t)})}ei.create=(e,t)=>new ei({value:e,typeName:s.ZodLiteral,...h(t)});class eo extends m{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),n=this._def.values;return(0,c.addIssueToContext)(t,{expected:(0,d.util).joinValues(n),received:t.parsedType,code:a.ZodIssueCode.invalid_type}),c.INVALID}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return(0,c.addIssueToContext)(t,{received:t.data,code:a.ZodIssueCode.invalid_enum_value,options:n}),c.INVALID}return(0,c.OK)(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return eo.create(e,{...this._def,...t})}exclude(e,t=this._def){return eo.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}eo.create=es;class ea extends m{_parse(e){let t=(0,d.util).getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==d.ZodParsedType.string&&n.parsedType!==d.ZodParsedType.number){let e=(0,d.util).objectValues(t);return(0,c.addIssueToContext)(n,{expected:(0,d.util).joinValues(e),received:n.parsedType,code:a.ZodIssueCode.invalid_type}),c.INVALID}if(this._cache||(this._cache=new Set((0,d.util).getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=(0,d.util).objectValues(t);return(0,c.addIssueToContext)(n,{received:n.data,code:a.ZodIssueCode.invalid_enum_value,options:e}),c.INVALID}return(0,c.OK)(e.data)}get enum(){return this._def.values}}ea.create=(e,t)=>new ea({values:e,typeName:s.ZodNativeEnum,...h(t)});class el extends m{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==d.ZodParsedType.promise&&!1===t.common.async)return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.promise,received:t.parsedType}),c.INVALID;let n=t.parsedType===d.ZodParsedType.promise?t.data:Promise.resolve(t.data);return(0,c.OK)(n.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}el.create=(e,t)=>new el({type:e,typeName:s.ZodPromise,...h(t)});class eu extends m{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===s.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,i={addIssue:e=>{(0,c.addIssueToContext)(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===r.type){let e=r.transform(n.data,i);if(n.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return c.INVALID;let r=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===r.status?c.INVALID:"dirty"===r.status||"dirty"===t.value?(0,c.DIRTY)(r.value):r});{if("aborted"===t.value)return c.INVALID;let r=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===r.status?c.INVALID:"dirty"===r.status||"dirty"===t.value?(0,c.DIRTY)(r.value):r}}if("refinement"===r.type){let e=e=>{let t=r.refinement(e,i);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==n.common.async)return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(n=>"aborted"===n.status?c.INVALID:("dirty"===n.status&&t.dirty(),e(n.value).then(()=>({status:t.value,value:n.value}))));{let r=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===r.status?c.INVALID:("dirty"===r.status&&t.dirty(),e(r.value),{status:t.value,value:r.value})}}if("transform"===r.type){if(!1!==n.common.async)return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(e=>(0,c.isValid)(e)?Promise.resolve(r.transform(e.value,i)).then(e=>({status:t.value,value:e})):c.INVALID);{let e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!(0,c.isValid)(e))return c.INVALID;let s=r.transform(e.value,i);if(s instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}}(0,d.util).assertNever(r)}}eu.create=(e,t,n)=>new eu({schema:e,typeName:s.ZodEffects,effect:t,...h(n)}),eu.createWithPreprocess=(e,t,n)=>new eu({schema:t,effect:{type:"preprocess",transform:e},typeName:s.ZodEffects,...h(n)});class ec extends m{_parse(e){let t=this._getType(e);return t===d.ZodParsedType.undefined?(0,c.OK)(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ec.create=(e,t)=>new ec({innerType:e,typeName:s.ZodOptional,...h(t)});class ed extends m{_parse(e){let t=this._getType(e);return t===d.ZodParsedType.null?(0,c.OK)(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ed.create=(e,t)=>new ed({innerType:e,typeName:s.ZodNullable,...h(t)});class ep extends m{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===d.ZodParsedType.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}ep.create=(e,t)=>new ep({innerType:e,typeName:s.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...h(t)});class ef extends m{_parse(e){let{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return(0,c.isAsync)(r)?r.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new a.ZodError(n.common.issues)},input:n.data})})):{status:"valid",value:"valid"===r.status?r.value:this._def.catchValue({get error(){return new a.ZodError(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}ef.create=(e,t)=>new ef({innerType:e,typeName:s.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...h(t)});class eh extends m{_parse(e){let t=this._getType(e);if(t!==d.ZodParsedType.nan){let t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:a.ZodIssueCode.invalid_type,expected:d.ZodParsedType.nan,received:t.parsedType}),c.INVALID}return{status:"valid",value:e.data}}}eh.create=e=>new eh({typeName:s.ZodNaN,...h(e)});let em=Symbol("zod_brand");class eg extends m{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class ey extends m{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){let e=async()=>{let e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?c.INVALID:"dirty"===e.status?(t.dirty(),(0,c.DIRTY)(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})};return e()}{let e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?c.INVALID:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new ey({in:e,out:t,typeName:s.ZodPipeline})}}class eb extends m{_parse(e){let t=this._def.innerType._parse(e),n=e=>((0,c.isValid)(e)&&(e.value=Object.freeze(e.value)),e);return(0,c.isAsync)(t)?t.then(e=>n(e)):n(t)}unwrap(){return this._def.innerType}}function ev(e,t){let n="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof n?{message:n}:n}function e_(e,t={},n){return e?$.create().superRefine((r,i)=>{let s=e(r);if(s instanceof Promise)return s.then(e=>{if(!e){let e=ev(t,r),s=e.fatal??n??!0;i.addIssue({code:"custom",...e,fatal:s})}});if(!s){let e=ev(t,r),s=e.fatal??n??!0;i.addIssue({code:"custom",...e,fatal:s})}}):$.create()}eb.create=(e,t)=>new eb({innerType:e,typeName:s.ZodReadonly,...h(t)});let eA={object:H.lazycreate};(i=s||(s={})).ZodString="ZodString",i.ZodNumber="ZodNumber",i.ZodNaN="ZodNaN",i.ZodBigInt="ZodBigInt",i.ZodBoolean="ZodBoolean",i.ZodDate="ZodDate",i.ZodSymbol="ZodSymbol",i.ZodUndefined="ZodUndefined",i.ZodNull="ZodNull",i.ZodAny="ZodAny",i.ZodUnknown="ZodUnknown",i.ZodNever="ZodNever",i.ZodVoid="ZodVoid",i.ZodArray="ZodArray",i.ZodObject="ZodObject",i.ZodUnion="ZodUnion",i.ZodDiscriminatedUnion="ZodDiscriminatedUnion",i.ZodIntersection="ZodIntersection",i.ZodTuple="ZodTuple",i.ZodRecord="ZodRecord",i.ZodMap="ZodMap",i.ZodSet="ZodSet",i.ZodFunction="ZodFunction",i.ZodLazy="ZodLazy",i.ZodLiteral="ZodLiteral",i.ZodEnum="ZodEnum",i.ZodEffects="ZodEffects",i.ZodNativeEnum="ZodNativeEnum",i.ZodOptional="ZodOptional",i.ZodNullable="ZodNullable",i.ZodDefault="ZodDefault",i.ZodCatch="ZodCatch",i.ZodPromise="ZodPromise",i.ZodBranded="ZodBranded",i.ZodPipeline="ZodPipeline",i.ZodReadonly="ZodReadonly";let eC=(e,t={message:`Input not instance of ${e.name}`})=>e_(t=>t instanceof e,t),eI=j.create,ew=N.create,eO=eh.create,eT=D.create,eE=U.create,eS=L.create,ex=F.create,eP=B.create,eR=q.create,ek=$.create,eM=V.create,ej=Z.create,eN=G.create,eD=J.create,eU=H.create,eL=H.strictCreate,eF=z.create,eB=W.create,eq=Y.create,e$=X.create,eV=Q.create,eZ=ee.create,eG=et.create,eJ=en.create,eH=er.create,ez=ei.create,eK=eo.create,eW=ea.create,eY=el.create,eX=eu.create,eQ=ec.create,e0=ed.create,e1=eu.createWithPreprocess,e2=ey.create,e6=()=>eI().optional(),e8=()=>ew().optional(),e5=()=>eE().optional(),e4={string:e=>j.create({...e,coerce:!0}),number:e=>N.create({...e,coerce:!0}),boolean:e=>U.create({...e,coerce:!0}),bigint:e=>D.create({...e,coerce:!0}),date:e=>L.create({...e,coerce:!0})},e3=c.INVALID},{"./ZodError.js":"lLPZS","./errors.js":"k1pQA","./helpers/errorUtil.js":"dQenx","./helpers/parseUtil.js":"2MDG0","./helpers/util.js":"6z6A6","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],dQenx:[function(e,t,n){var r,i,s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(n),s.export(n,"errorUtil",()=>i),(r=i||(i={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},r.toString=e=>"string"==typeof e?e:e?.message},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],dHvna:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n);var i=e("openai"),s=r.interopDefault(i),o=e("../messages/functionResult");let a=new Map,l=new Map;async function u(e,t=3e4){let n=Date.now();for(;Date.now()-n<t;){if((0,o.pendingFunctionResults).has(e)){let t=(0,o.pendingFunctionResults).get(e);return(0,o.pendingFunctionResults).delete(e),t}await new Promise(e=>setTimeout(e,100))}throw Error("Function execution timeout")}let c=async(e,t)=>{try{let r;let{apiKey:i,streamOptions:o,requestId:c}=e.body;if(!i||!o||!c){t.send({type:"chunk",data:{type:"error",error:{code:"missing_parameters",message:"Missing required parameters: apiKey, streamOptions, or requestId"}},requestId:c||"unknown"});return}try{r=new s.default({apiKey:i,dangerouslyAllowBrowser:!0})}catch(e){console.error("[OpenAI Stream] Failed to create client:",e),t.send({type:"chunk",data:{type:"error",error:{code:"client_creation_failed",message:e.message||"Failed to create OpenAI client"}},requestId:c});return}async function n(e,t,n,i){try{let s,o;let{model:u,stream:d,tools:p,previous_response_id:f,reasoning:h,temperature:m,top_p:g,max_output_tokens:y,store:b,truncation:v}=e,_={model:u,input:t.map(e=>{if(!e||"string"!=typeof e.role)return null;if("function"===e.role){if(!e.toolCallId||"string"!=typeof e.content)return null;{let t={type:"function_call_output",call_id:e.toolCallId,output:e.content};return t}}if("user"===e.role||"system"===e.role)return{role:e.role,content:e.content??""};if("assistant"===e.role){let t={role:"assistant",content:e.content??null};return e.tool_calls&&Array.isArray(e.tool_calls)&&e.tool_calls.length>0&&(t.tool_calls=e.tool_calls.map(e=>({id:e.id,type:e.type||"function",function:{name:e.function?.name||"",arguments:e.function?.arguments||"{}"}}))),""!==t.content||t.tool_calls||(t.content=null),t}return null}).filter(e=>null!==e),stream:!0,store:!0===b,truncation:v||"auto"};p&&p.length>0&&(_.tools=p,_.tool_choice=e.tool_choice||"auto",_.parallel_tool_calls=!1!==e.parallel_tool_calls),(f||n)&&(_.previous_response_id=f||n),h&&("o4-mini"===u||"o3"===u)&&(_.reasoning={effort:"string"==typeof h&&("low"===h||"high"===h)?h:"medium"}),void 0!==m&&("gpt-4.1-mini"===u||"gpt-4.1"===u)&&(_.temperature=m),void 0!==g&&("gpt-4.1-mini"===u||"gpt-4.1"===u)&&(_.top_p=g),void 0!==y&&("gpt-4.1-mini"===u||"gpt-4.1"===u)&&(_.max_output_tokens=y);try{let e=globalThis.fetch;globalThis.fetch=async(t,n)=>{let r=await e(t,n);if(!r.ok){let e=await r.text();console.log("[OpenAI Stream] API Error Response:",e);try{let t=JSON.parse(e);t.error?.message&&i.send({type:"chunk",data:{type:"error",error:{code:t.error.code||"api_error",message:t.error.message}},requestId:c})}catch(e){}return new Response(e,{status:r.status,statusText:r.statusText,headers:r.headers})}return r},o=r.responses.stream(_),globalThis.fetch=e}catch(e){return console.error("[OpenAI Stream] Synchronous error creating stream:",e),i.send({type:"chunk",data:{type:"error",error:{code:"sync_stream_error",message:e.message||"Failed to create stream"}},requestId:c}),{currentResponseId:n,functionCalls:[],error:!0}}try{s=await o}catch(a){console.error("[OpenAI Stream Error]",a);let e="Unknown error occurred",t=[a.response?.data?.error?.message,a.response?.error?.message,a.data?.error?.message,a.error?.message,a.message,a.response?.data?.message,(()=>{try{if(a.response?.data&&"string"==typeof a.response.data){let e=JSON.parse(a.response.data);return e.error?.message||e.message}}catch(e){}return null})(),(()=>{try{if("string"==typeof a.message&&a.message.includes("{")){let e=JSON.parse(a.message);return e.error?.message||e.message}}catch(e){}return null})(),(()=>{try{if(a.toString&&a.toString().includes("message")){let e=a.toString().match(/"message":\s*"([^"]+)"/);return e?e[1]:null}}catch(e){}return null})()];for(let n of t)if(n&&"string"==typeof n&&"Unknown error occurred"!==n){e=n;break}if("Unknown error occurred"===e)try{if(a.response?.status&&(e=`HTTP ${a.response.status} error`,a.response.statusText&&(e+=`: ${a.response.statusText}`)),"Unknown error occurred"===e||e.startsWith("HTTP")){let t=[];a.response?.data?t.push(JSON.stringify(a.response.data)):a.message?t.push(a.message):t.push(JSON.stringify(a).substring(0,500)),t.length>0&&(e=t.join(" "))}}catch(t){e=String(a).substring(0,500)}let r="unknown_error",s=[a.response?.data?.error?.code,a.response?.error?.code,a.data?.error?.code,a.error?.code,a.code,a.response?.status,(()=>{try{if("string"==typeof a.message&&a.message.includes("{")){let e=JSON.parse(a.message);return e.error?.code||e.code}}catch(e){}return null})()];for(let e of s)if(e&&("string"==typeof e||"number"==typeof e)){r=String(e);break}let o={type:"chunk",data:{type:"error",error:{code:r,message:e}},requestId:c};return i.send(o),setTimeout(()=>{i.send(o)},100),setTimeout(()=>{i.send({type:"chunk",data:{type:"response.failed",error:{code:r,message:e}},requestId:c})},200),{currentResponseId:n,functionCalls:[],error:!0}}let A=[];for await(let e of s){if("response.created"===e.type&&e.response?.id&&(n=e.response.id),"error"===e.type||"response.failed"===e.type)return i.send({type:"chunk",data:e,requestId:c}),{currentResponseId:n,functionCalls:[],error:!0};if(i.send({type:"chunk",data:e,requestId:c}),"response.output_text.delta"===e.type&&await new Promise(e=>setTimeout(e,5)),"response.output_item.added"===e.type&&"function_call"===e.item.type){let t=e.item.id,n=e.item.call_id,r=e.item.name;t&&n&&r&&a.set(t,{name:r,toolCallId:n})}else if("response.function_call_arguments.done"===e.type){let t=e.item_id,n=e.arguments||"{}";try{let e=JSON.parse(n);if(l.set(t,{args:e,argumentsString:n}),a.has(t)){let e=a.get(t),n=l.get(t);A.push({metadata:e,argData:n}),a.delete(t),l.delete(t)}}catch(e){}}}return{currentResponseId:n,functionCalls:A,error:!1}}catch(s){let e="An unexpected error occurred",t=String(s);if(s.message)e=s.message;else if(t&&t.includes(":")){let n=t.indexOf(":"),r=t.indexOf(" ",n);e=r>n?t.substring(r+1).trim():t.substring(n+1).trim()}else t&&(e=t);let r={type:"chunk",data:{type:"error",error:{code:"stream_error",message:e}},requestId:c};return i.send(r),setTimeout(()=>{i.send(r)},100),{currentResponseId:n,functionCalls:[],error:!0}}}try{t.send({type:"start",requestId:c,data:{message:"Starting stream"}});let{input:e}=o,r=Array.isArray(e)?e.filter(e=>"function"!==e.role):[];a.clear(),l.clear();let i=[...r],s=null,d={model:o.model,tools:o.tools,tool_choice:o.tool_choice,parallel_tool_calls:o.parallel_tool_calls,store:o.store,truncation:o.truncation,temperature:o.temperature,top_p:o.top_p,reasoning:o.reasoning,max_output_tokens:o.max_output_tokens},p=await n(o,i,s,t);if(p.error){t.send({type:"complete",requestId:c,data:{message:"Stream completed with error",error:!0}});return}let{currentResponseId:f,functionCalls:h}=p;for(let{metadata:e,argData:r}of(s=f,h)){t.send({type:"function_call",functionName:e.name,toolCallId:e.toolCallId,data:{functionName:e.name,args:r.args,toolCallId:e.toolCallId,argumentsString:r.argumentsString,requestId:c},requestId:c});try{let r=await u(c);if(r.success){i.push({role:"function",name:e.name,content:r.result,toolCallId:e.toolCallId});let o=await n(d,i,s,t);if(o.error){t.send({type:"complete",requestId:c,data:{message:"Stream completed with error",error:!0}});return}for(let e of(s=o.currentResponseId,o.functionCalls)){t.send({type:"function_call",functionName:e.metadata.name,toolCallId:e.metadata.toolCallId,data:{functionName:e.metadata.name,args:e.argData.args,toolCallId:e.metadata.toolCallId,argumentsString:e.argData.argumentsString,requestId:c},requestId:c});let r=await u(c);if(r.success){i.push({role:"function",name:e.metadata.name,content:r.result,toolCallId:e.metadata.toolCallId});let o=await n(d,i,s,t);if(o.error){t.send({type:"complete",requestId:c,data:{message:"Stream completed with error",error:!0}});return}s=o.currentResponseId}}}else t.send({type:"chunk",data:{type:"error",error:{code:"function_execution_failed",message:`${r.error||"Unknown error"}`}},requestId:c})}catch(e){t.send({type:"chunk",data:{type:"error",error:{code:"function_error",message:`${e.message||"Unknown error"}`}},requestId:c})}}t.send({type:"complete",requestId:c,data:{message:"Stream completed"}})}catch(r){let e="Unknown error occurred",n=[r.response?.data?.error?.message,r.response?.error?.message,r.data?.error?.message,r.error?.message,r.message];for(let t of n)if(t&&"string"==typeof t&&"Unknown error occurred"!==t){e=t;break}t.send({type:"chunk",data:{type:"error",error:{code:r.code||"unknown_error",message:e}},requestId:c}),t.send({type:"complete",requestId:c,data:{message:"Stream completed with error",error:!0}})}}catch(n){console.error("[OpenAI Stream] Top-level handler error:",n);try{t.send({type:"chunk",data:{type:"error",error:{code:"handler_error",message:n.message||"Handler error occurred"}},requestId:e.body?.requestId||"unknown"})}catch(e){console.error("[OpenAI Stream] Failed to send error response:",e)}}};n.default=c},{openai:"MHaIX","../messages/functionResult":"6LK6Q","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],MHaIX:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.UnprocessableEntityError=n.PermissionDeniedError=n.InternalServerError=n.AuthenticationError=n.BadRequestError=n.RateLimitError=n.ConflictError=n.NotFoundError=n.APIUserAbortError=n.APIConnectionTimeoutError=n.APIConnectionError=n.APIError=n.OpenAIError=n.fileFromPath=n.toFile=n.AzureOpenAI=n.OpenAI=void 0;let o=s(e("8ce061e65d07e492")),a=s(e("4f2cabffa02ff70b")),l=s(e("338d602cb952ed02"));s(e("badfde12f1d1fb28"));let u=s(e("b1d347691144ec41")),c=s(e("384804a6693a83c2")),d=e("604b4062ea5ac219"),p=e("40617211b78d976e"),f=e("b653daa46dbf6513"),h=e("e942c4765c0d9716"),m=e("42ea1d60e2f9268c"),g=e("3f73e624de969e0e"),y=e("eaba7a3ba8cabfef"),b=e("d12380c28b8ba2bf"),v=e("c8d9643ffb10739"),_=e("c3663e31de122cd6"),A=e("41760df26605693e"),C=e("c511fe6291b0b4b3"),I=e("8eb5a62146f35f92"),w=e("1c8fa95798aa8c65"),O=e("5064d8f31bc53c47"),T=e("7c2789f2417e2086");class E extends a.APIClient{constructor({baseURL:e=a.readEnv("OPENAI_BASE_URL"),apiKey:t=a.readEnv("OPENAI_API_KEY"),organization:n=a.readEnv("OPENAI_ORG_ID")??null,project:r=a.readEnv("OPENAI_PROJECT_ID")??null,...i}={}){if(void 0===t)throw new l.OpenAIError("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");let s={apiKey:t,organization:n,project:r,...i,baseURL:e||"https://api.openai.com/v1"};if(!s.dangerouslyAllowBrowser&&a.isRunningInBrowser())throw new l.OpenAIError("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:s.baseURL,timeout:s.timeout??6e5,httpAgent:s.httpAgent,maxRetries:s.maxRetries,fetch:s.fetch}),this.completions=new c.Completions(this),this.chat=new c.Chat(this),this.embeddings=new c.Embeddings(this),this.files=new c.Files(this),this.images=new c.Images(this),this.audio=new c.Audio(this),this.moderations=new c.Moderations(this),this.models=new c.Models(this),this.fineTuning=new c.FineTuning(this),this.vectorStores=new c.VectorStores(this),this.beta=new c.Beta(this),this.batches=new c.Batches(this),this.uploads=new c.Uploads(this),this.responses=new c.Responses(this),this.evals=new c.Evals(this),this._options=s,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return o.stringify(e,{arrayFormat:"brackets"})}}n.OpenAI=E,E.OpenAI=E,E.DEFAULT_TIMEOUT=6e5,E.OpenAIError=l.OpenAIError,E.APIError=l.APIError,E.APIConnectionError=l.APIConnectionError,E.APIConnectionTimeoutError=l.APIConnectionTimeoutError,E.APIUserAbortError=l.APIUserAbortError,E.NotFoundError=l.NotFoundError,E.ConflictError=l.ConflictError,E.RateLimitError=l.RateLimitError,E.BadRequestError=l.BadRequestError,E.AuthenticationError=l.AuthenticationError,E.InternalServerError=l.InternalServerError,E.PermissionDeniedError=l.PermissionDeniedError,E.UnprocessableEntityError=l.UnprocessableEntityError,E.toFile=u.toFile,E.fileFromPath=u.fileFromPath,E.Completions=p.Completions,E.Chat=_.Chat,E.ChatCompletionsPage=T.ChatCompletionsPage,E.Embeddings=f.Embeddings,E.Files=h.Files,E.FileObjectsPage=h.FileObjectsPage,E.Images=m.Images,E.Audio=b.Audio,E.Moderations=y.Moderations,E.Models=g.Models,E.ModelsPage=g.ModelsPage,E.FineTuning=C.FineTuning,E.VectorStores=O.VectorStores,E.VectorStoresPage=O.VectorStoresPage,E.VectorStoreSearchResponsesPage=O.VectorStoreSearchResponsesPage,E.Beta=v.Beta,E.Batches=d.Batches,E.BatchesPage=d.BatchesPage,E.Uploads=w.Uploads,E.Responses=I.Responses,E.Evals=A.Evals,E.EvalListResponsesPage=A.EvalListResponsesPage;class S extends E{constructor({baseURL:e=a.readEnv("OPENAI_BASE_URL"),apiKey:t=a.readEnv("AZURE_OPENAI_API_KEY"),apiVersion:n=a.readEnv("OPENAI_API_VERSION"),endpoint:r,deployment:i,azureADTokenProvider:s,dangerouslyAllowBrowser:o,...u}={}){if(!n)throw new l.OpenAIError("The OPENAI_API_VERSION environment variable is missing or empty; either provide it, or instantiate the AzureOpenAI client with an apiVersion option, like new AzureOpenAI({ apiVersion: 'My API Version' }).");if("function"==typeof s&&(o=!0),!s&&!t)throw new l.OpenAIError("Missing credentials. Please pass one of `apiKey` and `azureADTokenProvider`, or set the `AZURE_OPENAI_API_KEY` environment variable.");if(s&&t)throw new l.OpenAIError("The `apiKey` and `azureADTokenProvider` arguments are mutually exclusive; only one can be passed at a time.");if(t??(t=P),u.defaultQuery={...u.defaultQuery,"api-version":n},e){if(r)throw new l.OpenAIError("baseURL and endpoint are mutually exclusive")}else{if(r||(r=void 0),!r)throw new l.OpenAIError("Must provide one of the `baseURL` or `endpoint` arguments, or the `AZURE_OPENAI_ENDPOINT` environment variable");e=`${r}/openai`}super({apiKey:t,baseURL:e,...u,...void 0!==o?{dangerouslyAllowBrowser:o}:{}}),this.apiVersion="",this._azureADTokenProvider=s,this.apiVersion=n,this.deploymentName=i}buildRequest(e,t={}){if(x.has(e.path)&&"post"===e.method&&void 0!==e.body){if(!a.isObj(e.body))throw Error("Expected request body to be an object");let t=this.deploymentName||e.body.model||e.__metadata?.model;void 0===t||this.baseURL.includes("/deployments")||(e.path=`/deployments/${t}${e.path}`)}return super.buildRequest(e,t)}async _getAzureADToken(){if("function"==typeof this._azureADTokenProvider){let e=await this._azureADTokenProvider();if(!e||"string"!=typeof e)throw new l.OpenAIError(`Expected 'azureADTokenProvider' argument to return a string but it returned ${e}`);return e}}authHeaders(e){return{}}async prepareOptions(e){if(e.headers?.["api-key"])return super.prepareOptions(e);let t=await this._getAzureADToken();if(e.headers??(e.headers={}),t)e.headers.Authorization=`Bearer ${t}`;else if(this.apiKey!==P)e.headers["api-key"]=this.apiKey;else throw new l.OpenAIError("Unable to handle auth");return super.prepareOptions(e)}}n.AzureOpenAI=S;let x=new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]),P="<Missing Key>";var R=e("b1d347691144ec41");Object.defineProperty(n,"toFile",{enumerable:!0,get:function(){return R.toFile}}),Object.defineProperty(n,"fileFromPath",{enumerable:!0,get:function(){return R.fileFromPath}});var k=e("338d602cb952ed02");Object.defineProperty(n,"OpenAIError",{enumerable:!0,get:function(){return k.OpenAIError}}),Object.defineProperty(n,"APIError",{enumerable:!0,get:function(){return k.APIError}}),Object.defineProperty(n,"APIConnectionError",{enumerable:!0,get:function(){return k.APIConnectionError}}),Object.defineProperty(n,"APIConnectionTimeoutError",{enumerable:!0,get:function(){return k.APIConnectionTimeoutError}}),Object.defineProperty(n,"APIUserAbortError",{enumerable:!0,get:function(){return k.APIUserAbortError}}),Object.defineProperty(n,"NotFoundError",{enumerable:!0,get:function(){return k.NotFoundError}}),Object.defineProperty(n,"ConflictError",{enumerable:!0,get:function(){return k.ConflictError}}),Object.defineProperty(n,"RateLimitError",{enumerable:!0,get:function(){return k.RateLimitError}}),Object.defineProperty(n,"BadRequestError",{enumerable:!0,get:function(){return k.BadRequestError}}),Object.defineProperty(n,"AuthenticationError",{enumerable:!0,get:function(){return k.AuthenticationError}}),Object.defineProperty(n,"InternalServerError",{enumerable:!0,get:function(){return k.InternalServerError}}),Object.defineProperty(n,"PermissionDeniedError",{enumerable:!0,get:function(){return k.PermissionDeniedError}}),Object.defineProperty(n,"UnprocessableEntityError",{enumerable:!0,get:function(){return k.UnprocessableEntityError}}),n=t.exports=E,t.exports.AzureOpenAI=S,n.default=E},{"8ce061e65d07e492":"2mfH2","4f2cabffa02ff70b":"hBXqu","338d602cb952ed02":"5zs0s",badfde12f1d1fb28:"5CJzy",b1d347691144ec41:"47Mgl","384804a6693a83c2":"iJB9C","604b4062ea5ac219":"byUys","40617211b78d976e":"dOXi5",b653daa46dbf6513:"jXUza",e942c4765c0d9716:"6OMS5","42ea1d60e2f9268c":"eLdl3","3f73e624de969e0e":"kzZF2",eaba7a3ba8cabfef:"2AvxK",d12380c28b8ba2bf:"ln1Hf",c8d9643ffb10739:"goVQu",c3663e31de122cd6:"XPoTI","41760df26605693e":"7VzGj",c511fe6291b0b4b3:"7Gf3p","8eb5a62146f35f92":"aDmtC","1c8fa95798aa8c65":"HmTFH","5064d8f31bc53c47":"9P780","7c2789f2417e2086":"a7Yun"}],"2mfH2":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.formats=n.stringify=void 0;let r=e("d7b05e5fcb41023d"),i={formatters:r.formatters,RFC1738:r.RFC1738,RFC3986:r.RFC3986,default:r.default_format};n.formats=i;var s=e("19afb512ef14c360");Object.defineProperty(n,"stringify",{enumerable:!0,get:function(){return s.stringify}})},{d7b05e5fcb41023d:"bhKJe","19afb512ef14c360":"bNXRr"}],bhKJe:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RFC3986=n.RFC1738=n.formatters=n.default_format=void 0,n.default_format="RFC3986",n.formatters={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},n.RFC1738="RFC1738",n.RFC3986="RFC3986"},{}],bNXRr:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.stringify=void 0;let r=e("6f5286769ff4e203"),i=e("d32bb5e0add84c4"),s=Object.prototype.hasOwnProperty,o={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},a=Array.isArray,l=Array.prototype.push,u=function(e,t){l.apply(e,a(t)?t:[t])},c=Date.prototype.toISOString,d={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:r.encode,encodeValuesOnly:!1,format:i.default_format,formatter:i.formatters[i.default_format],indices:!1,serializeDate:e=>c.call(e),skipNulls:!1,strictNullHandling:!1},p={};n.stringify=function(e,t={}){let n,l=e,c=function(e=d){let t;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw TypeError("Encoder has to be a function.");let n=e.charset||d.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let r=i.default_format;if(void 0!==e.format){if(!s.call(i.formatters,e.format))throw TypeError("Unknown format option provided.");r=e.format}let l=i.formatters[r],u=d.filter;if(("function"==typeof e.filter||a(e.filter))&&(u=e.filter),t=e.arrayFormat&&e.arrayFormat in o?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":d.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw TypeError("`commaRoundTrip` must be a boolean, or absent");let c=void 0===e.allowDots?!0==!!e.encodeDotInKeys||d.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:d.addQueryPrefix,allowDots:c,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:d.allowEmptyArrays,arrayFormat:t,charset:n,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:d.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?d.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:d.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:d.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:d.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:d.encodeValuesOnly,filter:u,format:r,formatter:l,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:d.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:d.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:d.strictNullHandling}}(t);"function"==typeof c.filter?l=(0,c.filter)("",l):a(c.filter)&&(n=c.filter);let f=[];if("object"!=typeof l||null===l)return"";let h=o[c.arrayFormat],m="comma"===h&&c.commaRoundTrip;n||(n=Object.keys(l)),c.sort&&n.sort(c.sort);let g=new WeakMap;for(let e=0;e<n.length;++e){let t=n[e];c.skipNulls&&null===l[t]||u(f,function e(t,n,i,s,o,l,c,f,h,m,g,y,b,v,_,A,C,I){var w;let O,T=t,E=I,S=0,x=!1;for(;void 0!==(E=E.get(p))&&!x;){let e=E.get(t);if(S+=1,void 0!==e){if(e===S)throw RangeError("Cyclic object value");x=!0}void 0===E.get(p)&&(S=0)}if("function"==typeof m?T=m(n,T):T instanceof Date?T=b?.(T):"comma"===i&&a(T)&&(T=(0,r.maybe_map)(T,function(e){return e instanceof Date?b?.(e):e})),null===T){if(l)return h&&!A?h(n,d.encoder,C,"key",v):n;T=""}if("string"==typeof(w=T)||"number"==typeof w||"boolean"==typeof w||"symbol"==typeof w||"bigint"==typeof w||(0,r.is_buffer)(T)){if(h){let e=A?n:h(n,d.encoder,C,"key",v);return[_?.(e)+"="+_?.(h(T,d.encoder,C,"value",v))]}return[_?.(n)+"="+_?.(String(T))]}let P=[];if(void 0===T)return P;if("comma"===i&&a(T))A&&h&&(T=(0,r.maybe_map)(T,h)),O=[{value:T.length>0?T.join(",")||null:void 0}];else if(a(m))O=m;else{let e=Object.keys(T);O=g?e.sort(g):e}let R=f?String(n).replace(/\./g,"%2E"):String(n),k=s&&a(T)&&1===T.length?R+"[]":R;if(o&&a(T)&&0===T.length)return k+"[]";for(let n=0;n<O.length;++n){let r=O[n],d="object"==typeof r&&void 0!==r.value?r.value:T[r];if(c&&null===d)continue;let w=y&&f?r.replace(/\./g,"%2E"):r,E=a(T)?"function"==typeof i?i(k,w):k:k+(y?"."+w:"["+w+"]");I.set(t,S);let x=new WeakMap;x.set(p,I),u(P,e(d,E,i,s,o,l,c,f,"comma"===i&&A&&a(T)?null:h,m,g,y,b,v,_,A,C,x))}return P}(l[t],t,h,m,c.allowEmptyArrays,c.strictNullHandling,c.skipNulls,c.encodeDotInKeys,c.encode?c.encoder:null,c.filter,c.sort,c.allowDots,c.serializeDate,c.format,c.formatter,c.encodeValuesOnly,c.charset,g))}let y=f.join(c.delimiter),b=!0===c.addQueryPrefix?"?":"";return c.charsetSentinel&&("iso-8859-1"===c.charset?b+="utf8=%26%2310003%3B&":b+="utf8=%E2%9C%93&"),y.length>0?b+y:""}},{"6f5286769ff4e203":"bqW4c",d32bb5e0add84c4:"bhKJe"}],bqW4c:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.maybe_map=n.combine=n.is_buffer=n.is_regexp=n.compact=n.encode=n.decode=n.assign_single_source=n.merge=void 0;let r=e("a97ecd2a8560b25c"),i=Object.prototype.hasOwnProperty,s=Array.isArray,o=(()=>{let e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();n.merge=function e(t,n,r={}){if(!n)return t;if("object"!=typeof n){if(s(t))t.push(n);else{if(!t||"object"!=typeof t)return[t,n];(r&&(r.plainObjects||r.allowPrototypes)||!i.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(n);let o=t;return(s(t)&&!s(n)&&(o=function(e,t){let n=t&&t.plainObjects?Object.create(null):{};for(let t=0;t<e.length;++t)void 0!==e[t]&&(n[t]=e[t]);return n}(t,r)),s(t)&&s(n))?(n.forEach(function(n,s){if(i.call(t,s)){let i=t[s];i&&"object"==typeof i&&n&&"object"==typeof n?t[s]=e(i,n,r):t.push(n)}else t[s]=n}),t):Object.keys(n).reduce(function(t,s){let o=n[s];return i.call(t,s)?t[s]=e(t[s],o,r):t[s]=o,t},o)},n.assign_single_source=function(e,t){return Object.keys(t).reduce(function(e,n){return e[n]=t[n],e},e)},n.decode=function(e,t,n){let r=e.replace(/\+/g," ");if("iso-8859-1"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},n.encode=(e,t,n,i,s)=>{if(0===e.length)return e;let a=e;if("symbol"==typeof e?a=Symbol.prototype.toString.call(e):"string"!=typeof e&&(a=String(e)),"iso-8859-1"===n)return escape(a).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});let l="";for(let e=0;e<a.length;e+=1024){let t=a.length>=1024?a.slice(e,e+1024):a,n=[];for(let e=0;e<t.length;++e){let i=t.charCodeAt(e);if(45===i||46===i||95===i||126===i||i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122||s===r.RFC1738&&(40===i||41===i)){n[n.length]=t.charAt(e);continue}if(i<128){n[n.length]=o[i];continue}if(i<2048){n[n.length]=o[192|i>>6]+o[128|63&i];continue}if(i<55296||i>=57344){n[n.length]=o[224|i>>12]+o[128|i>>6&63]+o[128|63&i];continue}e+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(e)),n[n.length]=o[240|i>>18]+o[128|i>>12&63]+o[128|i>>6&63]+o[128|63&i]}l+=n.join("")}return l},n.compact=function(e){let t=[{obj:{o:e},prop:"o"}],n=[];for(let e=0;e<t.length;++e){let r=t[e],i=r.obj[r.prop],s=Object.keys(i);for(let e=0;e<s.length;++e){let r=s[e],o=i[r];"object"==typeof o&&null!==o&&-1===n.indexOf(o)&&(t.push({obj:i,prop:r}),n.push(o))}}return function(e){for(;e.length>1;){let t=e.pop();if(!t)continue;let n=t.obj[t.prop];if(s(n)){let e=[];for(let t=0;t<n.length;++t)void 0!==n[t]&&e.push(n[t]);t.obj[t.prop]=e}}}(t),e},n.is_regexp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},n.is_buffer=function(e){return!!e&&"object"==typeof e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},n.combine=function(e,t){return[].concat(e,t)},n.maybe_map=function(e,t){if(s(e)){let n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}},{a97ecd2a8560b25c:"bhKJe"}],hBXqu:[function(e,t,n){let r;var i,s=e("d1871e620f26a603").Buffer,o=e("6ea8eda525457c5e"),a=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.isObj=n.toFloat32Array=n.toBase64=n.getHeader=n.getRequiredHeader=n.isHeadersProtocol=n.isRunningInBrowser=n.debug=n.hasOwn=n.isEmptyObj=n.maybeCoerceBoolean=n.maybeCoerceFloat=n.maybeCoerceInteger=n.coerceBoolean=n.coerceFloat=n.coerceInteger=n.readEnv=n.ensurePresent=n.castToError=n.sleep=n.safeJSON=n.isRequestOptions=n.createResponseHeaders=n.PagePromise=n.AbstractPage=n.APIClient=n.APIPromise=n.createForm=n.multipartFormRequestOptions=n.maybeMultipartFormRequestOptions=void 0;let u=e("8f759395f890fb09"),c=e("8e31256c70cbb432"),d=e("c00d694556f80218"),p=e("1fbc8e19a281e159");(0,p.init)();let f=e("f141b39a14e6200e");var h=e("f141b39a14e6200e");async function m(e){let{response:t}=e;if(e.options.stream)return(k("response",t.status,t.url,t.headers,t.body),e.options.__streamClass)?e.options.__streamClass.fromSSEResponse(t,e.controller):c.Stream.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;let n=t.headers.get("content-type"),r=n?.split(";")[0]?.trim(),i=r?.includes("application/json")||r?.endsWith("+json");if(i){let e=await t.json();return k("response",t.status,t.url,t.headers,e),g(e,t)}let s=await t.text();return k("response",t.status,t.url,t.headers,s),s}function g(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}Object.defineProperty(n,"maybeMultipartFormRequestOptions",{enumerable:!0,get:function(){return h.maybeMultipartFormRequestOptions}}),Object.defineProperty(n,"multipartFormRequestOptions",{enumerable:!0,get:function(){return h.multipartFormRequestOptions}}),Object.defineProperty(n,"createForm",{enumerable:!0,get:function(){return h.createForm}});class y extends Promise{constructor(e,t=m){super(e=>{e(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new y(this.responsePromise,async t=>g(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}n.APIPromise=y,n.APIClient=class{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:i}){this.baseURL=e,this.maxRetries=E("maxRetries",t),this.timeout=E("timeout",n),this.httpAgent=r,this.fetch=i??p.fetch}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...w(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${M()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async n=>{let r=n&&(0,f.isBlobLike)(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:r}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if("string"==typeof e){if(void 0!==s)return s.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder){let t=new TextEncoder,n=t.encode(e);return n.length.toString()}}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){let n={...e},{method:r,path:i,query:s,headers:o={}}=n,a=ArrayBuffer.isView(n.body)||n.__binaryRequest&&"string"==typeof n.body?n.body:(0,f.isMultipartBody)(n.body)?n.body.body:n.body?JSON.stringify(n.body,null,2):null,l=this.calculateContentLength(a),u=this.buildURL(i,s);"timeout"in n&&E("timeout",n.timeout),n.timeout=n.timeout??this.timeout;let c=n.httpAgent??this.httpAgent??(0,p.getDefaultAgent)(u),d=n.timeout+1e3;"number"==typeof c?.options?.timeout&&d>(c.options.timeout??0)&&(c.options.timeout=d),this.idempotencyHeader&&"get"!==r&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);let h=this.buildHeaders({options:n,headers:o,contentLength:l,retryCount:t}),m={method:r,...a&&{body:a},headers:h,...c&&{agent:c},signal:n.signal??null};return{req:m,url:u,timeout:n.timeout}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:i}){let s={};r&&(s["content-length"]=r);let o=this.defaultHeaders(e);return P(s,o),P(s,t),(0,f.isMultipartBody)(e.body)&&"node"!==p.kind&&delete s["content-type"],void 0===(0,n.getHeader)(o,"x-stainless-retry-count")&&void 0===(0,n.getHeader)(t,"x-stainless-retry-count")&&(s["x-stainless-retry-count"]=String(i)),void 0===(0,n.getHeader)(o,"x-stainless-timeout")&&void 0===(0,n.getHeader)(t,"x-stainless-timeout")&&e.timeout&&(s["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(s,t),s}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(e=>[...e])):{...e}:{}}makeStatusError(e,t,n,r){return d.APIError.generate(e,t,n,r)}request(e,t=null){return new y(this.makeRequest(e,t))}async makeRequest(e,t){let r=await e,i=r.maxRetries??this.maxRetries;null==t&&(t=i),await this.prepareOptions(r);let{req:s,url:o,timeout:a}=this.buildRequest(r,{retryCount:i-t});if(await this.prepareRequest(s,{url:o,options:r}),k("request",o,r,s.headers),r.signal?.aborted)throw new d.APIUserAbortError;let l=new AbortController,u=await this.fetchWithTimeout(o,s,a,l).catch(n.castToError);if(u instanceof Error){if(r.signal?.aborted)throw new d.APIUserAbortError;if(t)return this.retryRequest(r,t);if("AbortError"===u.name)throw new d.APIConnectionTimeoutError;throw new d.APIConnectionError({cause:u})}let c=(0,n.createResponseHeaders)(u.headers);if(!u.ok){if(t&&this.shouldRetry(u)){let e=`retrying, ${t} attempts remaining`;return k(`response (error; ${e})`,u.status,o,c),this.retryRequest(r,t,c)}let e=await u.text().catch(e=>(0,n.castToError)(e).message),i=(0,n.safeJSON)(e),s=i?void 0:e,a=t?"(error; no more retries left)":"(error; not retryable)";k(`response (error; ${a})`,u.status,o,c,s);let l=this.makeStatusError(u.status,i,s,c);throw l}return{response:u,options:r,controller:l}}requestAPIList(e,t){let n=this.makeRequest(t,null);return new v(this,n,e)}buildURL(e,t){let n=new URL(T(e)?e:this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return S(r)||(t={...r,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new d.OpenAIError(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,r){let{signal:i,...s}=t||{};i&&i.addEventListener("abort",()=>r.abort());let o=setTimeout(()=>r.abort(),n),a={signal:r.signal,...s};return a.method&&(a.method=a.method.toUpperCase()),this.fetch.call(void 0,e,a).finally(()=>{clearTimeout(o)})}shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||e.status>=500)}async retryRequest(e,t,r){let i;let s=r?.["retry-after-ms"];if(s){let e=parseFloat(s);Number.isNaN(e)||(i=e)}let o=r?.["retry-after"];if(o&&!i){let e=parseFloat(o);i=Number.isNaN(e)?Date.parse(o)-Date.now():1e3*e}if(!(i&&0<=i&&i<6e4)){let n=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(t,n)}return await (0,n.sleep)(i),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${u.VERSION}`}};class b{constructor(e,t,n,r){i.set(this,void 0),a(this,i,e,"f"),this.options=r,this.response=t,this.body=n}hasNextPage(){let e=this.getPaginatedItems();return!!e.length&&null!=this.nextPageInfo()}async getNextPage(){let e=this.nextPageInfo();if(!e)throw new d.OpenAIError("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");let t={...this.options};if("params"in e&&"object"==typeof t.query)t.query={...t.query,...e.params};else if("url"in e){let n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(let[t,r]of n)e.url.searchParams.set(t,r);t.query=void 0,t.path=e.url.toString()}return await l(this,i,"f").requestAPIList(this.constructor,t)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(i=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}}n.AbstractPage=b;class v extends y{constructor(e,t,n){super(t,async t=>new n(e,t.response,await m(t),t.options))}async *[Symbol.asyncIterator](){let e=await this;for await(let t of e)yield t}}n.PagePromise=v,n.createResponseHeaders=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){let n=t.toString();return e[n.toLowerCase()]||e[n]}});let _={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0};n.isRequestOptions=e=>"object"==typeof e&&null!==e&&!S(e)&&Object.keys(e).every(e=>x(_,e));let A=()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":u.VERSION,"X-Stainless-OS":I(Deno.build.os),"X-Stainless-Arch":C(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":u.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":o.version};if("[object process]"===Object.prototype.toString.call(void 0!==o?o:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":u.VERSION,"X-Stainless-OS":I(o.platform),"X-Stainless-Arch":C(o.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":o.version};let e=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let n=t.exec(navigator.userAgent);if(n){let t=n[1]||0,r=n[2]||0,i=n[3]||0;return{browser:e,version:`${t}.${r}.${i}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":u.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":u.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},C=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",I=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown",w=()=>r??(r=A());n.safeJSON=e=>{try{return JSON.parse(e)}catch(e){return}};let O=/^[a-z][a-z0-9+.-]*:/i,T=e=>O.test(e);n.sleep=e=>new Promise(t=>setTimeout(t,e));let E=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new d.OpenAIError(`${e} must be an integer`);if(t<0)throw new d.OpenAIError(`${e} must be a positive integer`);return t};function S(e){if(!e)return!0;for(let t in e)return!1;return!0}function x(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function P(e,t){for(let n in t){if(!x(t,n))continue;let r=n.toLowerCase();if(!r)continue;let i=t[n];null===i?delete e[r]:void 0!==i&&(e[r]=i)}}n.castToError=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e)try{return Error(JSON.stringify(e))}catch{}return Error(e)},n.ensurePresent=e=>{if(null==e)throw new d.OpenAIError(`Expected a value to be given but received ${e} instead.`);return e},n.readEnv=e=>void 0!==o?o.env?.[e]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(e)?.trim():void 0,n.coerceInteger=e=>{if("number"==typeof e)return Math.round(e);if("string"==typeof e)return parseInt(e,10);throw new d.OpenAIError(`Could not coerce ${e} (type: ${typeof e}) into a number`)},n.coerceFloat=e=>{if("number"==typeof e)return e;if("string"==typeof e)return parseFloat(e);throw new d.OpenAIError(`Could not coerce ${e} (type: ${typeof e}) into a number`)},n.coerceBoolean=e=>"boolean"==typeof e?e:"string"==typeof e?"true"===e:!!e,n.maybeCoerceInteger=e=>{if(void 0!==e)return(0,n.coerceInteger)(e)},n.maybeCoerceFloat=e=>{if(void 0!==e)return(0,n.coerceFloat)(e)},n.maybeCoerceBoolean=e=>{if(void 0!==e)return(0,n.coerceBoolean)(e)},n.isEmptyObj=S,n.hasOwn=x;let R=new Set(["authorization","api-key"]);function k(e,...t){if(void 0!==o&&o?.env?.DEBUG==="true"){let n=t.map(e=>{if(!e)return e;if(e.headers){let t={...e,headers:{...e.headers}};for(let n in e.headers)R.has(n.toLowerCase())&&(t.headers[n]="REDACTED");return t}let t=null;for(let n in e)R.has(n.toLowerCase())&&(t??(t={...e}),t[n]="REDACTED");return t??e});console.log(`OpenAI:DEBUG:${e}`,...n)}}n.debug=k;let M=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)});n.isRunningInBrowser=()=>"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator,n.isHeadersProtocol=e=>"function"==typeof e?.get,n.getRequiredHeader=(e,t)=>{let r=(0,n.getHeader)(e,t);if(void 0===r)throw Error(`Could not find ${t} header`);return r},n.getHeader=(e,t)=>{let r=t.toLowerCase();if((0,n.isHeadersProtocol)(e)){let n=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,(e,t,n)=>t+n.toUpperCase());for(let i of[t,r,t.toUpperCase(),n]){let t=e.get(i);if(t)return t}}for(let[n,i]of Object.entries(e))if(n.toLowerCase()===r){if(Array.isArray(i)){if(i.length<=1)return i[0];return console.warn(`Received ${i.length} entries for the ${t} header, using the first entry.`),i[0]}return i}},n.toBase64=e=>{if(!e)return"";if(void 0!==s)return s.from(e).toString("base64");if("undefined"!=typeof btoa)return btoa(e);throw new d.OpenAIError("Cannot generate b64 string; Expected `Buffer` or `btoa` to be defined")},n.toFloat32Array=e=>{if(void 0!==s){let t=s.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}{let t=atob(e),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return Array.from(new Float32Array(r.buffer))}},n.isObj=function(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}},{d1871e620f26a603:"8Ko5i","6ea8eda525457c5e":"jDYfS","8f759395f890fb09":"lGdw3","8e31256c70cbb432":"jisQ5",c00d694556f80218:"5zs0s","1fbc8e19a281e159":"l6z6v",f141b39a14e6200e:"47Mgl"}],"8Ko5i":[function(e,t,n){var r,i,s=Object.create,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,u=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,d=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),p=(e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of l(t))c.call(e,i)||i===n||o(e,i,{get:()=>t[i],enumerable:!(r=a(t,i))||r.enumerable});return e},f=(e,t,n)=>(n=null!=e?s(u(e)):{},p(!t&&e&&e.__esModule?n:o(n,"default",{value:e,enumerable:!0}),e)),h=d(e=>{e.byteLength=function(e){var t=a(e),n=t[0],r=t[1];return(n+r)*3/4-r},e.toByteArray=function(e){var t,n,r=a(e),o=r[0],l=r[1],u=new s((o+l)*3/4-l),c=0,d=l>0?o-4:o;for(n=0;n<d;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===l&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,u[c++]=255&t),1===l&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u},e.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],o=0,a=n-i;o<a;o+=16383)s.push(function(e,t,n){for(var i,s=[],o=t;o<n;o+=3)s.push(r[(i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}(e,o,o+16383>a?a:o+16383));return 1===i?s.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===i&&s.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),s.join("")};var t,n,r=[],i=[],s="u">typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(t=0,n=o.length;t<n;++t)r[t]=o[t],i[o.charCodeAt(t)]=t;function a(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var r=n===t?0:4-n%4;return[n,r]}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63}),m=d(e=>{e.read=function(e,t,n,r,i){var s,o,a=8*i-r-1,l=(1<<a)-1,u=l>>1,c=-7,d=n?i-1:0,p=n?-1:1,f=e[t+d];for(d+=p,s=f&(1<<-c)-1,f>>=-c,c+=a;c>0;s=256*s+e[t+d],d+=p,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=r;c>0;o=256*o+e[t+d],d+=p,c-=8);if(0===s)s=1-u;else{if(s===l)return o?NaN:(f?-1:1)*(1/0);o+=Math.pow(2,r),s-=u}return(f?-1:1)*o*Math.pow(2,s-r)},e.write=function(e,t,n,r,i,s){var o,a,l,u=8*s-i-1,c=(1<<u)-1,d=c>>1,p=23===i?5960464477539062e-23:0,f=r?0:s-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(a=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+d>=1?t+=p/l:t+=p*Math.pow(2,1-d),t*l>=2&&(o++,l/=2),o+d>=c?(a=0,o=c):o+d>=1?(a=(t*l-1)*Math.pow(2,i),o+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[n+f]=255&a,f+=h,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;e[n+f]=255&o,f+=h,o/=256,u-=8);e[n+f-h]|=128*m}}),g=d(e=>{var t=h(),n=m(),r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function i(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,n){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return l(e)}return o(e,t,n)}function o(e,t,n){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!s.isEncoding(t))throw TypeError("Unknown encoding: "+t);let n=0|p(e,t),r=i(n),o=r.write(e,t);return o!==n&&(r=r.slice(0,o)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(U(e,Uint8Array)){let t=new Uint8Array(e);return c(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(U(e,ArrayBuffer)||e&&U(e.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(U(e,SharedArrayBuffer)||e&&U(e.buffer,SharedArrayBuffer)))return c(e,t,n);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return s.from(r,t,n);let o=function(e){var t;if(s.isBuffer(e)){let t=0|d(e.length),n=i(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?i(0):u(e):"Buffer"===e.type&&Array.isArray(e.data)?u(e.data):void 0}(e);if(o)return o;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,n);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function a(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function l(e){return a(e),i(e<0?0:0|d(e))}function u(e){let t=e.length<0?0:0|d(e.length),n=i(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function c(e,t,n){let r;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),s.prototype),r}function d(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||U(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return N(e).length;default:if(i)return r?-1:j(e).length;t=(""+t).toLowerCase(),i=!0}}function f(e,n,r){let i=!1;if((void 0===n||n<0)&&(n=0),n>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0)||(r>>>=0)<=(n>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,n){let r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=L[e[r]];return i}(this,n,r);case"utf8":case"utf-8":return v(this,n,r);case"ascii":return function(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}(this,n,r);case"latin1":case"binary":return function(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}(this,n,r);case"base64":var s,o;return s=n,o=r,0===s&&o===this.length?t.fromByteArray(this):t.fromByteArray(this.slice(s,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){let r=e.slice(t,n),i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}(this,n,r);default:if(i)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function g(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,i){var o;if(0===e.length)return -1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),(o=n=+n)!=o&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return -1;n=e.length-1}else if(n<0){if(!i)return -1;n=0}if("string"==typeof t&&(t=s.from(t,r)),s.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,i);throw TypeError("val must be string, number or Buffer")}function b(e,t,n,r,i){let s,o=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;o=2,a/=2,l/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let r=-1;for(s=n;s<a;s++)if(u(e,s)===u(t,-1===r?0:s-r)){if(-1===r&&(r=s),s-r+1===l)return r*o}else -1!==r&&(s-=s-r),r=-1}else for(n+l>a&&(n=a-l),s=n;s>=0;s--){let n=!0;for(let r=0;r<l;r++)if(u(e,s+r)!==u(t,r)){n=!1;break}if(n)return s}return -1}function v(e,t,n){n=Math.min(e.length,n);let r=[],i=t;for(;i<n;){let t=e[i],s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=n){let n,r,a,l;switch(o){case 1:t<128&&(s=t);break;case 2:(192&(n=e[i+1]))==128&&(l=(31&t)<<6|63&n)>127&&(s=l);break;case 3:n=e[i+1],r=e[i+2],(192&n)==128&&(192&r)==128&&(l=(15&t)<<12|(63&n)<<6|63&r)>2047&&(l<55296||l>57343)&&(s=l);break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],(192&n)==128&&(192&r)==128&&(192&a)==128&&(l=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a)>65535&&l<1114112&&(s=l)}}null===s?(s=65533,o=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),i+=o}return function(e){let t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}function _(e,t,n){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>n)throw RangeError("Trying to access beyond buffer length")}function A(e,t,n,r,i,o){if(!s.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw RangeError('"value" argument is out of bounds');if(n+r>e.length)throw RangeError("Index out of range")}function C(e,t,n,r,i){P(t,r,i,e,n,7);let s=Number(t&BigInt(4294967295));e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function I(e,t,n,r,i){P(t,r,i,e,n,7);let s=Number(t&BigInt(4294967295));e[n+7]=s,s>>=8,e[n+6]=s,s>>=8,e[n+5]=s,s>>=8,e[n+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function w(e,t,n,r,i,s){if(n+r>e.length||n<0)throw RangeError("Index out of range")}function O(e,t,r,i,s){return t=+t,r>>>=0,s||w(e,t,r,4,34028234663852886e22,-34028234663852886e22),n.write(e,t,r,i,23,4),r+4}function T(e,t,r,i,s){return t=+t,r>>>=0,s||w(e,t,r,8,17976931348623157e292,-17976931348623157e292),n.write(e,t,r,i,52,8),r+8}e.Buffer=s,e.SlowBuffer=function(e){return+e!=e&&(e=0),s.alloc(+e)},e.INSPECT_MAX_BYTES=50,e.kMaxLength=2147483647,s.TYPED_ARRAY_SUPPORT=function(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),!s.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,n){return o(e,t,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,n){return a(e),e<=0?i(e):void 0!==t?"string"==typeof n?i(e).fill(t,n):i(e).fill(t):i(e)},s.allocUnsafe=function(e){return l(e)},s.allocUnsafeSlow=function(e){return l(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(U(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),U(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){let n;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;let r=s.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){let t=e[n];if(U(t,Uint8Array))i+t.length>r.length?(s.isBuffer(t)||(t=s.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else if(s.isBuffer(t))t.copy(r,i);else throw TypeError('"list" argument must be an Array of Buffers');i+=t.length}return r},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)g(this,t,t+1);return this},s.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},s.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},s.prototype.toString=function(){let e=this.length;return 0===e?"":0==arguments.length?v(this,0,e):f.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){let t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(e,t,n,r,i){if(U(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return -1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;let o=i-r,a=n-t,l=Math.min(o,a),u=this.slice(r,i),c=e.slice(t,n);for(let e=0;e<l;++e)if(u[e]!==c[e]){o=u[e],a=c[e];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(e,t,n){return -1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},s.prototype.write=function(e,t,n,r){var i,s,o,a,l,u,c,d;if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let p=this.length-t;if((void 0===n||n>p)&&(n=p),e.length>0&&(n<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let f=!1;for(;;)switch(r){case"hex":return function(e,t,n,r){let i;n=Number(n)||0;let s=e.length-n;r?(r=Number(r))>s&&(r=s):r=s;let o=t.length;for(r>o/2&&(r=o/2),i=0;i<r;++i){let r=parseInt(t.substr(2*i,2),16);if(r!=r)break;e[n+i]=r}return i}(this,e,t,n);case"utf8":case"utf-8":return i=t,s=n,D(j(e,this.length-i),this,i,s);case"ascii":case"latin1":case"binary":return o=t,a=n,D(function(e){let t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(e),this,o,a);case"base64":return l=t,u=n,D(N(e),this,l,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c=t,d=n,D(function(e,t){let n,r,i=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=(n=e.charCodeAt(s))>>8,i.push(n%256),i.push(r);return i}(e,this.length-c),this,c,d);default:if(f)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),f=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(e,t){let n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);let r=this.subarray(e,t);return Object.setPrototypeOf(r,s.prototype),r},s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||_(e,t,this.length);let r=this[e],i=1,s=0;for(;++s<t&&(i*=256);)r+=this[e+s]*i;return r},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||_(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e>>>=0,t||_(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||_(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||_(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||_(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||_(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readBigUInt64LE=F(function(e){R(e>>>=0,"offset");let t=this[e],n=this[e+7];(void 0===t||void 0===n)&&k(e,this.length-8);let r=t+256*this[++e]+65536*this[++e]+16777216*this[++e],i=this[++e]+256*this[++e]+65536*this[++e]+16777216*n;return BigInt(r)+(BigInt(i)<<BigInt(32))}),s.prototype.readBigUInt64BE=F(function(e){R(e>>>=0,"offset");let t=this[e],n=this[e+7];(void 0===t||void 0===n)&&k(e,this.length-8);let r=16777216*t+65536*this[++e]+256*this[++e]+this[++e],i=16777216*this[++e]+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)}),s.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||_(e,t,this.length);let r=this[e],i=1,s=0;for(;++s<t&&(i*=256);)r+=this[e+s]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},s.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||_(e,t,this.length);let r=t,i=1,s=this[e+--r];for(;r>0&&(i*=256);)s+=this[e+--r]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*t)),s},s.prototype.readInt8=function(e,t){return e>>>=0,t||_(e,1,this.length),128&this[e]?-((255-this[e]+1)*1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||_(e,2,this.length);let n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){e>>>=0,t||_(e,2,this.length);let n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||_(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||_(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readBigInt64LE=F(function(e){R(e>>>=0,"offset");let t=this[e],n=this[e+7];return(void 0===t||void 0===n)&&k(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+16777216*this[++e])}),s.prototype.readBigInt64BE=F(function(e){R(e>>>=0,"offset");let t=this[e],n=this[e+7];return(void 0===t||void 0===n)&&k(e,this.length-8),(BigInt((t<<24)+65536*this[++e]+256*this[++e]+this[++e])<<BigInt(32))+BigInt(16777216*this[++e]+65536*this[++e]+256*this[++e]+n)}),s.prototype.readFloatLE=function(e,t){return e>>>=0,t||_(e,4,this.length),n.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||_(e,4,this.length),n.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||_(e,8,this.length),n.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||_(e,8,this.length),n.read(this,e,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){let r=Math.pow(2,8*n)-1;A(this,e,t,n,r,0)}let i=1,s=0;for(this[t]=255&e;++s<n&&(i*=256);)this[t+s]=e/i&255;return t+n},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){let r=Math.pow(2,8*n)-1;A(this,e,t,n,r,0)}let i=n-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+n},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigUInt64LE=F(function(e,t=0){return C(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=F(function(e,t=0){return I(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){let r=Math.pow(2,8*n-1);A(this,e,t,n,r-1,-r)}let i=0,s=1,o=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+n},s.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){let r=Math.pow(2,8*n-1);A(this,e,t,n,r-1,-r)}let i=n-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigInt64LE=F(function(e,t=0){return C(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=F(function(e,t=0){return I(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeFloatLE=function(e,t,n){return O(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return O(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return T(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return T(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,r){if(!s.isBuffer(e))throw TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);let i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},s.prototype.fill=function(e,t,n,r){let i;if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===e.length){let t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{let o=s.isBuffer(e)?e:s.from(e,r),a=o.length;if(0===a)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%a]}return this};var E={};function S(e,t,n){E[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name="".concat(this.name," [").concat(e,"]"),this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}}function x(e){let t="",n=e.length,r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t="_".concat(e.slice(n-3,n)).concat(t);return"".concat(e.slice(0,n)).concat(t)}function P(e,t,n,r,i,s){if(e>n||e<t){let r="bigint"==typeof t?"n":"",i;throw i=s>3?0===t||t===BigInt(0)?">= 0".concat(r," and < 2").concat(r," ** ").concat((s+1)*8).concat(r):">= -(2".concat(r," ** ").concat((s+1)*8-1).concat(r,") and < 2 ** ")+"".concat((s+1)*8-1).concat(r):">= ".concat(t).concat(r," and <= ").concat(n).concat(r),new E.ERR_OUT_OF_RANGE("value",i,e)}R(i,"offset"),(void 0===r[i]||void 0===r[i+s])&&k(i,r.length-(s+1))}function R(e,t){if("number"!=typeof e)throw new E.ERR_INVALID_ARG_TYPE(t,"number",e)}function k(e,t,n){throw Math.floor(e)!==e?(R(e,n),new E.ERR_OUT_OF_RANGE(n||"offset","an integer",e)):t<0?new E.ERR_BUFFER_OUT_OF_BOUNDS:new E.ERR_OUT_OF_RANGE(n||"offset",">= ".concat(n?1:0," and <= ").concat(t),e)}S("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"},RangeError),S("ERR_INVALID_ARG_TYPE",function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)},TypeError),S("ERR_OUT_OF_RANGE",function(e,t,n){let r='The value of "'.concat(e,'" is out of range.'),i=n;return Number.isInteger(n)&&Math.abs(n)>4294967296?i=x(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=x(i)),i+="n"),r+=" It must be ".concat(t,". Received ").concat(i)},RangeError);var M=/[^+/0-9A-Za-z-_]/g;function j(e,t){t=t||1/0;let n,r=e.length,i=null,s=[];for(let o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319||o+1===r){(t-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),i=n;continue}n=(i-55296<<10|n-56320)+65536}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else if(n<1114112){if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else throw Error("Invalid code point")}return s}function N(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(M,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function D(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function U(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var L=function(){let e="0123456789abcdef",t=Array(256);for(let n=0;n<16;++n){let r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function F(e){return typeof BigInt>"u"?B:e}function B(){throw Error("BigInt not supported")}}),y={};((e,t)=>{for(var n in t)o(e,n,{get:t[n],enumerable:!0})})(y,{default:()=>v}),t.exports=p(o({},"__esModule",{value:!0}),y);var b=f(g());r=f(g()),i=t.exports,p(y,r,"default"),i&&p(i,r,"default");var v=b.default;/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
*/},{}],jDYfS:[function(e,t,n){var r,i,s,o,a=Object.create,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,c=Object.getOwnPropertyNames,d=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty,f=(e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of c(t))p.call(e,i)||i===n||l(e,i,{get:()=>t[i],enumerable:!(r=u(t,i))||r.enumerable});return e},h=(e,t,n)=>(n=null!=e?a(d(e)):{},f(!t&&e&&e.__esModule?n:l(n,"default",{value:e,enumerable:!0}),e)),m=(r=(e,t)=>{var n,r,i=t.exports={};function s(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var l,u=[],c=!1,d=-1;function p(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&f())}function f(){if(!c){var e=a(p);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new h(e,t)),1!==u.length||c||a(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}},()=>(i||r((i={exports:{}}).exports,i),i.exports)),g={};((e,t)=>{for(var n in t)l(e,n,{get:t[n],enumerable:!0})})(g,{default:()=>b}),t.exports=f(l({},"__esModule",{value:!0}),g);var y=h(m());s=h(m()),o=t.exports,f(g,s,"default"),o&&f(o,s,"default");var b=y.default},{}],lGdw3:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.VERSION=void 0,n.VERSION="4.97.0"},{}],jisQ5:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n._iterSSEMessages=n.Stream=void 0;let r=e("624af3d69288781c"),i=e("e930e9dd4e97c4f1"),s=e("7ce7c14cc8cc1881"),o=e("96a19ab8ebc38a0e"),a=e("afbd2fd3d13b2b60"),l=e("e930e9dd4e97c4f1");class u{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;return new u(async function*(){if(n)throw Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(let n of c(e,t))if(!r){if(n.data.startsWith("[DONE]")){r=!0;continue}if(null===n.event||n.event.startsWith("response.")||n.event.startsWith("transcript.")){let t;try{t=JSON.parse(n.data)}catch(e){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),e}if(t&&t.error)throw new l.APIError(void 0,t.error,void 0,(0,a.createResponseHeaders)(e.headers));yield t}else{let e;try{e=JSON.parse(n.data)}catch(e){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),e}if("error"==n.event)throw new l.APIError(void 0,e.error,e.message,void 0);yield{event:n.event,data:e}}}r=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{r||t.abort()}},t)}static fromReadableStream(e,t){let n=!1;async function*r(){let t=new s.LineDecoder,n=(0,o.ReadableStreamToAsyncIterable)(e);for await(let e of n)for(let n of t.decode(e))yield n;for(let e of t.flush())yield e}return new u(async function*(){if(n)throw Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let e=!1;try{for await(let t of r())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{e||t.abort()}},t)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],t=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){let r=n.next();e.push(r),t.push(r)}return r.shift()}});return[new u(()=>r(e),this.controller),new u(()=>r(t),this.controller)]}toReadableStream(){let e;let t=this,n=new TextEncoder;return new r.ReadableStream({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:r,done:i}=await e.next();if(i)return t.close();let s=n.encode(JSON.stringify(r)+"\n");t.enqueue(s)}catch(e){t.error(e)}},async cancel(){await e.return?.()}})}}async function*c(e,t){if(!e.body)throw t.abort(),new i.OpenAIError("Attempted to iterate over a response with no body");let n=new p,r=new s.LineDecoder,a=(0,o.ReadableStreamToAsyncIterable)(e.body);for await(let e of d(a))for(let t of r.decode(e)){let e=n.decode(t);e&&(yield e)}for(let e of r.flush()){let t=n.decode(e);t&&(yield t)}}async function*d(e){let t=new Uint8Array;for await(let n of e){let e;if(null==n)continue;let r=n instanceof ArrayBuffer?new Uint8Array(n):"string"==typeof n?new TextEncoder().encode(n):n,i=new Uint8Array(t.length+r.length);for(i.set(t),i.set(r,t.length),t=i;-1!==(e=(0,s.findDoubleNewlineIndex)(t));)yield t.slice(0,e),t=t.slice(e)}t.length>0&&(yield t)}n.Stream=u,n._iterSSEMessages=c;class p{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=function(e,t){let n=e.indexOf(t);return -1!==n?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}(e,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===t?this.event=r:"data"===t&&this.data.push(r),null}}},{"624af3d69288781c":"l6z6v",e930e9dd4e97c4f1:"5zs0s","7ce7c14cc8cc1881":"jnbUL","96a19ab8ebc38a0e":"eWdEN",afbd2fd3d13b2b60:"hBXqu"}],l6z6v:[function(e,t,n){let r=e("56aff3eef75c9afc"),i=e("9148ea58df6c7843");for(let e of(n.init=()=>{r.kind||r.setShims(i.getRuntime(),{auto:!0})},Object.keys(r)))Object.defineProperty(n,e,{get:()=>r[e]});n.init()},{"56aff3eef75c9afc":"lRmdX","9148ea58df6c7843":"1cB00"}],lRmdX:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.setShims=n.isFsReadStream=n.fileFromPath=n.getDefaultAgent=n.getMultipartRequestOptions=n.ReadableStream=n.File=n.Blob=n.FormData=n.Headers=n.Response=n.Request=n.fetch=n.kind=n.auto=void 0,n.auto=!1,n.kind=void 0,n.fetch=void 0,n.Request=void 0,n.Response=void 0,n.Headers=void 0,n.FormData=void 0,n.Blob=void 0,n.File=void 0,n.ReadableStream=void 0,n.getMultipartRequestOptions=void 0,n.getDefaultAgent=void 0,n.fileFromPath=void 0,n.isFsReadStream=void 0,n.setShims=function(e,t={auto:!1}){if(n.auto)throw Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(n.kind)throw Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${n.kind}'\``);n.auto=t.auto,n.kind=e.kind,n.fetch=e.fetch,n.Request=e.Request,n.Response=e.Response,n.Headers=e.Headers,n.FormData=e.FormData,n.Blob=e.Blob,n.File=e.File,n.ReadableStream=e.ReadableStream,n.getMultipartRequestOptions=e.getMultipartRequestOptions,n.getDefaultAgent=e.getDefaultAgent,n.fileFromPath=e.fileFromPath,n.isFsReadStream=e.isFsReadStream}},{}],"1cB00":[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("1acfe61e208c447a"),n)},{"1acfe61e208c447a":"201On"}],"201On":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getRuntime=void 0;let r=e("5b14f7da248f686");n.getRuntime=function({manuallyImported:e}={}){let t,n,i,s;let o=e?"You may need to use polyfills":`Add one of these imports before your first \`import \u2026 from 'openai'\`:
- \`import 'openai/shims/node'\` (if you're running on Node)
- \`import 'openai/shims/web'\` (otherwise)
`;try{t=fetch,n=Request,i=Response,s=Headers}catch(e){throw Error(`this environment is missing the following Web Fetch API type: ${e.message}. ${o}`)}return{kind:"web",fetch:t,Request:n,Response:i,Headers:s,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${o}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${o}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${o}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${o}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new r.MultipartBody(e)}),getDefaultAgent:e=>void 0,fileFromPath:()=>{throw Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}},{"5b14f7da248f686":"71DuG"}],"71DuG":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultipartBody=void 0;class r{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}n.MultipartBody=r},{}],"5zs0s":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ContentFilterFinishReasonError=n.LengthFinishReasonError=n.InternalServerError=n.RateLimitError=n.UnprocessableEntityError=n.ConflictError=n.NotFoundError=n.PermissionDeniedError=n.AuthenticationError=n.BadRequestError=n.APIConnectionTimeoutError=n.APIConnectionError=n.APIUserAbortError=n.APIError=n.OpenAIError=void 0;let r=e("845f3bdf197c2ad1");class i extends Error{}n.OpenAIError=i;class s extends i{constructor(e,t,n,r){super(`${s.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r?.["x-request-id"],this.error=t,this.code=t?.code,this.param=t?.param,this.type=t?.type}static makeMessage(e,t,n){let r=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,i){if(!e||!i)return new o({message:n,cause:(0,r.castToError)(t)});let m=t?.error;return 400===e?new a(e,m,n,i):401===e?new l(e,m,n,i):403===e?new u(e,m,n,i):404===e?new c(e,m,n,i):409===e?new d(e,m,n,i):422===e?new p(e,m,n,i):429===e?new f(e,m,n,i):e>=500?new h(e,m,n,i):new s(e,m,n,i)}}n.APIError=s,n.APIUserAbortError=class extends s{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}};class o extends s{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}n.APIConnectionError=o,n.APIConnectionTimeoutError=class extends o{constructor({message:e}={}){super({message:e??"Request timed out."})}};class a extends s{}n.BadRequestError=a;class l extends s{}n.AuthenticationError=l;class u extends s{}n.PermissionDeniedError=u;class c extends s{}n.NotFoundError=c;class d extends s{}n.ConflictError=d;class p extends s{}n.UnprocessableEntityError=p;class f extends s{}n.RateLimitError=f;class h extends s{}n.InternalServerError=h,n.LengthFinishReasonError=class extends i{constructor(){super("Could not parse response content as the length limit was reached")}},n.ContentFilterFinishReasonError=class extends i{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}},{"845f3bdf197c2ad1":"hBXqu"}],jnbUL:[function(e,t,n){var r,i=e("c4d280f26b9b94f9").Buffer,s=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.findDoubleNewlineIndex=n.LineDecoder=void 0;let a=e("ca7d071fad7b4828");class l{constructor(){r.set(this,void 0),this.buffer=new Uint8Array,s(this,r,null,"f")}decode(e){let t;if(null==e)return[];let n=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?new TextEncoder().encode(e):e,i=new Uint8Array(this.buffer.length+n.length);i.set(this.buffer),i.set(n,this.buffer.length),this.buffer=i;let a=[];for(;null!=(t=function(e,t){for(let n=t??0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0}}return null}(this.buffer,o(this,r,"f")));){if(t.carriage&&null==o(this,r,"f")){s(this,r,t.index,"f");continue}if(null!=o(this,r,"f")&&(t.index!==o(this,r,"f")+1||t.carriage)){a.push(this.decodeText(this.buffer.slice(0,o(this,r,"f")-1))),this.buffer=this.buffer.slice(o(this,r,"f")),s(this,r,null,"f");continue}let e=null!==o(this,r,"f")?t.preceding-1:t.preceding,n=this.decodeText(this.buffer.slice(0,e));a.push(n),this.buffer=this.buffer.slice(t.index),s(this,r,null,"f")}return a}decodeText(e){if(null==e)return"";if("string"==typeof e)return e;if(void 0!==i){if(e instanceof i)return e.toString();if(e instanceof Uint8Array)return i.from(e).toString();throw new a.OpenAIError(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new a.OpenAIError(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new a.OpenAIError("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode("\n"):[]}}n.LineDecoder=l,r=new WeakMap,l.NEWLINE_CHARS=new Set(["\n","\r"]),l.NEWLINE_REGEXP=/\r\n|[\n\r]/g,n.findDoubleNewlineIndex=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1}},{c4d280f26b9b94f9:"8Ko5i",ca7d071fad7b4828:"5zs0s"}],eWdEN:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ReadableStreamToAsyncIterable=void 0,n.ReadableStreamToAsyncIterable=function(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}},{}],"47Mgl":[function(e,t,n){var r=e("f39d0d33368ec3b0").Buffer;Object.defineProperty(n,"__esModule",{value:!0}),n.createForm=n.multipartFormRequestOptions=n.maybeMultipartFormRequestOptions=n.isMultipartBody=n.toFile=n.isUploadable=n.isBlobLike=n.isFileLike=n.isResponseLike=n.fileFromPath=void 0;let i=e("5a162306b83f4fa5");var s=e("5a162306b83f4fa5");async function o(e,t,r){var s;if(e=await e,(0,n.isFileLike)(e))return e;if((0,n.isResponseLike)(e)){let s=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");let o=(0,n.isBlobLike)(s)?[await s.arrayBuffer()]:[s];return new i.File(o,t,r)}let o=await a(e);if(t||(t=(l((s=e).name)||l(s.filename)||l(s.path)?.split(/[\\/]/).pop())??"unknown_file"),!r?.type){let e=o[0]?.type;"string"==typeof e&&(r={...r,type:e})}return new i.File(o,t,r)}async function a(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if((0,n.isBlobLike)(e))t.push(await e.arrayBuffer());else if(u(e))for await(let n of e)t.push(n);else throw Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${function(e){let t=Object.getOwnPropertyNames(e);return`[${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`);return t}Object.defineProperty(n,"fileFromPath",{enumerable:!0,get:function(){return s.fileFromPath}}),n.isResponseLike=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,n.isFileLike=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&(0,n.isBlobLike)(e),n.isBlobLike=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,n.isUploadable=e=>(0,n.isFileLike)(e)||(0,n.isResponseLike)(e)||(0,i.isFsReadStream)(e),n.toFile=o;let l=e=>"string"==typeof e?e:void 0!==r&&e instanceof r?String(e):void 0,u=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator];n.isMultipartBody=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag];let c=async e=>{if(!f(e.body))return e;let t=await (0,n.createForm)(e.body);return(0,i.getMultipartRequestOptions)(t,e)};n.maybeMultipartFormRequestOptions=c;let d=async e=>{let t=await (0,n.createForm)(e.body);return(0,i.getMultipartRequestOptions)(t,e)};n.multipartFormRequestOptions=d;let p=async e=>{let t=new i.FormData;return await Promise.all(Object.entries(e||{}).map(([e,n])=>h(t,e,n))),t};n.createForm=p;let f=e=>{if((0,n.isUploadable)(e))return!0;if(Array.isArray(e))return e.some(f);if(e&&"object"==typeof e){for(let t in e)if(f(e[t]))return!0}return!1},h=async(e,t,r)=>{if(void 0!==r){if(null==r)throw TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)e.append(t,String(r));else if((0,n.isUploadable)(r)){let n=await o(r);e.append(t,n)}else if(Array.isArray(r))await Promise.all(r.map(n=>h(e,t+"[]",n)));else if("object"==typeof r)await Promise.all(Object.entries(r).map(([n,r])=>h(e,`${t}[${n}]`,r)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}}},{f39d0d33368ec3b0:"8Ko5i","5a162306b83f4fa5":"l6z6v"}],"5CJzy":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CursorPage=n.Page=void 0;let r=e("773abb8b02b676ca");class i extends r.AbstractPage{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}n.Page=i;class s extends r.AbstractPage{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageParams(){let e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;let t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){let e=this.getPaginatedItems();if(!e.length)return null;let t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}n.CursorPage=s},{"773abb8b02b676ca":"hBXqu"}],iJB9C:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.VectorStores=n.VectorStoreSearchResponsesPage=n.VectorStoresPage=n.Uploads=n.Responses=n.Moderations=n.Models=n.ModelsPage=n.Images=n.FineTuning=n.Files=n.FileObjectsPage=n.Evals=n.EvalListResponsesPage=n.Embeddings=n.Completions=n.Beta=n.Batches=n.BatchesPage=n.Audio=void 0,i(e("ed27c0931fe7cfb0"),n),i(e("ee54f7b4bb193074"),n);var s=e("9a2506e8ad8b6a73");Object.defineProperty(n,"Audio",{enumerable:!0,get:function(){return s.Audio}});var o=e("fb5c3d899e5b0811");Object.defineProperty(n,"BatchesPage",{enumerable:!0,get:function(){return o.BatchesPage}}),Object.defineProperty(n,"Batches",{enumerable:!0,get:function(){return o.Batches}});var a=e("4d352051410c4996");Object.defineProperty(n,"Beta",{enumerable:!0,get:function(){return a.Beta}});var l=e("eaf4750f18094ed2");Object.defineProperty(n,"Completions",{enumerable:!0,get:function(){return l.Completions}});var u=e("8dc76525e319ad48");Object.defineProperty(n,"Embeddings",{enumerable:!0,get:function(){return u.Embeddings}});var c=e("b1aba6248dc437d3");Object.defineProperty(n,"EvalListResponsesPage",{enumerable:!0,get:function(){return c.EvalListResponsesPage}}),Object.defineProperty(n,"Evals",{enumerable:!0,get:function(){return c.Evals}});var d=e("6d3f6b3f135c789e");Object.defineProperty(n,"FileObjectsPage",{enumerable:!0,get:function(){return d.FileObjectsPage}}),Object.defineProperty(n,"Files",{enumerable:!0,get:function(){return d.Files}});var p=e("96a2e52dac84bf0e");Object.defineProperty(n,"FineTuning",{enumerable:!0,get:function(){return p.FineTuning}});var f=e("e833d71095dd2132");Object.defineProperty(n,"Images",{enumerable:!0,get:function(){return f.Images}});var h=e("d3497cf5ae4c42d0");Object.defineProperty(n,"ModelsPage",{enumerable:!0,get:function(){return h.ModelsPage}}),Object.defineProperty(n,"Models",{enumerable:!0,get:function(){return h.Models}});var m=e("42835eed026545c");Object.defineProperty(n,"Moderations",{enumerable:!0,get:function(){return m.Moderations}});var g=e("18c2c0dc7d580993");Object.defineProperty(n,"Responses",{enumerable:!0,get:function(){return g.Responses}});var y=e("1ff54bf18def054c");Object.defineProperty(n,"Uploads",{enumerable:!0,get:function(){return y.Uploads}});var b=e("7e4c8d8fa5563053");Object.defineProperty(n,"VectorStoresPage",{enumerable:!0,get:function(){return b.VectorStoresPage}}),Object.defineProperty(n,"VectorStoreSearchResponsesPage",{enumerable:!0,get:function(){return b.VectorStoreSearchResponsesPage}}),Object.defineProperty(n,"VectorStores",{enumerable:!0,get:function(){return b.VectorStores}})},{ed27c0931fe7cfb0:"df4oU",ee54f7b4bb193074:"cwVcl","9a2506e8ad8b6a73":"ln1Hf",fb5c3d899e5b0811:"byUys","4d352051410c4996":"goVQu",eaf4750f18094ed2:"dOXi5","8dc76525e319ad48":"jXUza",b1aba6248dc437d3:"7VzGj","6d3f6b3f135c789e":"6OMS5","96a2e52dac84bf0e":"7Gf3p",e833d71095dd2132:"eLdl3",d3497cf5ae4c42d0:"kzZF2","42835eed026545c":"2AvxK","18c2c0dc7d580993":"aDmtC","1ff54bf18def054c":"HmTFH","7e4c8d8fa5563053":"9P780"}],df4oU:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Completions=n.ChatCompletionsPage=n.ChatCompletionStoreMessagesPage=n.Chat=void 0;var r=e("8cccd928e0f3768e");Object.defineProperty(n,"Chat",{enumerable:!0,get:function(){return r.Chat}});var i=e("be205a9dd87e9aa4");Object.defineProperty(n,"ChatCompletionStoreMessagesPage",{enumerable:!0,get:function(){return i.ChatCompletionStoreMessagesPage}}),Object.defineProperty(n,"ChatCompletionsPage",{enumerable:!0,get:function(){return i.ChatCompletionsPage}}),Object.defineProperty(n,"Completions",{enumerable:!0,get:function(){return i.Completions}})},{"8cccd928e0f3768e":"XPoTI",be205a9dd87e9aa4:"1Fs2R"}],XPoTI:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Chat=void 0;let o=e("3685e893d2e498b6"),a=s(e("8a167ea9e87d2839")),l=e("8a167ea9e87d2839");class u extends o.APIResource{constructor(){super(...arguments),this.completions=new a.Completions(this._client)}}n.Chat=u,u.Completions=l.Completions,u.ChatCompletionsPage=l.ChatCompletionsPage},{"3685e893d2e498b6":"j8nMp","8a167ea9e87d2839":"a7Yun"}],j8nMp:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.APIResource=void 0,n.APIResource=class{constructor(e){this._client=e}}},{}],a7Yun:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.ChatCompletionStoreMessagesPage=n.ChatCompletionsPage=n.Completions=void 0;let o=e("16aaabb33949d15b"),a=e("54ead60258eb3f03"),l=s(e("7703082183f4ac8d")),u=e("7703082183f4ac8d"),c=e("a86eff4094c1ebbc");class d extends o.APIResource{constructor(){super(...arguments),this.messages=new l.Messages(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return(0,a.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/chat/completions",p,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}}n.Completions=d;class p extends c.CursorPage{}n.ChatCompletionsPage=p;class f extends c.CursorPage{}n.ChatCompletionStoreMessagesPage=f,d.ChatCompletionsPage=p,d.Messages=u.Messages},{"16aaabb33949d15b":"j8nMp","54ead60258eb3f03":"hBXqu","7703082183f4ac8d":"2jPfr",a86eff4094c1ebbc:"5CJzy"}],"2jPfr":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ChatCompletionStoreMessagesPage=n.Messages=void 0;let r=e("bbaa79115c30fea8"),i=e("cd2b9e0e3a3c987a"),s=e("14fa5c2e11d5ddc");Object.defineProperty(n,"ChatCompletionStoreMessagesPage",{enumerable:!0,get:function(){return s.ChatCompletionStoreMessagesPage}});class o extends r.APIResource{list(e,t={},n){return(0,i.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,s.ChatCompletionStoreMessagesPage,{query:t,...n})}}n.Messages=o},{bbaa79115c30fea8:"j8nMp",cd2b9e0e3a3c987a:"hBXqu","14fa5c2e11d5ddc":"a7Yun"}],"1Fs2R":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Messages=n.Completions=n.ChatCompletionsPage=n.ChatCompletionStoreMessagesPage=void 0;var r=e("b5a85e75b84e934b");Object.defineProperty(n,"ChatCompletionStoreMessagesPage",{enumerable:!0,get:function(){return r.ChatCompletionStoreMessagesPage}}),Object.defineProperty(n,"ChatCompletionsPage",{enumerable:!0,get:function(){return r.ChatCompletionsPage}}),Object.defineProperty(n,"Completions",{enumerable:!0,get:function(){return r.Completions}});var i=e("cbb77a3c2849d738");Object.defineProperty(n,"Messages",{enumerable:!0,get:function(){return i.Messages}})},{b5a85e75b84e934b:"a7Yun",cbb77a3c2849d738:"2jPfr"}],cwVcl:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})},{}],ln1Hf:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Audio=void 0;let o=e("cff3ec434b36f53a"),a=s(e("1bd077c1dd8f260e")),l=e("1bd077c1dd8f260e"),u=s(e("b0c69ac17bf7d83e")),c=e("b0c69ac17bf7d83e"),d=s(e("389d5132008cd034")),p=e("389d5132008cd034");class Audio extends o.APIResource{constructor(){super(...arguments),this.transcriptions=new u.Transcriptions(this._client),this.translations=new d.Translations(this._client),this.speech=new a.Speech(this._client)}}n.Audio=Audio,Audio.Transcriptions=c.Transcriptions,Audio.Translations=p.Translations,Audio.Speech=l.Speech},{cff3ec434b36f53a:"j8nMp","1bd077c1dd8f260e":"grTl8",b0c69ac17bf7d83e:"8yUxC","389d5132008cd034":"10Ik4"}],grTl8:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Speech=void 0;let r=e("cf0356b250317cf4");class i extends r.APIResource{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t?.headers},__binaryResponse:!0})}}n.Speech=i},{cf0356b250317cf4:"j8nMp"}],"8yUxC":[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Transcriptions=void 0;let o=e("9ecb74975bc6c753"),a=s(e("d949a9fc6ef6e69e"));class l extends o.APIResource{create(e,t){return this._client.post("/audio/transcriptions",a.multipartFormRequestOptions({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}n.Transcriptions=l},{"9ecb74975bc6c753":"j8nMp",d949a9fc6ef6e69e:"hBXqu"}],"10Ik4":[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Translations=void 0;let o=e("72feca493b9b1fc4"),a=s(e("5dcb90e4183e0381"));class l extends o.APIResource{create(e,t){return this._client.post("/audio/translations",a.multipartFormRequestOptions({body:e,...t,__metadata:{model:e.model}}))}}n.Translations=l},{"72feca493b9b1fc4":"j8nMp","5dcb90e4183e0381":"hBXqu"}],byUys:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BatchesPage=n.Batches=void 0;let r=e("d07ebf99bb871c78"),i=e("cb26de50d1b035cb"),s=e("c6f42d4aafc0f2a7");class o extends r.APIResource{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return(0,i.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/batches",a,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}n.Batches=o;class a extends s.CursorPage{}n.BatchesPage=a,o.BatchesPage=a},{d07ebf99bb871c78:"j8nMp",cb26de50d1b035cb:"hBXqu",c6f42d4aafc0f2a7:"5CJzy"}],goVQu:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Beta=void 0;let o=e("c464c02acfe9740f"),a=s(e("de5134439fa86f03")),l=s(e("b72410f8dc3c3c92")),u=e("de5134439fa86f03"),c=s(e("12c6bb057f8957f3")),d=e("12c6bb057f8957f3"),p=s(e("cb59bdcf79f59dd1")),f=e("cb59bdcf79f59dd1");e("b72410f8dc3c3c92");class h extends o.APIResource{constructor(){super(...arguments),this.realtime=new c.Realtime(this._client),this.chat=new l.Chat(this._client),this.assistants=new a.Assistants(this._client),this.threads=new p.Threads(this._client)}}n.Beta=h,h.Realtime=d.Realtime,h.Assistants=u.Assistants,h.AssistantsPage=u.AssistantsPage,h.Threads=f.Threads},{c464c02acfe9740f:"j8nMp",de5134439fa86f03:"jq76v",b72410f8dc3c3c92:"ccdwV","12c6bb057f8957f3":"SHRCT",cb59bdcf79f59dd1:"ghiNp"}],jq76v:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AssistantsPage=n.Assistants=void 0;let r=e("8f990373b0518821"),i=e("2bfe492427fbb658"),s=e("513977b06653fdda");e("9b6e4f4178bb697d");class o extends r.APIResource{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return(0,i.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/assistants",a,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}n.Assistants=o;class a extends s.CursorPage{}n.AssistantsPage=a,o.AssistantsPage=a},{"8f990373b0518821":"j8nMp","2bfe492427fbb658":"hBXqu","513977b06653fdda":"5CJzy","9b6e4f4178bb697d":"fSdsu"}],fSdsu:[function(e,t,n){var r,i,s,o,a,l,u,c,d,p,f,h,m,g,y,b,v,_,A,C,I,w,O=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),T=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),E=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&O(t,e,n);return T(t,e),t},S=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},x=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.AssistantStream=void 0;let P=E(e("b8490a1c5357de32")),R=e("7b4da3e6442371e7"),k=e("29709b74d3d1eac2"),M=e("a89ad25273042b15");class j extends M.EventStream{constructor(){super(...arguments),r.add(this),i.set(this,[]),s.set(this,{}),o.set(this,{}),a.set(this,void 0),l.set(this,void 0),u.set(this,void 0),c.set(this,void 0),d.set(this,void 0),p.set(this,void 0),f.set(this,void 0),h.set(this,void 0),m.set(this,void 0)}[(i=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,u=new WeakMap,c=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,h=new WeakMap,m=new WeakMap,r=new WeakSet,Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("event",n=>{let r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{for(let e of(n=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise((e,n)=>t.push({resolve:e,reject:n})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0});let r=e.shift();return{value:r,done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){let t=new j;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){let n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();let i=R.Stream.fromReadableStream(e,this.controller);for await(let e of i)S(this,r,"m",g).call(this,e);if(i.controller.signal?.aborted)throw new k.APIUserAbortError;return this._addRun(S(this,r,"m",y).call(this))}toReadableStream(){let e=new R.Stream(this[Symbol.asyncIterator].bind(this),this.controller);return e.toReadableStream()}static createToolAssistantStream(e,t,n,r,i){let s=new j;return s._run(()=>s._runToolAssistantStream(e,t,n,r,{...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createToolAssistantStream(e,t,n,i,s){let o=s?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));let a={...i,stream:!0},l=await e.submitToolOutputs(t,n,a,{...s,signal:this.controller.signal});for await(let e of(this._connected(),l))S(this,r,"m",g).call(this,e);if(l.controller.signal?.aborted)throw new k.APIUserAbortError;return this._addRun(S(this,r,"m",y).call(this))}static createThreadAssistantStream(e,t,n){let r=new j;return r._run(()=>r._threadAssistantStream(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}static createAssistantStream(e,t,n,r){let i=new j;return i._run(()=>i._runAssistantStream(e,t,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return S(this,f,"f")}currentRun(){return S(this,h,"f")}currentMessageSnapshot(){return S(this,a,"f")}currentRunStepSnapshot(){return S(this,m,"f")}async finalRunSteps(){return await this.done(),Object.values(S(this,s,"f"))}async finalMessages(){return await this.done(),Object.values(S(this,o,"f"))}async finalRun(){if(await this.done(),!S(this,l,"f"))throw Error("Final run was not received.");return S(this,l,"f")}async _createThreadAssistantStream(e,t,n){let i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));let s={...t,stream:!0},o=await e.createAndRun(s,{...n,signal:this.controller.signal});for await(let e of(this._connected(),o))S(this,r,"m",g).call(this,e);if(o.controller.signal?.aborted)throw new k.APIUserAbortError;return this._addRun(S(this,r,"m",y).call(this))}async _createAssistantStream(e,t,n,i){let s=i?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let o={...n,stream:!0},a=await e.create(t,o,{...i,signal:this.controller.signal});for await(let e of(this._connected(),a))S(this,r,"m",g).call(this,e);if(a.controller.signal?.aborted)throw new k.APIUserAbortError;return this._addRun(S(this,r,"m",y).call(this))}static accumulateDelta(e,t){for(let[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let t=e[n];if(null==t||"index"===n||"type"===n){e[n]=r;continue}if("string"==typeof t&&"string"==typeof r)t+=r;else if("number"==typeof t&&"number"==typeof r)t+=r;else if(P.isObj(t)&&P.isObj(r))t=this.accumulateDelta(t,r);else if(Array.isArray(t)&&Array.isArray(r)){if(t.every(e=>"string"==typeof e||"number"==typeof e)){t.push(...r);continue}for(let e of r){if(!P.isObj(e))throw Error(`Expected array delta entry to be an object but got: ${e}`);let n=e.index;if(null==n)throw console.error(e),Error("Expected array delta entry to have an `index` property");if("number"!=typeof n)throw Error(`Expected array delta entry \`index\` property to be a number but got ${n}`);let r=t[n];null==r?t.push(e):t[n]=this.accumulateDelta(r,e)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${t}`);e[n]=t}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,r){return await this._createAssistantStream(t,e,n,r)}async _runToolAssistantStream(e,t,n,r,i){return await this._createToolAssistantStream(n,e,t,r,i)}}n.AssistantStream=j,g=function(e){if(!this.ended)switch(x(this,f,e,"f"),S(this,r,"m",_).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":S(this,r,"m",w).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":S(this,r,"m",v).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":S(this,r,"m",b).call(this,e);break;case"error":throw Error("Encountered an error event in event processing - errors should be processed earlier")}},y=function(){if(this.ended)throw new k.OpenAIError("stream has ended, this shouldn't happen");if(!S(this,l,"f"))throw Error("Final run has not been received");return S(this,l,"f")},b=function(e){let[t,n]=S(this,r,"m",C).call(this,e,S(this,a,"f"));for(let e of(x(this,a,t,"f"),S(this,o,"f")[t.id]=t,n)){let n=t.content[e.index];n?.type=="text"&&this._emit("textCreated",n.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(let n of e.data.delta.content){if("text"==n.type&&n.text){let e=n.text,r=t.content[n.index];if(r&&"text"==r.type)this._emit("textDelta",e,r.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(n.index!=S(this,u,"f")){if(S(this,c,"f"))switch(S(this,c,"f").type){case"text":this._emit("textDone",S(this,c,"f").text,S(this,a,"f"));break;case"image_file":this._emit("imageFileDone",S(this,c,"f").image_file,S(this,a,"f"))}x(this,u,n.index,"f")}x(this,c,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==S(this,u,"f")){let t=e.data.content[S(this,u,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,S(this,a,"f"));break;case"text":this._emit("textDone",t.text,S(this,a,"f"))}}S(this,a,"f")&&this._emit("messageDone",e.data),x(this,a,void 0,"f")}},v=function(e){let t=S(this,r,"m",A).call(this,e);switch(x(this,m,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let n=e.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(let e of n.step_details.tool_calls)e.index==S(this,d,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(S(this,p,"f")&&this._emit("toolCallDone",S(this,p,"f")),x(this,d,e.index,"f"),x(this,p,t.step_details.tool_calls[e.index],"f"),S(this,p,"f")&&this._emit("toolCallCreated",S(this,p,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":x(this,m,void 0,"f");let i=e.data.step_details;"tool_calls"==i.type&&S(this,p,"f")&&(this._emit("toolCallDone",S(this,p,"f")),x(this,p,void 0,"f")),this._emit("runStepDone",e.data,t)}},_=function(e){S(this,i,"f").push(e),this._emit("event",e)},A=function(e){switch(e.event){case"thread.run.step.created":return S(this,s,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=S(this,s,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){let r=j.accumulateDelta(t,n.delta);S(this,s,"f")[e.data.id]=r}return S(this,s,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":S(this,s,"f")[e.data.id]=e.data}if(S(this,s,"f")[e.data.id])return S(this,s,"f")[e.data.id];throw Error("No snapshot available")},C=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let i=e.data;if(i.delta.content)for(let e of i.delta.content)if(e.index in t.content){let n=t.content[e.index];t.content[e.index]=S(this,r,"m",I).call(this,e,n)}else t.content[e.index]=e,n.push(e);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},I=function(e,t){return j.accumulateDelta(t,e)},w=function(e){switch(x(this,h,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":x(this,l,e.data,"f"),S(this,p,"f")&&(this._emit("toolCallDone",S(this,p,"f")),x(this,p,void 0,"f"))}}},{b8490a1c5357de32:"hBXqu","7b4da3e6442371e7":"jisQ5","29709b74d3d1eac2":"5zs0s",a89ad25273042b15:"6Htkn"}],"6Htkn":[function(e,t,n){var r,i,s,o,a,l,u,c,d,p,f,h,m,g=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},y=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.EventStream=void 0;let b=e("fcc789d5d79d6aa");n.EventStream=class{constructor(){r.add(this),this.controller=new AbortController,i.set(this,void 0),s.set(this,()=>{}),o.set(this,()=>{}),a.set(this,void 0),l.set(this,()=>{}),u.set(this,()=>{}),c.set(this,{}),d.set(this,!1),p.set(this,!1),f.set(this,!1),h.set(this,!1),g(this,i,new Promise((e,t)=>{g(this,s,e,"f"),g(this,o,t,"f")}),"f"),g(this,a,new Promise((e,t)=>{g(this,l,e,"f"),g(this,u,t,"f")}),"f"),y(this,i,"f").catch(()=>{}),y(this,a,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},y(this,r,"m",m).bind(this))},0)}_connected(){this.ended||(y(this,s,"f").call(this),this._emit("connect"))}get ended(){return y(this,d,"f")}get errored(){return y(this,p,"f")}get aborted(){return y(this,f,"f")}abort(){this.controller.abort()}on(e,t){let n=y(this,c,"f")[e]||(y(this,c,"f")[e]=[]);return n.push({listener:t}),this}off(e,t){let n=y(this,c,"f")[e];if(!n)return this;let r=n.findIndex(e=>e.listener===t);return r>=0&&n.splice(r,1),this}once(e,t){let n=y(this,c,"f")[e]||(y(this,c,"f")[e]=[]);return n.push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{g(this,h,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)})}async done(){g(this,h,!0,"f"),await y(this,a,"f")}_emit(e,...t){if(y(this,d,"f"))return;"end"===e&&(g(this,d,!0,"f"),y(this,l,"f").call(this));let n=y(this,c,"f")[e];if(n&&(y(this,c,"f")[e]=n.filter(e=>!e.once),n.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];y(this,h,"f")||n?.length||Promise.reject(e),y(this,o,"f").call(this,e),y(this,u,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];y(this,h,"f")||n?.length||Promise.reject(e),y(this,o,"f").call(this,e),y(this,u,"f").call(this,e),this._emit("end")}}_emitFinal(){}},i=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,u=new WeakMap,c=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,h=new WeakMap,r=new WeakSet,m=function(e){if(g(this,p,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new b.APIUserAbortError),e instanceof b.APIUserAbortError)return g(this,f,!0,"f"),this._emit("abort",e);if(e instanceof b.OpenAIError)return this._emit("error",e);if(e instanceof Error){let t=new b.OpenAIError(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new b.OpenAIError(String(e)))}},{fcc789d5d79d6aa:"5zs0s"}],ccdwV:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Chat=void 0;let o=e("470d066d22765f7"),a=s(e("a393cda46ba51ace"));class l extends o.APIResource{constructor(){super(...arguments),this.completions=new a.Completions(this._client)}}n.Chat=l,(l=n.Chat||(n.Chat={})).Completions=a.Completions},{"470d066d22765f7":"j8nMp",a393cda46ba51ace:"jAQ9W"}],jAQ9W:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Completions=n.ChatCompletionRunner=n.ChatCompletionStream=n.ParsingToolFunction=n.ParsingFunction=n.ChatCompletionStreamingRunner=void 0;let r=e("2112e864bfcf4d7c"),i=e("56329bba6b60e148"),s=e("24671a36b7d6e383"),o=e("3ff6965e0e5a2b92"),a=e("d0bce83a597e06f3");var l=e("24671a36b7d6e383");Object.defineProperty(n,"ChatCompletionStreamingRunner",{enumerable:!0,get:function(){return l.ChatCompletionStreamingRunner}});var u=e("d6c63007e89ea1e6");Object.defineProperty(n,"ParsingFunction",{enumerable:!0,get:function(){return u.ParsingFunction}}),Object.defineProperty(n,"ParsingToolFunction",{enumerable:!0,get:function(){return u.ParsingToolFunction}});var c=e("3ff6965e0e5a2b92");Object.defineProperty(n,"ChatCompletionStream",{enumerable:!0,get:function(){return c.ChatCompletionStream}});var d=e("56329bba6b60e148");Object.defineProperty(n,"ChatCompletionRunner",{enumerable:!0,get:function(){return d.ChatCompletionRunner}});class p extends r.APIResource{parse(e,t){return(0,a.validateInputTools)(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(t=>(0,a.parseChatCompletion)(t,e))}runFunctions(e,t){return e.stream?s.ChatCompletionStreamingRunner.runFunctions(this._client,e,t):i.ChatCompletionRunner.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?s.ChatCompletionStreamingRunner.runTools(this._client,e,t):i.ChatCompletionRunner.runTools(this._client,e,t)}stream(e,t){return o.ChatCompletionStream.createChatCompletion(this._client,e,t)}}n.Completions=p},{"2112e864bfcf4d7c":"j8nMp","56329bba6b60e148":"61Z5E","24671a36b7d6e383":"j1EB5","3ff6965e0e5a2b92":"b4rKe",d0bce83a597e06f3:"gP5Iq",d6c63007e89ea1e6:"6IQII"}],"61Z5E":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ChatCompletionRunner=void 0;let r=e("aa25e92fa59cee13"),i=e("f6c55a82914fa1ca");class s extends r.AbstractChatCompletionRunner{static runFunctions(e,t,n){let r=new s,i={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,t,i)),r}static runTools(e,t,n){let r=new s,i={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,i)),r}_addMessage(e,t=!0){super._addMessage(e,t),(0,i.isAssistantMessage)(e)&&e.content&&this._emit("content",e.content)}}n.ChatCompletionRunner=s},{aa25e92fa59cee13:"7GVjT",f6c55a82914fa1ca:"4ZPcb"}],"7GVjT":[function(e,t,n){var r,i,s,o,a,l,u,c,d=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.AbstractChatCompletionRunner=void 0;let p=e("4e5e0646d595aad7"),f=e("b6fc2842a36f42db"),h=e("65716cf93e68edd6"),m=e("503846a085f7f8c5"),g=e("ada52b397ff442aa");class y extends m.EventStream{constructor(){super(...arguments),r.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);let t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),((0,h.isFunctionMessage)(e)||(0,h.isToolMessage)(e))&&e.content)this._emit("functionCallResult",e.content);else if((0,h.isAssistantMessage)(e)&&e.function_call)this._emit("functionCall",e.function_call);else if((0,h.isAssistantMessage)(e)&&e.tool_calls)for(let t of e.tool_calls)"function"===t.type&&this._emit("functionCall",t.function)}}async finalChatCompletion(){await this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new p.OpenAIError("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),d(this,r,"m",i).call(this)}async finalMessage(){return await this.done(),d(this,r,"m",s).call(this)}async finalFunctionCall(){return await this.done(),d(this,r,"m",o).call(this)}async finalFunctionCallResult(){return await this.done(),d(this,r,"m",a).call(this)}async totalUsage(){return await this.done(),d(this,r,"m",l).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let t=d(this,r,"m",s).call(this);t&&this._emit("finalMessage",t);let n=d(this,r,"m",i).call(this);n&&this._emit("finalContent",n);let u=d(this,r,"m",o).call(this);u&&this._emit("finalFunctionCall",u);let c=d(this,r,"m",a).call(this);null!=c&&this._emit("finalFunctionCallResult",c),this._chatCompletions.some(e=>e.usage)&&this._emit("totalUsage",d(this,r,"m",l).call(this))}async _createChatCompletion(e,t,n){let i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),d(this,r,"m",u).call(this,t);let s=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion((0,g.parseChatCompletion)(s,t))}async _runChatCompletion(e,t,n){for(let e of t.messages)this._addMessage(e,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){let i="function",{function_call:s="auto",stream:o,...a}=t,l="string"!=typeof s&&s?.name,{maxChatCompletions:u=10}=n||{},h={};for(let e of t.functions)h[e.name||e.function.name]=e;let m=t.functions.map(e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description}));for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<u;++t){let t;let o=await this._createChatCompletion(e,{...a,function_call:s,functions:m,messages:[...this.messages]},n),u=o.choices[0]?.message;if(!u)throw new p.OpenAIError("missing message in ChatCompletion response");if(!u.function_call)return;let{name:g,arguments:y}=u.function_call,b=h[g];if(b){if(l&&l!==g){let e=`Invalid function_call: ${JSON.stringify(g)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:i,name:g,content:e});continue}}else{let e=`Invalid function_call: ${JSON.stringify(g)}. Available options are: ${m.map(e=>JSON.stringify(e.name)).join(", ")}. Please try again`;this._addMessage({role:i,name:g,content:e});continue}try{t=(0,f.isRunnableFunctionWithParse)(b)?await b.parse(y):y}catch(e){this._addMessage({role:i,name:g,content:e instanceof Error?e.message:String(e)});continue}let v=await b.function(t,this),_=d(this,r,"m",c).call(this,v);if(this._addMessage({role:i,name:g,content:_}),l)return}}async _runTools(e,t,n){let i="tool",{tool_choice:s="auto",stream:o,...a}=t,l="string"!=typeof s&&s?.function?.name,{maxChatCompletions:u=10}=n||{},h=t.tools.map(e=>{if((0,g.isAutoParsableTool)(e)){if(!e.$callback)throw new p.OpenAIError("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e}),m={};for(let e of h)"function"===e.type&&(m[e.function.name||e.function.function.name]=e.function);let y="tools"in t?h.map(e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e):void 0;for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<u;++t){let t=await this._createChatCompletion(e,{...a,tool_choice:s,tools:y,messages:[...this.messages]},n),o=t.choices[0]?.message;if(!o)throw new p.OpenAIError("missing message in ChatCompletion response");if(!o.tool_calls?.length)break;for(let e of o.tool_calls){let t;if("function"!==e.type)continue;let n=e.id,{name:s,arguments:o}=e.function,a=m[s];if(a){if(l&&l!==s){let e=`Invalid tool_call: ${JSON.stringify(s)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:i,tool_call_id:n,content:e});continue}}else{let e=`Invalid tool_call: ${JSON.stringify(s)}. Available options are: ${Object.keys(m).map(e=>JSON.stringify(e)).join(", ")}. Please try again`;this._addMessage({role:i,tool_call_id:n,content:e});continue}try{t=(0,f.isRunnableFunctionWithParse)(a)?await a.parse(o):o}catch(t){let e=t instanceof Error?t.message:String(t);this._addMessage({role:i,tool_call_id:n,content:e});continue}let u=await a.function(t,this),p=d(this,r,"m",c).call(this,u);if(this._addMessage({role:i,tool_call_id:n,content:p}),l)return}}}}n.AbstractChatCompletionRunner=y,r=new WeakSet,i=function(){return d(this,r,"m",s).call(this).content??null},s=function(){let e=this.messages.length;for(;e-- >0;){let t=this.messages[e];if((0,h.isAssistantMessage)(t)){let{function_call:e,...n}=t,r={...n,content:t.content??null,refusal:t.refusal??null};return e&&(r.function_call=e),r}}throw new p.OpenAIError("stream ended without producing a ChatCompletionMessage with role=assistant")},o=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if((0,h.isAssistantMessage)(t)&&t?.function_call)return t.function_call;if((0,h.isAssistantMessage)(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},a=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if((0,h.isFunctionMessage)(t)&&null!=t.content||(0,h.isToolMessage)(t)&&null!=t.content&&"string"==typeof t.content&&this.messages.some(e=>"assistant"===e.role&&e.tool_calls?.some(e=>"function"===e.type&&e.id===t.tool_call_id)))return t.content}},l=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},u=function(e){if(null!=e.n&&e.n>1)throw new p.OpenAIError("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},c=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)}},{"4e5e0646d595aad7":"5zs0s",b6fc2842a36f42db:"6IQII","65716cf93e68edd6":"4ZPcb","503846a085f7f8c5":"6Htkn",ada52b397ff442aa:"gP5Iq"}],"6IQII":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ParsingToolFunction=n.ParsingFunction=n.isRunnableFunctionWithParse=void 0,n.isRunnableFunctionWithParse=function(e){return"function"==typeof e.parse},n.ParsingFunction=class{constructor(e){this.function=e.function,this.parse=e.parse,this.parameters=e.parameters,this.description=e.description,this.name=e.name}},n.ParsingToolFunction=class{constructor(e){this.type="function",this.function=e}}},{}],"4ZPcb":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isPresent=n.isToolMessage=n.isFunctionMessage=n.isAssistantMessage=void 0,n.isAssistantMessage=e=>e?.role==="assistant",n.isFunctionMessage=e=>e?.role==="function",n.isToolMessage=e=>e?.role==="tool",n.isPresent=function(e){return null!=e}},{}],gP5Iq:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateInputTools=n.hasAutoParseableInput=n.shouldParseToolCall=n.parseChatCompletion=n.maybeParseChatCompletion=n.isAutoParsableTool=n.makeParseableTool=n.isAutoParsableResponseFormat=n.makeParseableTextFormat=n.makeParseableResponseFormat=void 0;let r=e("61893e2a8f546f85");function i(e){return e?.$brand==="auto-parseable-response-format"}function s(e){return e?.$brand==="auto-parseable-tool"}function o(e,t){let n=e.choices.map(e=>{if("length"===e.finish_reason)throw new r.LengthFinishReasonError;if("content_filter"===e.finish_reason)throw new r.ContentFilterFinishReasonError;return{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:e.message.tool_calls?.map(e=>(function(e,t){let n=e.tools?.find(e=>e.function?.name===t.function.name);return{...t,function:{...t.function,parsed_arguments:s(n)?n.$parseRaw(t.function.arguments):n?.function.strict?JSON.parse(t.function.arguments):null}}})(t,e))??void 0}:void 0,parsed:e.message.content&&!e.message.refusal?function(e,t){if(e.response_format?.type!=="json_schema")return null;if(e.response_format?.type==="json_schema"){if("$parseRaw"in e.response_format){let n=e.response_format;return n.$parseRaw(t)}return JSON.parse(t)}return null}(t,e.message.content):null}}});return{...e,choices:n}}function a(e){return!!i(e.response_format)||(e.tools?.some(e=>s(e)||"function"===e.type&&!0===e.function.strict)??!1)}n.makeParseableResponseFormat=function(e,t){let n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n},n.makeParseableTextFormat=function(e,t){let n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n},n.isAutoParsableResponseFormat=i,n.makeParseableTool=function(e,{parser:t,callback:n}){let r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r},n.isAutoParsableTool=s,n.maybeParseChatCompletion=function(e,t){return t&&a(t)?o(e,t):{...e,choices:e.choices.map(e=>({...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}}))}},n.parseChatCompletion=o,n.shouldParseToolCall=function(e,t){if(!e)return!1;let n=e.tools?.find(e=>e.function?.name===t.function.name);return s(n)||n?.function.strict||!1},n.hasAutoParseableInput=a,n.validateInputTools=function(e){for(let t of e??[]){if("function"!==t.type)throw new r.OpenAIError(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new r.OpenAIError(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}},{"61893e2a8f546f85":"5zs0s"}],j1EB5:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ChatCompletionStreamingRunner=void 0;let r=e("97d1a9851d3f5593");class i extends r.ChatCompletionStream{static fromReadableStream(e){let t=new i(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,n){let r=new i(null),s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,t,s)),r}static runTools(e,t,n){let r=new i(t),s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,s)),r}}n.ChatCompletionStreamingRunner=i},{"97d1a9851d3f5593":"b4rKe"}],b4rKe:[function(e,t,n){var r,i,s,o,a,l,u,c,d,p,f,h,m=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},g=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ChatCompletionStream=void 0;let y=e("be8447ce4694417"),b=e("d0bd0aef96c2d67a"),v=e("d60838b788ee67e5"),_=e("c605820d3c862725"),A=e("92f2d12022a2d835");class C extends b.AbstractChatCompletionRunner{constructor(e){super(),r.add(this),i.set(this,void 0),s.set(this,void 0),o.set(this,void 0),m(this,i,e,"f"),m(this,s,[],"f")}get currentChatCompletionSnapshot(){return g(this,o,"f")}static fromReadableStream(e){let t=new C(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){let r=new C(t);return r._run(()=>r._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createChatCompletion(e,t,n){super._createChatCompletion;let i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),g(this,r,"m",a).call(this);let s=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});for await(let e of(this._connected(),s))g(this,r,"m",u).call(this,e);if(s.controller.signal?.aborted)throw new y.APIUserAbortError;return this._addChatCompletion(g(this,r,"m",p).call(this))}async _fromReadableStream(e,t){let n;let i=t?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),g(this,r,"m",a).call(this),this._connected();let s=v.Stream.fromReadableStream(e,this.controller);for await(let e of s)n&&n!==e.id&&this._addChatCompletion(g(this,r,"m",p).call(this)),g(this,r,"m",u).call(this,e),n=e.id;if(s.controller.signal?.aborted)throw new y.APIUserAbortError;return this._addChatCompletion(g(this,r,"m",p).call(this))}[(i=new WeakMap,s=new WeakMap,o=new WeakMap,r=new WeakSet,a=function(){this.ended||m(this,o,void 0,"f")},l=function(e){let t=g(this,s,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},g(this,s,"f")[e.index]=t),t},u=function(e){if(this.ended)return;let t=g(this,r,"m",h).call(this,e);for(let n of(this._emit("chunk",e,t),e.choices)){let e=t.choices[n.index];null!=n.delta.content&&e.message?.role==="assistant"&&e.message?.content&&(this._emit("content",n.delta.content,e.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=n.delta.refusal&&e.message?.role==="assistant"&&e.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:e.message.refusal}),n.logprobs?.content!=null&&e.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:e.logprobs?.content??[]}),n.logprobs?.refusal!=null&&e.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});let i=g(this,r,"m",l).call(this,e);for(let t of(e.finish_reason&&(g(this,r,"m",d).call(this,e),null!=i.current_tool_call_index&&g(this,r,"m",c).call(this,e,i.current_tool_call_index)),n.delta.tool_calls??[]))i.current_tool_call_index!==t.index&&(g(this,r,"m",d).call(this,e),null!=i.current_tool_call_index&&g(this,r,"m",c).call(this,e,i.current_tool_call_index)),i.current_tool_call_index=t.index;for(let t of n.delta.tool_calls??[]){let n=e.message.tool_calls?.[t.index];n?.type&&(n?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:n.function?.name,index:t.index,arguments:n.function.arguments,parsed_arguments:n.function.parsed_arguments,arguments_delta:t.function?.arguments??""}):n?.type)}}},c=function(e,t){let n=g(this,r,"m",l).call(this,e);if(n.done_tool_calls.has(t))return;let s=e.message.tool_calls?.[t];if(!s)throw Error("no tool call snapshot");if(!s.type)throw Error("tool call snapshot missing `type`");if("function"===s.type){let e=g(this,i,"f")?.tools?.find(e=>"function"===e.type&&e.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:t,arguments:s.function.arguments,parsed_arguments:(0,_.isAutoParsableTool)(e)?e.$parseRaw(s.function.arguments):e?.function.strict?JSON.parse(s.function.arguments):null})}else s.type},d=function(e){let t=g(this,r,"m",l).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;let n=g(this,r,"m",f).call(this);this._emit("content.done",{content:e.message.content,parsed:n?n.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},p=function(){if(this.ended)throw new y.OpenAIError("stream has ended, this shouldn't happen");let e=g(this,o,"f");if(!e)throw new y.OpenAIError("request ended without sending any chunks");return m(this,o,void 0,"f"),m(this,s,[],"f"),function(e,t){let{id:n,choices:r,created:i,model:s,system_fingerprint:o,...a}=e,l={...a,id:n,choices:r.map(({message:t,finish_reason:n,index:r,logprobs:i,...s})=>{if(!n)throw new y.OpenAIError(`missing finish_reason for choice ${r}`);let{content:o=null,function_call:a,tool_calls:l,...u}=t,c=t.role;if(!c)throw new y.OpenAIError(`missing role for choice ${r}`);if(a){let{arguments:e,name:l}=a;if(null==e)throw new y.OpenAIError(`missing function_call.arguments for choice ${r}`);if(!l)throw new y.OpenAIError(`missing function_call.name for choice ${r}`);return{...s,message:{content:o,function_call:{arguments:e,name:l},role:c,refusal:t.refusal??null},finish_reason:n,index:r,logprobs:i}}return l?{...s,index:r,finish_reason:n,logprobs:i,message:{...u,role:c,content:o,refusal:t.refusal??null,tool_calls:l.map((t,n)=>{let{function:i,type:s,id:o,...a}=t,{arguments:l,name:u,...c}=i||{};if(null==o)throw new y.OpenAIError(`missing choices[${r}].tool_calls[${n}].id
${I(e)}`);if(null==s)throw new y.OpenAIError(`missing choices[${r}].tool_calls[${n}].type
${I(e)}`);if(null==u)throw new y.OpenAIError(`missing choices[${r}].tool_calls[${n}].function.name
${I(e)}`);if(null==l)throw new y.OpenAIError(`missing choices[${r}].tool_calls[${n}].function.arguments
${I(e)}`);return{...a,id:o,type:s,function:{...c,name:u,arguments:l}}})}}:{...s,message:{...u,content:o,role:c,refusal:t.refusal??null},finish_reason:n,index:r,logprobs:i}}),created:i,model:s,object:"chat.completion",...o?{system_fingerprint:o}:{}};return(0,_.maybeParseChatCompletion)(l,t)}(e,g(this,i,"f"))},f=function(){let e=g(this,i,"f")?.response_format;return(0,_.isAutoParsableResponseFormat)(e)?e:null},h=function(e){var t,n,s,a;let l=g(this,o,"f"),{choices:u,...c}=e;for(let{delta:u,finish_reason:d,index:p,logprobs:h=null,...b}of(l?Object.assign(l,c):l=m(this,o,{...c,choices:[]},"f"),e.choices)){let e=l.choices[p];if(e||(e=l.choices[p]={finish_reason:d,index:p,message:{},logprobs:h,...b}),h){if(e.logprobs){let{content:r,refusal:i,...s}=h;Object.assign(e.logprobs,s),r&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...r)),i&&((n=e.logprobs).refusal??(n.refusal=[]),e.logprobs.refusal.push(...i))}else e.logprobs=Object.assign({},h)}if(d&&(e.finish_reason=d,g(this,i,"f")&&(0,_.hasAutoParseableInput)(g(this,i,"f")))){if("length"===d)throw new y.LengthFinishReasonError;if("content_filter"===d)throw new y.ContentFilterFinishReasonError}if(Object.assign(e,b),!u)continue;let{content:o,refusal:c,function_call:m,role:v,tool_calls:C,...I}=u;if(Object.assign(e.message,I),c&&(e.message.refusal=(e.message.refusal||"")+c),v&&(e.message.role=v),m&&(e.message.function_call?(m.name&&(e.message.function_call.name=m.name),m.arguments&&((s=e.message.function_call).arguments??(s.arguments=""),e.message.function_call.arguments+=m.arguments)):e.message.function_call=m),o&&(e.message.content=(e.message.content||"")+o,!e.message.refusal&&g(this,r,"m",f).call(this)&&(e.message.parsed=(0,A.partialParse)(e.message.content))),C)for(let{index:t,id:n,type:r,function:s,...o}of(e.message.tool_calls||(e.message.tool_calls=[]),C)){let l=(a=e.message.tool_calls)[t]??(a[t]={});Object.assign(l,o),n&&(l.id=n),r&&(l.type=r),s&&(l.function??(l.function={name:s.name??"",arguments:""})),s?.name&&(l.function.name=s.name),s?.arguments&&(l.function.arguments+=s.arguments,(0,_.shouldParseToolCall)(g(this,i,"f"),l)&&(l.function.parsed_arguments=(0,A.partialParse)(l.function.arguments)))}}return l},Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("chunk",n=>{let r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{for(let e of(n=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise((e,n)=>t.push({resolve:e,reject:n})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0});let r=e.shift();return{value:r,done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){let e=new v.Stream(this[Symbol.asyncIterator].bind(this),this.controller);return e.toReadableStream()}}function I(e){return JSON.stringify(e)}n.ChatCompletionStream=C},{be8447ce4694417:"5zs0s",d0bd0aef96c2d67a:"7GVjT",d60838b788ee67e5:"jisQ5",c605820d3c862725:"gP5Iq","92f2d12022a2d835":"e1fVo"}],e1fVo:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MalformedJSON=n.PartialJSON=n.partialParse=void 0;let r={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,ALL:511};class i extends Error{}n.PartialJSON=i;class s extends Error{}n.MalformedJSON=s;let o=(e,t)=>{let n=e.length,o=0,a=e=>{throw new i(`${e} at position ${o}`)},l=e=>{throw new s(`${e} at position ${o}`)},u=()=>(h(),o>=n&&a("Unexpected end of input"),'"'===e[o])?c():"{"===e[o]?d():"["===e[o]?p():"null"===e.substring(o,o+4)||r.NULL&t&&n-o<4&&"null".startsWith(e.substring(o))?(o+=4,null):"true"===e.substring(o,o+4)||r.BOOL&t&&n-o<4&&"true".startsWith(e.substring(o))?(o+=4,!0):"false"===e.substring(o,o+5)||r.BOOL&t&&n-o<5&&"false".startsWith(e.substring(o))?(o+=5,!1):"Infinity"===e.substring(o,o+8)||r.INFINITY&t&&n-o<8&&"Infinity".startsWith(e.substring(o))?(o+=8,1/0):"-Infinity"===e.substring(o,o+9)||r.MINUS_INFINITY&t&&1<n-o&&n-o<9&&"-Infinity".startsWith(e.substring(o))?(o+=9,-1/0):"NaN"===e.substring(o,o+3)||r.NAN&t&&n-o<3&&"NaN".startsWith(e.substring(o))?(o+=3,NaN):f(),c=()=>{let i=o,s=!1;for(o++;o<n&&('"'!==e[o]||s&&"\\"===e[o-1]);)s="\\"===e[o]&&!s,o++;if('"'==e.charAt(o))try{return JSON.parse(e.substring(i,++o-Number(s)))}catch(e){l(String(e))}else if(r.STR&t)try{return JSON.parse(e.substring(i,o-Number(s))+'"')}catch(t){return JSON.parse(e.substring(i,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},d=()=>{o++,h();let i={};try{for(;"}"!==e[o];){if(h(),o>=n&&r.OBJ&t)return i;let s=c();h(),o++;try{let e=u();Object.defineProperty(i,s,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(e){if(r.OBJ&t)return i;throw e}h(),","===e[o]&&o++}}catch(e){if(r.OBJ&t)return i;a("Expected '}' at end of object")}return o++,i},p=()=>{o++;let n=[];try{for(;"]"!==e[o];)n.push(u()),h(),","===e[o]&&o++}catch(e){if(r.ARR&t)return n;a("Expected ']' at end of array")}return o++,n},f=()=>{if(0===o){"-"===e&&r.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e)}catch(n){if(r.NUM&t)try{if("."===e[e.length-1])return JSON.parse(e.substring(0,e.lastIndexOf(".")));return JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}l(String(n))}}let i=o;for("-"===e[o]&&o++;e[o]&&!",]}".includes(e[o]);)o++;o!=n||r.NUM&t||a("Unterminated number literal");try{return JSON.parse(e.substring(i,o))}catch(n){"-"===e.substring(i,o)&&r.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e.substring(i,e.lastIndexOf("e")))}catch(e){l(String(e))}}},h=()=>{for(;o<n&&" \n\r	".includes(e[o]);)o++};return u()};n.partialParse=e=>(function(e,t=r.ALL){if("string"!=typeof e)throw TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw Error(`${e} is empty`);return o(e.trim(),t)})(e,r.ALL^r.NUM)},{}],SHRCT:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Realtime=void 0;let o=e("dfd6da1638a671e6"),a=s(e("b8790787eaefe4a3")),l=e("b8790787eaefe4a3"),u=s(e("11c67c12e93549ff")),c=e("11c67c12e93549ff");class d extends o.APIResource{constructor(){super(...arguments),this.sessions=new a.Sessions(this._client),this.transcriptionSessions=new u.TranscriptionSessions(this._client)}}n.Realtime=d,d.Sessions=l.Sessions,d.TranscriptionSessions=c.TranscriptionSessions},{dfd6da1638a671e6:"j8nMp",b8790787eaefe4a3:"liygi","11c67c12e93549ff":"lYqbK"}],liygi:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Sessions=void 0;let r=e("8045ccc2d599c9fd");class i extends r.APIResource{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}n.Sessions=i},{"8045ccc2d599c9fd":"j8nMp"}],lYqbK:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TranscriptionSessions=void 0;let r=e("5957925bbfebdeb4");class i extends r.APIResource{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}n.TranscriptionSessions=i},{"5957925bbfebdeb4":"j8nMp"}],ghiNp:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Threads=void 0;let o=e("8be2440a66cec2f5"),a=e("e0d5ab7a885d4bb9"),l=e("4ba94377c8f677ca"),u=s(e("c7f5e5d35f5ef325")),c=e("c7f5e5d35f5ef325"),d=s(e("b55571272e67934f")),p=e("b55571272e67934f");class f extends o.APIResource{constructor(){super(...arguments),this.runs=new d.Runs(this._client),this.messages=new u.Messages(this._client)}create(e={},t){return(0,a.isRequestOptions)(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){let n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return l.AssistantStream.createThreadAssistantStream(e,this._client.beta.threads,t)}}n.Threads=f,f.Runs=p.Runs,f.RunsPage=p.RunsPage,f.Messages=c.Messages,f.MessagesPage=c.MessagesPage},{"8be2440a66cec2f5":"j8nMp",e0d5ab7a885d4bb9:"hBXqu","4ba94377c8f677ca":"fSdsu",c7f5e5d35f5ef325:"42YpH",b55571272e67934f:"7Md2a"}],"42YpH":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MessagesPage=n.Messages=void 0;let r=e("8b1df264cd7f9a71"),i=e("79635c92d8a3bf76"),s=e("b489ab03e509dcba");class o extends r.APIResource{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return(0,i.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,a,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}n.Messages=o;class a extends s.CursorPage{}n.MessagesPage=a,o.MessagesPage=a},{"8b1df264cd7f9a71":"j8nMp","79635c92d8a3bf76":"hBXqu",b489ab03e509dcba:"5CJzy"}],"7Md2a":[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.RunsPage=n.Runs=void 0;let o=e("b371e5a9e2fbb664"),a=e("404317be0ea257f5"),l=e("96a58e3951185ed0"),u=e("404317be0ea257f5"),c=s(e("94138fb95596eb87")),d=e("94138fb95596eb87"),p=e("54b590f1c0d380cf");class f extends o.APIResource{constructor(){super(...arguments),this.steps=new c.Steps(this._client)}create(e,t,n){let{include:r,...i}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:r},body:i,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return(0,a.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,h,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){let r=await this.create(e,t,n);return await this.poll(e,r.id,n)}createAndStream(e,t,n){return l.AssistantStream.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){let r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){let{data:i,response:s}=await this.retrieve(e,t,{...n,headers:{...n?.headers,...r}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n?.pollIntervalMs)o=n.pollIntervalMs;else{let e=s.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(o=t)}}await (0,u.sleep)(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,t,n){return l.AssistantStream.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,r){let i=await this.submitToolOutputs(e,t,n,r);return await this.poll(e,i.id,r)}submitToolOutputsStream(e,t,n,r){return l.AssistantStream.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}}n.Runs=f;class h extends p.CursorPage{}n.RunsPage=h,f.RunsPage=h,f.Steps=d.Steps,f.RunStepsPage=d.RunStepsPage},{b371e5a9e2fbb664:"j8nMp","404317be0ea257f5":"hBXqu","96a58e3951185ed0":"fSdsu","94138fb95596eb87":"9jCzI","54b590f1c0d380cf":"5CJzy"}],"9jCzI":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RunStepsPage=n.Steps=void 0;let r=e("5896feddd42aac86"),i=e("afacd78db20974d7"),s=e("fa76b7b847f82991");class o extends r.APIResource{retrieve(e,t,n,r={},s){return(0,i.isRequestOptions)(r)?this.retrieve(e,t,n,{},r):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e,t,n={},r){return(0,i.isRequestOptions)(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,a,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}n.Steps=o;class a extends s.CursorPage{}n.RunStepsPage=a,o.RunStepsPage=a},{"5896feddd42aac86":"j8nMp",afacd78db20974d7:"hBXqu",fa76b7b847f82991:"5CJzy"}],dOXi5:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Completions=void 0;let r=e("e51ec7c570b80d57");class i extends r.APIResource{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}n.Completions=i},{e51ec7c570b80d57:"j8nMp"}],jXUza:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Embeddings=void 0;let o=e("e90c11fbce1aa856"),a=s(e("3d7930621be367f9"));class l extends o.APIResource{create(e,t){let n=!!e.encoding_format,r=n?e.encoding_format:"base64";n&&a.debug("Request","User defined encoding_format:",e.encoding_format);let i=this._client.post("/embeddings",{body:{...e,encoding_format:r},...t});return n?i:(a.debug("response","Decoding base64 embeddings to float32 array"),i._thenUnwrap(e=>(e&&e.data&&e.data.forEach(e=>{let t=e.embedding;e.embedding=a.toFloat32Array(t)}),e)))}}n.Embeddings=l},{e90c11fbce1aa856:"j8nMp","3d7930621be367f9":"hBXqu"}],"7VzGj":[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.EvalListResponsesPage=n.Evals=void 0;let o=e("a94fc3def6de2480"),a=e("8329b670d04b134f"),l=s(e("44a5130953d697c5")),u=e("44a5130953d697c5"),c=e("82086c65d6828822");class d extends o.APIResource{constructor(){super(...arguments),this.runs=new l.Runs(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,n){return this._client.post(`/evals/${e}`,{body:t,...n})}list(e={},t){return(0,a.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/evals",p,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}n.Evals=d;class p extends c.CursorPage{}n.EvalListResponsesPage=p,d.EvalListResponsesPage=p,d.Runs=u.Runs,d.RunListResponsesPage=u.RunListResponsesPage},{a94fc3def6de2480:"j8nMp","8329b670d04b134f":"hBXqu","44a5130953d697c5":"3U4zI","82086c65d6828822":"5CJzy"}],"3U4zI":[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.RunListResponsesPage=n.Runs=void 0;let o=e("923ee42daa34b5a7"),a=e("1d8dbc152346c7d2"),l=s(e("8b276040b6c94a94")),u=e("8b276040b6c94a94"),c=e("be7892bf1778462d");class d extends o.APIResource{constructor(){super(...arguments),this.outputItems=new l.OutputItems(this._client)}create(e,t,n){return this._client.post(`/evals/${e}/runs`,{body:t,...n})}retrieve(e,t,n){return this._client.get(`/evals/${e}/runs/${t}`,n)}list(e,t={},n){return(0,a.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,p,{query:t,...n})}del(e,t,n){return this._client.delete(`/evals/${e}/runs/${t}`,n)}cancel(e,t,n){return this._client.post(`/evals/${e}/runs/${t}`,n)}}n.Runs=d;class p extends c.CursorPage{}n.RunListResponsesPage=p,d.RunListResponsesPage=p,d.OutputItems=u.OutputItems,d.OutputItemListResponsesPage=u.OutputItemListResponsesPage},{"923ee42daa34b5a7":"j8nMp","1d8dbc152346c7d2":"hBXqu","8b276040b6c94a94":"hcu6j",be7892bf1778462d:"5CJzy"}],hcu6j:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OutputItemListResponsesPage=n.OutputItems=void 0;let r=e("30859da6813efbfc"),i=e("dcac911219dbb975"),s=e("acd6437f06c896e8");class o extends r.APIResource{retrieve(e,t,n,r){return this._client.get(`/evals/${e}/runs/${t}/output_items/${n}`,r)}list(e,t,n={},r){return(0,i.isRequestOptions)(n)?this.list(e,t,{},n):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,a,{query:n,...r})}}n.OutputItems=o;class a extends s.CursorPage{}n.OutputItemListResponsesPage=a,o.OutputItemListResponsesPage=a},{"30859da6813efbfc":"j8nMp",dcac911219dbb975:"hBXqu",acd6437f06c896e8:"5CJzy"}],"6OMS5":[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.FileObjectsPage=n.Files=void 0;let o=e("5d3ecc87ec43d592"),a=e("41d952acd0cdeabb"),l=e("41d952acd0cdeabb"),u=e("e842ea9de93a29e5"),c=s(e("41d952acd0cdeabb")),d=e("5ed843125df3e033");class p extends o.APIResource{create(e,t){return this._client.post("/files",c.multipartFormRequestOptions({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return(0,a.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/files",f,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t?.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=18e5}={}){let r=new Set(["processed","error","deleted"]),i=Date.now(),s=await this.retrieve(e);for(;!s.status||!r.has(s.status);)if(await (0,l.sleep)(t),s=await this.retrieve(e),Date.now()-i>n)throw new u.APIConnectionTimeoutError({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return s}}n.Files=p;class f extends d.CursorPage{}n.FileObjectsPage=f,p.FileObjectsPage=f},{"5d3ecc87ec43d592":"j8nMp","41d952acd0cdeabb":"hBXqu",e842ea9de93a29e5:"5zs0s","5ed843125df3e033":"5CJzy"}],"7Gf3p":[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.FineTuning=void 0;let o=e("aa40a36e51de3543"),a=s(e("56245923dc94f8fc")),l=e("56245923dc94f8fc"),u=s(e("fbcd1f26a9882d19")),c=e("fbcd1f26a9882d19");class d extends o.APIResource{constructor(){super(...arguments),this.jobs=new u.Jobs(this._client),this.checkpoints=new a.Checkpoints(this._client)}}n.FineTuning=d,d.Jobs=c.Jobs,d.FineTuningJobsPage=c.FineTuningJobsPage,d.FineTuningJobEventsPage=c.FineTuningJobEventsPage,d.Checkpoints=l.Checkpoints},{aa40a36e51de3543:"j8nMp","56245923dc94f8fc":"b2YbE",fbcd1f26a9882d19:"gxCUr"}],b2YbE:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Checkpoints=void 0;let o=e("79ccb4f23e1108a8"),a=s(e("2b241c5630de2e7a")),l=e("2b241c5630de2e7a");class u extends o.APIResource{constructor(){super(...arguments),this.permissions=new a.Permissions(this._client)}}n.Checkpoints=u,u.Permissions=l.Permissions,u.PermissionCreateResponsesPage=l.PermissionCreateResponsesPage},{"79ccb4f23e1108a8":"j8nMp","2b241c5630de2e7a":"ezyxt"}],ezyxt:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PermissionCreateResponsesPage=n.Permissions=void 0;let r=e("84f651effc2439a3"),i=e("94ed97a7ed333f2c"),s=e("b12e37f06e98d102");class Permissions extends r.APIResource{create(e,t,n){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,o,{body:t,method:"post",...n})}retrieve(e,t={},n){return(0,i.isRequestOptions)(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...n})}del(e,t,n){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${t}`,n)}}n.Permissions=Permissions;class o extends s.Page{}n.PermissionCreateResponsesPage=o,Permissions.PermissionCreateResponsesPage=o},{"84f651effc2439a3":"j8nMp","94ed97a7ed333f2c":"hBXqu",b12e37f06e98d102:"5CJzy"}],gxCUr:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.FineTuningJobEventsPage=n.FineTuningJobsPage=n.Jobs=void 0;let o=e("dcf04c97eab55129"),a=e("c96c5eec139d8842"),l=s(e("419323a2b45aeb2e")),u=e("419323a2b45aeb2e"),c=e("a1a46279296717f3");class d extends o.APIResource{constructor(){super(...arguments),this.checkpoints=new l.Checkpoints(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return(0,a.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",p,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return(0,a.isRequestOptions)(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,f,{query:t,...n})}}n.Jobs=d;class p extends c.CursorPage{}n.FineTuningJobsPage=p;class f extends c.CursorPage{}n.FineTuningJobEventsPage=f,d.FineTuningJobsPage=p,d.FineTuningJobEventsPage=f,d.Checkpoints=u.Checkpoints,d.FineTuningJobCheckpointsPage=u.FineTuningJobCheckpointsPage},{dcf04c97eab55129:"j8nMp",c96c5eec139d8842:"hBXqu","419323a2b45aeb2e":"lqclf",a1a46279296717f3:"5CJzy"}],lqclf:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FineTuningJobCheckpointsPage=n.Checkpoints=void 0;let r=e("d45208d3d1e5c3c3"),i=e("9324ac8e6e6b24fc"),s=e("eeb72bb6506eff6b");class o extends r.APIResource{list(e,t={},n){return(0,i.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,a,{query:t,...n})}}n.Checkpoints=o;class a extends s.CursorPage{}n.FineTuningJobCheckpointsPage=a,o.FineTuningJobCheckpointsPage=a},{d45208d3d1e5c3c3:"j8nMp","9324ac8e6e6b24fc":"hBXqu",eeb72bb6506eff6b:"5CJzy"}],eLdl3:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Images=void 0;let o=e("4a08708143113cb5"),a=s(e("8f8cd4529b8f74ff"));class l extends o.APIResource{createVariation(e,t){return this._client.post("/images/variations",a.multipartFormRequestOptions({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",a.multipartFormRequestOptions({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}n.Images=l},{"4a08708143113cb5":"j8nMp","8f8cd4529b8f74ff":"hBXqu"}],kzZF2:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ModelsPage=n.Models=void 0;let r=e("362d324dddfb45f6"),i=e("99d63ff277aab8ef");class s extends r.APIResource{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",o,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}n.Models=s;class o extends i.Page{}n.ModelsPage=o,s.ModelsPage=o},{"362d324dddfb45f6":"j8nMp","99d63ff277aab8ef":"5CJzy"}],"2AvxK":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Moderations=void 0;let r=e("7fcf7fd88176c3db");class i extends r.APIResource{create(e,t){return this._client.post("/moderations",{body:e,...t})}}n.Moderations=i},{"7fcf7fd88176c3db":"j8nMp"}],aDmtC:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.ResponseItemsPage=n.Responses=void 0;let o=e("a7caedbf0477e2b8"),a=e("2d401d2aa69b7e90"),l=e("81829d3a87a5ad0c"),u=s(e("b75a46686c37ccfa")),c=e("b75a46686c37ccfa"),d=e("f5b99b401d183e53"),p=e("1cd64f74f1b8f678");class f extends l.APIResource{constructor(){super(...arguments),this.inputItems=new u.InputItems(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(e=>("object"in e&&"response"===e.object&&(0,o.addOutputText)(e),e))}retrieve(e,t={},n){return(0,a.isRequestOptions)(t)?this.retrieve(e,{},t):this._client.get(`/responses/${e}`,{query:t,...n})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t?.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(t=>(0,o.parseResponse)(t,e))}stream(e,t){return d.ResponseStream.createResponse(this._client,e,t)}}n.Responses=f;class h extends p.CursorPage{}n.ResponseItemsPage=h,f.InputItems=c.InputItems},{a7caedbf0477e2b8:"dpClt","2d401d2aa69b7e90":"hBXqu","81829d3a87a5ad0c":"j8nMp",b75a46686c37ccfa:"265no",f5b99b401d183e53:"133Nx","1cd64f74f1b8f678":"5CJzy"}],dpClt:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.addOutputText=n.validateInputTools=n.shouldParseToolCall=n.isAutoParsableTool=n.makeParseableResponseTool=n.hasAutoParseableInput=n.parseResponse=n.maybeParseResponse=void 0;let r=e("ee7355c4cf8a0c3a"),i=e("61743c90f0282ee2");function s(e,t){let n=e.output.map(e=>{if("function_call"===e.type)return{...e,parsed_arguments:function(e,t){let n=l(e.tools??[],t.name);return{...t,...t,parsed_arguments:a(n)?n.$parseRaw(t.arguments):n?.strict?JSON.parse(t.arguments):null}}(t,e)};if("message"===e.type){let n=e.content.map(e=>"output_text"===e.type?{...e,parsed:function(e,t){if(e.text?.format?.type!=="json_schema")return null;if("$parseRaw"in e.text?.format){let n=e.text?.format;return n.$parseRaw(t)}return JSON.parse(t)}(t,e.text)}:e);return{...e,content:n}}return e}),r=Object.assign({},e,{output:n});return Object.getOwnPropertyDescriptor(e,"output_text")||u(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(let e of r.output)if("message"===e.type){for(let t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed}return null}}),r}function o(e){return!!(0,i.isAutoParsableResponseFormat)(e.text?.format)}function a(e){return e?.$brand==="auto-parseable-tool"}function l(e,t){return e.find(e=>"function"===e.type&&e.name===t)}function u(e){let t=[];for(let n of e.output)if("message"===n.type)for(let e of n.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}n.maybeParseResponse=function(e,t){return t&&o(t)?s(e,t):{...e,output_parsed:null,output:e.output.map(e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map(e=>({...e,parsed:null}))}:e)}},n.parseResponse=s,n.hasAutoParseableInput=o,n.makeParseableResponseTool=function(e,{parser:t,callback:n}){let r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r},n.isAutoParsableTool=a,n.shouldParseToolCall=function(e,t){if(!e)return!1;let n=l(e.tools??[],t.name);return a(n)||n?.strict||!1},n.validateInputTools=function(e){for(let t of e??[]){if("function"!==t.type)throw new r.OpenAIError(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new r.OpenAIError(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}},n.addOutputText=u},{ee7355c4cf8a0c3a:"5zs0s","61743c90f0282ee2":"gP5Iq"}],"265no":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ResponseItemsPage=n.InputItems=void 0;let r=e("51e4e5b88f0a50ee"),i=e("91ee9a95d084d110"),s=e("c4e87e51d98329a");Object.defineProperty(n,"ResponseItemsPage",{enumerable:!0,get:function(){return s.ResponseItemsPage}});class o extends r.APIResource{list(e,t={},n){return(0,i.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,s.ResponseItemsPage,{query:t,...n})}}n.InputItems=o},{"51e4e5b88f0a50ee":"j8nMp","91ee9a95d084d110":"hBXqu",c4e87e51d98329a:"aDmtC"}],"133Nx":[function(e,t,n){var r,i,s,o,a,l,u,c,d=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},p=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ResponseStream=void 0;let f=e("64703e0d30a6c510"),h=e("fc29a23917f6cad7"),m=e("95c03ff5a3657a14");class g extends h.EventStream{constructor(e){super(),r.add(this),i.set(this,void 0),s.set(this,void 0),o.set(this,void 0),d(this,i,e,"f")}static createResponse(e,t,n){let r=new g(t);return r._run(()=>r._createResponse(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createResponse(e,t,n){let i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),p(this,r,"m",a).call(this);let s=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal});for await(let e of(this._connected(),s))p(this,r,"m",l).call(this,e);if(s.controller.signal?.aborted)throw new f.APIUserAbortError;return p(this,r,"m",u).call(this)}[(i=new WeakMap,s=new WeakMap,o=new WeakMap,r=new WeakSet,a=function(){this.ended||d(this,s,void 0,"f")},l=function(e){if(this.ended)return;let t=p(this,r,"m",c).call(this,e);switch(this._emit("event",e),e.type){case"response.output_text.delta":{let n=t.output[e.output_index];if(!n)throw new f.OpenAIError(`missing output at index ${e.output_index}`);if("message"===n.type){let t=n.content[e.content_index];if(!t)throw new f.OpenAIError(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new f.OpenAIError(`expected content to be 'output_text', got ${t.type}`);this._emit("response.output_text.delta",{...e,snapshot:t.text})}break}case"response.function_call_arguments.delta":{let n=t.output[e.output_index];if(!n)throw new f.OpenAIError(`missing output at index ${e.output_index}`);"function_call"===n.type&&this._emit("response.function_call_arguments.delta",{...e,snapshot:n.arguments});break}default:this._emit(e.type,e)}},u=function(){var e;if(this.ended)throw new f.OpenAIError("stream has ended, this shouldn't happen");let t=p(this,s,"f");if(!t)throw new f.OpenAIError("request ended without sending any events");d(this,s,void 0,"f");let n=(e=p(this,i,"f"),(0,m.maybeParseResponse)(t,e));return d(this,o,n,"f"),n},c=function(e){let t=p(this,s,"f");if(!t){if("response.created"!==e.type)throw new f.OpenAIError(`When snapshot hasn't been set yet, expected 'response.created' event, got ${e.type}`);return d(this,s,e.response,"f")}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{let n=t.output[e.output_index];if(!n)throw new f.OpenAIError(`missing output at index ${e.output_index}`);"message"===n.type&&n.content.push(e.part);break}case"response.output_text.delta":{let n=t.output[e.output_index];if(!n)throw new f.OpenAIError(`missing output at index ${e.output_index}`);if("message"===n.type){let t=n.content[e.content_index];if(!t)throw new f.OpenAIError(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new f.OpenAIError(`expected content to be 'output_text', got ${t.type}`);t.text+=e.delta}break}case"response.function_call_arguments.delta":{let n=t.output[e.output_index];if(!n)throw new f.OpenAIError(`missing output at index ${e.output_index}`);"function_call"===n.type&&(n.arguments+=e.delta);break}case"response.completed":d(this,s,e.response,"f")}return t},Symbol.asyncIterator)](){let e=[],t=[],n=!1;return this.on("event",n=>{let r=t.shift();r?r.resolve(n):e.push(n)}),this.on("end",()=>{for(let e of(n=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(n=!0,t))r.reject(e);t.length=0}),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise((e,n)=>t.push({resolve:e,reject:n})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0});let r=e.shift();return{value:r,done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();let e=p(this,o,"f");if(!e)throw new f.OpenAIError("stream ended without producing a ChatCompletion");return e}}n.ResponseStream=g},{"64703e0d30a6c510":"5zs0s",fc29a23917f6cad7:"6Htkn","95c03ff5a3657a14":"dpClt"}],HmTFH:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Uploads=void 0;let o=e("51f90252280c16c9"),a=s(e("7213c4a1ce395aa9")),l=e("7213c4a1ce395aa9");class u extends o.APIResource{constructor(){super(...arguments),this.parts=new a.Parts(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}n.Uploads=u,u.Parts=l.Parts},{"51f90252280c16c9":"j8nMp","7213c4a1ce395aa9":"kyOtk"}],kyOtk:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.Parts=void 0;let o=e("ef0ef361a39392ab"),a=s(e("13cdf47cf12651bd"));class l extends o.APIResource{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,a.multipartFormRequestOptions({body:t,...n}))}}n.Parts=l},{ef0ef361a39392ab:"j8nMp","13cdf47cf12651bd":"hBXqu"}],"9P780":[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.VectorStoreSearchResponsesPage=n.VectorStoresPage=n.VectorStores=void 0;let o=e("579325614cf73721"),a=e("21d65154bf8eb03e"),l=s(e("f8fd69e0abc6f6cc")),u=e("f8fd69e0abc6f6cc"),c=s(e("b4d71595daf0b39e")),d=e("b4d71595daf0b39e"),p=e("bda6042374214d7");class f extends o.APIResource{constructor(){super(...arguments),this.files=new c.Files(this._client),this.fileBatches=new l.FileBatches(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return(0,a.isRequestOptions)(e)?this.list({},e):this._client.getAPIList("/vector_stores",h,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}search(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/search`,m,{body:t,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}n.VectorStores=f;class h extends p.CursorPage{}n.VectorStoresPage=h;class m extends p.Page{}n.VectorStoreSearchResponsesPage=m,f.VectorStoresPage=h,f.VectorStoreSearchResponsesPage=m,f.Files=d.Files,f.VectorStoreFilesPage=d.VectorStoreFilesPage,f.FileContentResponsesPage=d.FileContentResponsesPage,f.FileBatches=u.FileBatches},{"579325614cf73721":"j8nMp","21d65154bf8eb03e":"hBXqu",f8fd69e0abc6f6cc:"in5dZ",b4d71595daf0b39e:"9R1kF",bda6042374214d7:"5CJzy"}],in5dZ:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.VectorStoreFilesPage=n.FileBatches=void 0;let r=e("4545f6d3406078c8"),i=e("3f4a24a8c61311d0"),s=e("3f4a24a8c61311d0"),o=e("bd283e22f41ba30d"),a=e("afa79c2946d85028");Object.defineProperty(n,"VectorStoreFilesPage",{enumerable:!0,get:function(){return a.VectorStoreFilesPage}});class l extends r.APIResource{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){let r=await this.create(e,t);return await this.poll(e,r.id,n)}listFiles(e,t,n={},r){return(0,i.isRequestOptions)(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,a.VectorStoreFilesPage,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async poll(e,t,n){let r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){let{data:i,response:o}=await this.retrieve(e,t,{...n,headers:r}).withResponse();switch(i.status){case"in_progress":let a=5e3;if(n?.pollIntervalMs)a=n.pollIntervalMs;else{let e=o.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(a=t)}}await (0,s.sleep)(a);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},r){if(null==t||0==t.length)throw Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let i=r?.maxConcurrency??5,s=Math.min(i,t.length),a=this._client,l=t.values(),u=[...n];async function c(e){for(let t of e){let e=await a.files.create({file:t,purpose:"assistants"},r);u.push(e.id)}}let d=Array(s).fill(l).map(c);return await (0,o.allSettledWithThrow)(d),await this.createAndPoll(e,{file_ids:u})}}n.FileBatches=l},{"4545f6d3406078c8":"j8nMp","3f4a24a8c61311d0":"hBXqu",bd283e22f41ba30d:"eCLRt",afa79c2946d85028:"9R1kF"}],eCLRt:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.allSettledWithThrow=void 0;let r=async e=>{let t=await Promise.allSettled(e),n=t.filter(e=>"rejected"===e.status);if(n.length){for(let e of n)console.error(e.reason);throw Error(`${n.length} promise(s) failed - see the above errors`)}let r=[];for(let e of t)"fulfilled"===e.status&&r.push(e.value);return r};n.allSettledWithThrow=r},{}],"9R1kF":[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FileContentResponsesPage=n.VectorStoreFilesPage=n.Files=void 0;let r=e("c19f2549b370c505"),i=e("2bc3e29a4b1a84ed"),s=e("b3daae46fa34cb59");class o extends r.APIResource{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return(0,i.isRequestOptions)(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,a,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){let r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){let r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){let s=await this.retrieve(e,t,{...n,headers:r}).withResponse(),o=s.data;switch(o.status){case"in_progress":let a=5e3;if(n?.pollIntervalMs)a=n.pollIntervalMs;else{let e=s.response.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(a=t)}}await (0,i.sleep)(a);break;case"failed":case"completed":return o}}}async upload(e,t,n){let r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){let r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}content(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,l,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}n.Files=o;class a extends s.CursorPage{}n.VectorStoreFilesPage=a;class l extends s.Page{}n.FileContentResponsesPage=l,o.VectorStoreFilesPage=a,o.FileContentResponsesPage=l},{c19f2549b370c505:"j8nMp","2bc3e29a4b1a84ed":"hBXqu",b3daae46fa34cb59:"5CJzy"}],iqY5N:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"loadContentScripts",()=>f),r.export(n,"loadMainWorldScripts",()=>h);var i=e("@plasmohq/storage"),s=e("webextension-polyfill"),o=e("../lib/user/stateManager"),a=e("../lib/constants"),l=e("../lib/auth/tokenStorage"),u=e("@plasmohq/messaging");let c=new i.Storage({area:"local"});async function d(e,t){if(!e)return!1;try{let t=await m(e);if(t.success)return await (0,l.TokenStorage).setTokens(e,t.data.refreshToken||""),await (0,o.userState).refreshUserState(),s.runtime.sendMessage({action:"auth_complete",userData:t.data.user}).catch(e=>{e.message.includes("Receiving end does not exist")}),!0;return!1}catch(e){return!1}}async function p(e=!1){try{let{accessToken:t}=await (0,l.TokenStorage).getTokens();if(!t)return!1;let n=await (0,o.userState).getState(),r=Date.now();if(!e&&n.lastUpdated&&!(r-n.lastUpdated>27e5))return n.isLoggedIn;{let e=await fetch("https://n8nchat.com/api/auth/verify-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t})});if(!e.ok)return await (0,l.TokenStorage).clearTokens(),await (0,o.userState).resetState(),!1;{let t=await e.json();return await (0,o.userState).setState({isLoggedIn:!0,email:t.data?.user?.email,subscriptionTier:t.data?.subscription?.tier==="premium"?"premium":t.data?.subscription?.isActive?"basic":null,isSubscriptionActive:t.data?.subscription?.isActive||!1,subscriptionEndsAt:t.data?.subscription?.endsAt,creditBalance:t.data?.user?.creditBalance||0,hasSubscription:!!t.data?.subscription?.isActive,isPremium:t.data?.subscription?.tier==="premium",willCancelAtPeriodEnd:t.data?.subscription?.willCancelAtPeriodEnd||!1,subscriptionId:t.data?.subscription?.id||null,planName:t.data?.subscription?.name||(t.data?.subscription?.tier==="premium"?"Premium":t.data?.subscription?.isActive?"Basic":null),lastUpdated:Date.now()}),!0}}}catch(e){return!1}}(0,o.userState).initialize().catch(e=>{}),p().then(e=>{});let f=async e=>{let t=async t=>{try{let n=t.map(e=>s.runtime.getURL(e));return await s.scripting.executeScript({target:{tabId:e},files:n}),!0}catch(e){return!1}};return await t(["content.7f229555.js"])},h=async e=>{let t="node-operations.bffc942f.js";try{let n=s.runtime.getURL(t),r=await fetch(n);if(!r.ok)throw Error(`Failed to fetch ${t}: ${r.statusText}`);let i=await r.text();if(!i)throw Error(`Fetched script content for ${t} is empty.`);await s.scripting.executeScript({target:{tabId:e},world:"MAIN",func:e=>{try{let t=Function(e);return t(),"object"==typeof window.n8nChatNodeOps}catch(e){return console.error("[Background - injected func] Error executing script content:",e),!1}},args:[i]});let o=await s.scripting.executeScript({target:{tabId:e},world:"MAIN",func:()=>"function"==typeof window.n8nChatNodeOps?.getCurrentWorkflowData});if(o&&o[0]&&o[0].result)return!0;return!1}catch(e){return!1}};async function m(e){if(!e)return{success:!1,message:"No token provided"};try{let t=await fetch("https://n8nchat.com/api/auth/verify-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});return await t.json()}catch(e){return{success:!1,message:"Failed to verify token"}}}s.runtime.onMessage.addListener(async(t,n)=>{if("refresh_user_state"===t.action){await p(!0);return}if("subscription_updated"===t.action){let{userState:t}=await e("6896266f1ec08ba3");return await t.forceSubscriptionRefresh(),{success:!0}}if("auth_token_received"===t.action){let e="auth_token_received via browser.runtime.onMessage";return t.extId&&(e="N8N_CHAT_AUTH flow (browser.runtime.onMessage)"),await d(t.token,e),!0}if("deactivate_on_page"===t.action)try{let[e]=await s.tabs.query({active:!0,currentWindow:!0}),t=e?.id;if(t)try{await s.scripting.executeScript({target:{tabId:t},func:()=>{let e=document.querySelector("plasmo-csui");e&&e.remove(),document.documentElement.style.setProperty("--n8n-chat-display","none"),window.n8nChatInjected=!1,document.dispatchEvent(new CustomEvent("n8nChatDeactivate",{detail:{deactivated:!0}}))}}),s.runtime.sendMessage({action:"deactivation_result",status:"success"}).catch(e=>{e.message.includes("Receiving end does not exist")})}catch(e){s.runtime.sendMessage({action:"deactivation_result",status:"error",error:`Deactivation script failed: ${e instanceof Error?e.message:String(e)}`}).catch(e=>{e.message.includes("Receiving end does not exist")})}else s.runtime.sendMessage({action:"deactivation_result",status:"error",error:"No active tab found for deactivation"}).catch(e=>{e.message.includes("Receiving end does not exist")})}catch(e){s.runtime.sendMessage({action:"deactivation_result",status:"error",error:e instanceof Error?e.message:String(e)}).catch(e=>{e.message.includes("Receiving end does not exist")})}if("activate_on_page"===t.action)return(async()=>{try{let e;if(n.tab&&n.tab.id)e=n.tab.id;else{let[t]=await s.tabs.query({active:!0,currentWindow:!0});e=t?.id}if(e){await c.set("chatDeactivated",!1);let t=!1;try{let n=await s.scripting.executeScript({target:{tabId:e},world:"MAIN",func:()=>"function"==typeof window.n8nChatNodeOps?.getCurrentWorkflowData});n&&n[0]&&n[0].result&&(t=!0)}catch(e){}if(!t){let t=await h(e);if(t);else{try{await s.runtime.sendMessage({action:"activation_result",status:"error",error:"Failed to load main world operations script. Please refresh the page."})}catch(e){}return}}let n=!1;try{let t=await (0,u.sendToContentScript)({name:"checkContentScriptActive",tabId:e});t&&t.isActive&&(n=!0)}catch(t){try{await new Promise(e=>setTimeout(e,1e3));let t=await (0,u.sendToContentScript)({name:"checkContentScriptActive",tabId:e});t&&t.isActive&&(n=!0)}catch(e){}}if(n)await (0,u.sendToContentScript)({name:"activateContentScript",tabId:e});else try{let t=await f(e);if(t)await (0,u.sendToContentScript)({name:"activateContentScript",tabId:e});else try{await s.runtime.sendMessage({action:"activation_result",status:"error",error:"Failed to load main content script (content.tsx). Please refresh the page or ensure the extension is properly installed."})}catch(e){}}catch(e){try{await s.runtime.sendMessage({action:"activation_result",status:"error",error:"Manual injection of content.tsx failed: "+(e instanceof Error?e.message:String(e))})}catch(e){}}try{await s.runtime.sendMessage({action:"activation_result",status:"success"})}catch(e){e.message.includes("Receiving end does not exist")}return}try{await s.runtime.sendMessage({action:"activation_result",status:"error",error:"No active tab found"})}catch(e){e.message.includes("Receiving end does not exist")}}catch(e){try{await s.runtime.sendMessage({action:"activation_result",status:"error",error:e instanceof Error?e.message:String(e)})}catch(e){e.message.includes("Receiving end does not exist")}}})(),!0}),s.runtime.onConnect.addListener(e=>{"authMagicTokenPort"===e.name&&(e.onMessage.addListener(async e=>{e.token&&await d(e.token,'Port "authMagicTokenPort"')}),e.onDisconnect.addListener(()=>{}))}),s.tabs.onUpdated.addListener(async(e,t,n)=>{if("complete"===t.status&&n.url){if(n.url.startsWith(a.STRIPE_SUCCESS_URL)){try{await s.tabs.remove(e)}catch(e){}try{await (0,o.userState).refreshUserState()}catch(e){}}else if(n.url.startsWith(a.STRIPE_CANCEL_URL))try{await s.tabs.remove(e)}catch(e){}}}),s.runtime.onInstalled.addListener(e=>{(0,o.userState).getState().then(e=>{e.lastUpdated||(0,o.userState).initialize().catch(e=>{})}).catch(e=>{})}),s.runtime.onSuspend.addListener(()=>{(0,o.userState).destroy()}),s.runtime.onMessageExternal.addListener(async(e,t)=>{if(t.url&&t.url.includes("n8nchat.com")&&"auth_success"===e.action&&e.token){let t=await m(e.token);return t.success?(await (0,l.TokenStorage).setTokens(e.token,t.data.refreshToken||""),await (0,o.userState).refreshUserState(),s.runtime.sendMessage({action:"auth_complete",userData:t.data.user}).catch(e=>{e.message.includes("Receiving end does not exist")}),{success:!0,message:"Authentication successful"}):{success:!1,message:t.message}}return{success:!1,message:"Invalid request"}})},{"@plasmohq/storage":"luF8G","webextension-polyfill":"5lhhz","../lib/user/stateManager":"cjnrU","../lib/constants":"3KPcQ","../lib/auth/tokenStorage":"95fXr","@plasmohq/messaging":"cGQiM","6896266f1ec08ba3":"9tjRx","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"5lhhz":[function(t,n,r){var i;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,i=function(e){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw Error("This script should only be loaded in a browser extension.");globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id?e.exports=globalThis.browser:e.exports=(e=>{let t={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(t).length)throw Error("api-metadata.json has not been included in browser-polyfill");class n extends WeakMap{constructor(e,t){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}let r=e=>e&&"object"==typeof e&&"function"==typeof e.then,i=(t,n)=>(...r)=>{e.runtime.lastError?t.reject(Error(e.runtime.lastError.message)):n.singleCallbackArg||r.length<=1&&!1!==n.singleCallbackArg?t.resolve(r[0]):t.resolve(r)},s=e=>1==e?"argument":"arguments",o=(e,t)=>function(n,...r){if(r.length<t.minArgs)throw Error(`Expected at least ${t.minArgs} ${s(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw Error(`Expected at most ${t.maxArgs} ${s(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise((s,o)=>{if(t.fallbackToNoCallback)try{n[e](...r,i({resolve:s,reject:o},t))}catch(i){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,i),n[e](...r),t.fallbackToNoCallback=!1,t.noCallback=!0,s()}else t.noCallback?(n[e](...r),s()):n[e](...r,i({resolve:s,reject:o},t))})},a=(e,t,n)=>new Proxy(t,{apply:(t,r,i)=>n.call(r,e,...i)}),l=Function.call.bind(Object.prototype.hasOwnProperty),u=(e,t={},n={})=>{let r=Object.create(null),i=Object.create(e);return new Proxy(i,{has:(t,n)=>n in e||n in r,get(i,s,c){if(s in r)return r[s];if(!(s in e))return;let d=e[s];if("function"==typeof d){if("function"==typeof t[s])d=a(e,e[s],t[s]);else if(l(n,s)){let t=o(s,n[s]);d=a(e,e[s],t)}else d=d.bind(e)}else if("object"==typeof d&&null!==d&&(l(t,s)||l(n,s)))d=u(d,t[s],n[s]);else{if(!l(n,"*"))return Object.defineProperty(r,s,{configurable:!0,enumerable:!0,get:()=>e[s],set(t){e[s]=t}}),d;d=u(d,t[s],n["*"])}return r[s]=d,d},set:(t,n,i,s)=>(n in r?r[n]=i:e[n]=i,!0),defineProperty:(e,t,n)=>Reflect.defineProperty(r,t,n),deleteProperty:(e,t)=>Reflect.deleteProperty(r,t)})},c=e=>({addListener(t,n,...r){t.addListener(e.get(n),...r)},hasListener:(t,n)=>t.hasListener(e.get(n)),removeListener(t,n){t.removeListener(e.get(n))}}),d=new n(e=>"function"!=typeof e?e:function(t){let n=u(t,{},{getContent:{minArgs:0,maxArgs:0}});e(n)}),p=new n(e=>"function"!=typeof e?e:function(t,n,i){let s,o,a=!1,l=new Promise(e=>{s=function(t){a=!0,e(t)}});try{o=e(t,n,s)}catch(e){o=Promise.reject(e)}let u=!0!==o&&r(o);return(!0===o||!!u||!!a)&&((e=>{e.then(e=>{i(e)},e=>{i({__mozWebExtensionPolyfillReject__:!0,message:e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred"})}).catch(e=>{console.error("Failed to send onMessage rejected reply",e)})})(u?o:l),!0)}),f=({reject:t,resolve:n},r)=>{e.runtime.lastError?"The message port closed before a response was received."===e.runtime.lastError.message?n():t(Error(e.runtime.lastError.message)):r&&r.__mozWebExtensionPolyfillReject__?t(Error(r.message)):n(r)},h=(e,t,n,...r)=>{if(r.length<t.minArgs)throw Error(`Expected at least ${t.minArgs} ${s(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw Error(`Expected at most ${t.maxArgs} ${s(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise((e,t)=>{let i=f.bind(null,{resolve:e,reject:t});r.push(i),n.sendMessage(...r)})},m={devtools:{network:{onRequestFinished:c(d)}},runtime:{onMessage:c(p),onMessageExternal:c(p),sendMessage:h.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:h.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},g={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return t.privacy={network:{"*":g},services:{"*":g},websites:{"*":g}},u(e,m,t)})(chrome)},"function"==typeof e&&e.amd?e("webextension-polyfill",["module"],i):i(n)},{}],cjnrU:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"userState",()=>u);var i=e("@plasmohq/storage"),s=e("../api/client"),o=e("../auth/tokenStorage");let a=(e,...t)=>{},l={isLoggedIn:!1,userId:null,email:null,creditBalance:0,hasSubscription:!1,subscriptionTier:null,subscriptionId:null,subscriptionEndsAt:null,isSubscriptionActive:!1,willCancelAtPeriodEnd:!1,isPremium:!1,planName:null,lastUpdated:0,subscriptionCheckTime:0},u=new class{constructor(){this.stateKey="n8nChatUserState",this.storage=new i.Storage({area:"local"}),this.listeners=[],this.refreshInterval=null,this.isRefreshing=!1,this.lastRefreshAttempt=0,this.refreshUserState=this.refreshUserState.bind(this)}async getState(){let e=await this.storage.get(this.stateKey);return e?{...l,...e}:l}async setState(e){let t=await this.getState(),n={...t,...e,lastUpdated:Date.now()};return await this.storage.set(this.stateKey,n),this.notifyListeners(n),n}async resetState(){let e={...l,lastUpdated:Date.now()};return await this.storage.set(this.stateKey,e),await (0,o.TokenStorage).clearTokens(),this.notifyListeners(e),e}async clearSubscriptionCache(){let e=await this.getState();await this.setState({...e,subscriptionCheckTime:0}),console.log("Subscription cache cleared")}subscribe(e){return this.listeners.push(e),this.getState().then(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}notifyListeners(e){[...this.listeners].forEach(t=>{try{t(e)}catch(e){console.error("Error in UserStateManager listener:",e)}})}async initialize(){let e=await this.getState(),t=Date.now();(!e.lastUpdated||t-e.lastUpdated>864e5)&&await this.refreshUserState()}destroy(){this.listeners=[]}isCacheStale(e,t=864e5){let n=Date.now();return!e.lastUpdated||n-e.lastUpdated>t}async verifyFeatureAccess(e,t=!0){if("basic"===e)return{hasAccess:!0};let n=await this.getState(),r=Date.now();if(!n.isLoggedIn)return{hasAccess:!1,reason:"login-required"};if("premium"===e){let e=!n.subscriptionCheckTime||r-n.subscriptionCheckTime>36e5;if(e)try{let e=await (0,s.api).getSubscriptionStatus();if(e.success&&e.data){await this.setState({hasSubscription:!!e.data.hasActiveSubscription,isSubscriptionActive:!!e.data.hasActiveSubscription,isPremium:this.determinePremiumStatus(e.data.subscription),subscriptionCheckTime:r});let t=await this.getState(),n=t.isLoggedIn&&t.hasSubscription&&t.isSubscriptionActive&&t.isPremium;if(!n){if(!t.isLoggedIn)return{hasAccess:n,reason:"login-required"};if(!t.hasSubscription||!t.isSubscriptionActive)return{hasAccess:n,reason:"subscription-required"};if(!t.isPremium)return{hasAccess:n,reason:"premium-required"};return{hasAccess:n,reason:"subscription-required"}}return{hasAccess:n}}await this.refreshUserState()}catch(e){await this.refreshUserState()}let t=await this.getState(),i=t.isLoggedIn&&t.hasSubscription&&t.isSubscriptionActive&&t.isPremium;return i?{hasAccess:i}:t.isLoggedIn?t.hasSubscription&&t.isSubscriptionActive?t.isPremium?{hasAccess:i,reason:"subscription-required"}:{hasAccess:i,reason:"premium-required"}:{hasAccess:i,reason:"subscription-required"}:{hasAccess:i,reason:"login-required"}}if(!n.isLoggedIn)return{hasAccess:!1,reason:"login-required"};if(!n.lastUpdated||r-n.lastUpdated>36e5)return await this.refreshUserState(),this.verifyFeatureAccess(e,!1);let i=n.isLoggedIn&&n.hasSubscription&&n.isSubscriptionActive;return i?{hasAccess:i}:n.isLoggedIn?{hasAccess:i,reason:"subscription-required"}:{hasAccess:i,reason:"login-required"}}async refreshUserState(){if(this.isRefreshing)return a("Already refreshing, skipping duplicate refresh"),this.getState();let e=Date.now();if(this.lastRefreshAttempt&&e-this.lastRefreshAttempt<5e3)return a("Recent refresh attempt detected, skipping to prevent rapid refreshes"),this.getState();this.isRefreshing=!0,this.lastRefreshAttempt=e;let{accessToken:t}=await (0,o.TokenStorage).getTokens();if(!t)return this.isRefreshing=!1,this.resetState();try{let e=await this.getState(),t=Date.now(),n=!e.subscriptionCheckTime||t-e.subscriptionCheckTime>216e5,r=e.userId,i=e.email,o=e.creditBalance||0,a=!1,l=!1,u=null,c=null,d=null,p=!1;if(n)try{let e=await (0,s.api).getSubscriptionStatus();if(e.success&&e.data){let t=e.data;t.user&&(r=t.user.id,i=t.user.email,o=t.user.creditBalance||0),a=!!t.hasActiveSubscription;let n=t.subscription?.plan;n?(l=a&&!n.isBasic,c=n.name||(l?"Premium":"Basic")):(l=!1,c=a?"Basic":null)}else{let e=await (0,s.api).getCurrentUser();if(!e.success){if(401===e.status)return console.warn("Got 401 after token refresh attempt, user needs to re-login"),this.isRefreshing=!1,this.resetState();return console.warn(`API call failed with status ${e.status}, keeping current state`),this.isRefreshing=!1,this.getState()}if(!e.data?.user)return this.isRefreshing=!1,this.resetState();if(r=e.data.user.id,i=e.data.user.email,o=e.data.user.creditBalance||0,e.data.subscription){let t=e.data.subscription;a=!!t&&"active"===t.status,l=t&&t.plan&&!t.plan.isBasic,c=t?.plan?.name||(l?"Premium":a?"Basic":null)}else void 0!==e.data.hasActiveSubscription&&(a=!!e.data.hasActiveSubscription,l=!1,c=a?"Basic":null)}}catch(n){let e=await (0,s.api).getCurrentUser();if(!e.success){if(401===e.status)return console.warn("Got 401 after token refresh attempt, user needs to re-login"),this.isRefreshing=!1,this.resetState();return console.warn(`API call failed with status ${e.status}, keeping current state`),this.isRefreshing=!1,this.getState()}let{user:t}=e.data||{};if(!t)return this.isRefreshing=!1,this.resetState();r=t.id,i=t.email,o=t.creditBalance||0}else if(a=e.isSubscriptionActive,l=e.isPremium,u=e.subscriptionId,c=e.planName,d=e.subscriptionEndsAt,p=e.willCancelAtPeriodEnd,!r||!i){let e=await (0,s.api).getCurrentUser();if(e.success&&e.data?.user)r=e.data.user.id,i=e.data.user.email,o=e.data.user.creditBalance||0;else if(401===e.status)return console.warn("Got 401 after token refresh attempt, user needs to re-login"),this.isRefreshing=!1,this.resetState()}let f=l?"premium":a?"basic":null,h=await this.setState({isLoggedIn:!0,userId:r,email:i,creditBalance:o,hasSubscription:a,subscriptionTier:f,subscriptionId:u,subscriptionEndsAt:d,isSubscriptionActive:a,willCancelAtPeriodEnd:p,isPremium:l,planName:c,lastUpdated:t,...n?{subscriptionCheckTime:t}:{}});return this.isRefreshing=!1,h}catch(e){return this.isRefreshing=!1,this.getState()}}async forceSubscriptionRefresh(){let e=Date.now(),t=await this.getState();try{let n=await (0,s.api).getSubscriptionStatus();if(n.success&&n.data){let r=n.data.user,i=!!n.data.hasActiveSubscription,s=n.data.subscription?.plan,o=i&&s&&!s.isBasic,a=s?.name||(o?"Premium":i?"Basic":null);return await this.setState({...r?{userId:r.id,email:r.email,creditBalance:r.creditBalance||t.creditBalance}:{userId:t.userId,email:t.email},hasSubscription:i,isSubscriptionActive:i,isPremium:o,subscriptionTier:o?"premium":i?"basic":null,planName:a,subscriptionId:n.data.subscription?.planId||null,lastUpdated:e,subscriptionCheckTime:e}),this.getState()}let r=await (0,s.api).getCurrentUser();if(r.success&&r.data?.user){let t=r.data,n=!1,i=!1,s=null;return t.subscription?(n=!!t.subscription&&"active"===t.subscription.status,i=t.subscription&&t.subscription.plan&&!t.subscription.plan.isBasic,s=t.subscription?.plan?.name||(i?"Premium":n?"Basic":null)):void 0!==t.hasActiveSubscription&&(n=!!t.hasActiveSubscription,i=!1,s=n?"Basic":null),await this.setState({userId:t.user.id,email:t.user.email,creditBalance:t.user.creditBalance||0,hasSubscription:n,isSubscriptionActive:n,isPremium:i,subscriptionTier:i?"premium":n?"basic":null,planName:s,lastUpdated:e,subscriptionCheckTime:e}),this.getState()}}catch(e){}return await this.clearSubscriptionCache(),this.refreshUserState()}determinePremiumStatus(e){return!!e&&(!!e.plan&&!1===e.plan.isBasic||e.plan?.tier==="premium"||"premium"===e.tier)}}},{"@plasmohq/storage":"luF8G","../api/client":"kward","../auth/tokenStorage":"95fXr","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],kward:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"api",()=>a);var i=e("../constants"),s=e("../auth/tokenStorage"),o=e("@plasmohq/storage");let a=new class{constructor(e){this.baseUrl=e}async getAuthToken(){let{accessToken:e,refreshToken:t,tokenTimestamp:n}=await (0,s.TokenStorage).getTokens();if(e&&!(0,s.TokenStorage).isTokenExpired(n))return e;if(t)try{let e=await fetch(`${this.baseUrl}/auth/refresh-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(!e.ok)return console.error(`Token refresh failed with status: ${e.status}`),await (0,s.TokenStorage).clearTokens(),null;let n=e.headers.get("content-type");if(!n||!n.includes("application/json"))return console.error("Token refresh response was not JSON."),await (0,s.TokenStorage).clearTokens(),null;let r=await e.json();if(r.success&&r.data?.token&&r.data?.refreshToken)return await (0,s.TokenStorage).setTokens(r.data.token,r.data.refreshToken),r.data.token;console.warn("Refresh token invalid or missing data in response:",r.message),await (0,s.TokenStorage).clearTokens()}catch(e){console.error("Token refresh failed:",e),await (0,s.TokenStorage).clearTokens()}return null}async request(e,t={}){let n=`${this.baseUrl}${e}`,r={"Content-Type":"application/json",...t.headers};if(!e.includes("/auth/login")&&!e.includes("/auth/register")){let e=await this.getAuthToken();e&&(r.Authorization=`Bearer ${e}`)}try{let i=await fetch(n,{...t,headers:r}),o=null,a="Unknown error",l=i.headers.get("content-type");try{l&&l.includes("application/json")?(o=await i.json(),a=o?.message||i.statusText||"Unknown error"):a=`Received non-JSON response (status ${i.status}): ${await i.text()}`}catch(t){console.error(`API request to ${e} failed during JSON parsing:`,t),a="Failed to parse server response."}if(401===i.status&&!e.includes("/auth/login")&&!e.includes("/auth/register")&&!e.includes("/auth/refresh-token")){console.log(`Got 401 for ${e}, attempting to refresh token and retry...`);let{refreshToken:i}=await (0,s.TokenStorage).getTokens();if(i)try{let o=await fetch(`${this.baseUrl}/auth/refresh-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:i})});if(o.ok){let i=await o.json();if(i.success&&i.data?.token&&i.data?.refreshToken){await (0,s.TokenStorage).setTokens(i.data.token,i.data.refreshToken),r.Authorization=`Bearer ${i.data.token}`;let o=await fetch(n,{...t,headers:r}),a=null,l="Unknown error",u=o.headers.get("content-type");try{u&&u.includes("application/json")?(a=await o.json(),l=a?.message||o.statusText||"Unknown error"):l=`Received non-JSON response (status ${o.status}): ${await o.text()}`}catch(t){console.error(`Retry request to ${e} failed during JSON parsing:`,t),l="Failed to parse server response."}if(!o.ok)return{success:!1,status:o.status,message:l,data:a};return{success:!0,status:o.status,message:a?.message||"",data:a?.data}}}console.warn("Token refresh failed, clearing tokens"),await (0,s.TokenStorage).clearTokens()}catch(e){console.error("Token refresh error:",e),await (0,s.TokenStorage).clearTokens()}}if(!i.ok)return{success:!1,status:i.status,message:a,data:o};return{success:!0,status:i.status,message:o?.message||"",data:o?.data}}catch(n){console.error(`API request to ${e} failed:`,n);let t=n instanceof Error?n.message:String(n);return{success:!1,status:0,message:t,data:null}}}async register(e,t){return this.request("/auth/register",{method:"POST",body:JSON.stringify({email:e,password:t})})}async login(e,t){let n=await this.request("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})});return n.success&&n.data?.token&&n.data?.refreshToken&&await (0,s.TokenStorage).setTokens(n.data.token,n.data.refreshToken),n}async getCurrentUser(){return this.request("/auth/me")}async getSubscriptionStatus(){return this.request("/auth/subscription-status")}async logout(){let t;let{refreshToken:n}=await (0,s.TokenStorage).getTokens();t=n?this.request("/auth/logout",{method:"POST",body:JSON.stringify({refreshToken:n})}):Promise.resolve({success:!0,status:200,message:"Logged out locally.",data:null});let r=await t;await (0,s.TokenStorage).clearTokens();let{userState:i}=await e("7383d526c0d9cb98");return await i.resetState(),r}async getPlans(){return this.request("/subscriptions/plans")}async getCurrentSubscription(){return this.request("/subscriptions/current")}async createSubscriptionCheckout(e){return this.request("/subscriptions/checkout",{method:"POST",body:JSON.stringify({planId:e})})}async cancelSubscription(){return this.request("/subscriptions/cancel",{method:"POST"})}async requestLoginLink(t){let n=new o.Storage({area:"local"}),r=await n.get("n8nChatExtId");if(!r){let{v4:t}=await e("ea5d11c2ce00cba3");r=t(),await n.set("n8nChatExtId",r)}return this.request("/auth/send-login-link",{method:"POST",body:JSON.stringify({email:t,extId:r})})}}(i.API_BASE_URL)},{"../constants":"3KPcQ","../auth/tokenStorage":"95fXr","@plasmohq/storage":"luF8G","7383d526c0d9cb98":"9tjRx",ea5d11c2ce00cba3:"6eg4U","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"3KPcQ":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"API_BASE_URL",()=>i),r.export(n,"STRIPE_CUSTOMER_PORTAL_URL",()=>s),r.export(n,"STRIPE_SUCCESS_URL",()=>o),r.export(n,"STRIPE_CANCEL_URL",()=>a);let i="https://n8nchat.com/api",s="https://billing.stripe.com/p/login/5kA28SgEfg2g8nubII",o="https://n8nchat.com/payment/success",a="https://n8nchat.com/payment/cancel"},{"@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"95fXr":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"TokenStorage",()=>o);var i=e("@plasmohq/storage");let s=new i.Storage({area:"local"}),o={async setTokens(e,t){await s.set("accessToken",e),await s.set("refreshToken",t),await s.set("tokenTimestamp",Date.now())},async getTokens(){let e=await s.get("accessToken"),t=await s.get("refreshToken"),n=await s.get("tokenTimestamp");return{accessToken:e??null,refreshToken:t??null,tokenTimestamp:n||0}},async clearTokens(){await s.remove("accessToken"),await s.remove("refreshToken"),await s.remove("tokenTimestamp")},isTokenExpired(e){let t=Date.now();return t-e>3e6}}},{"@plasmohq/storage":"luF8G","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],"9tjRx":[function(e,t,n){t.exports=e("831077c898df5903")(e("a9ef52b15b6cf763").getBundleURL("abzv4")+"../../"+e("462cec51fce5a8ac").resolve("hQLIL")).then(()=>t.bundle.root("cjnrU"))},{"831077c898df5903":"kkv7s",a9ef52b15b6cf763:"1Ksod","462cec51fce5a8ac":"aOnzl"}],kkv7s:[function(e,t,n){var r=e("8cac51c89fd1baba");t.exports=r(function(e){return new Promise(function(t,n){try{importScripts(e),t()}catch(e){n(e)}})})},{"8cac51c89fd1baba":"dRtkF"}],dRtkF:[function(e,t,n){var r={},i={},s={};t.exports=function(e,t){return function(n){var o=function(e){switch(e){case"preload":return i;case"prefetch":return s;default:return r}}(t);return o[n]?o[n]:o[n]=e.apply(null,arguments).catch(function(e){throw delete o[n],e})}}},{}],"1Ksod":[function(e,t,n){var r={};function i(e){return(""+e).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}n.getBundleURL=function(e){var t=r[e];return t||(t=function(){try{throw Error()}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return i(e[2])}return"/"}(),r[e]=t),t},n.getBaseURL=i,n.getOrigin=function(e){var t=(""+e).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^/]+/);if(!t)throw Error("Origin not found");return t[0]}},{}],"6eg4U":[function(e,t,n){t.exports=e("90d2438807eed87e")(e("8a650ca7cb8a83ce").getBundleURL("abzv4")+"../../"+e("2be7ae64e14dc6e3").resolve("7vBBH")).then(()=>t.bundle.root("5Q82B"))},{"90d2438807eed87e":"kkv7s","8a650ca7cb8a83ce":"1Ksod","2be7ae64e14dc6e3":"aOnzl"}],"8ZbMf":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js"),i=e("url:../../../src/contents/node-operations"),s=r.interopDefault(i);chrome.scripting.registerContentScripts([{id:"srcContentsNodeOperations",js:[(0,s.default).split("/").pop().split("?")[0]],matches:["https://*.n8n.cloud/workflow/*","*://*/workflow/*"],world:"MAIN"}]).catch(e=>{})},{"url:../../../src/contents/node-operations":"kbJOM","@parcel/transformer-js/src/esmodule-helpers.js":"hbR2Q"}],kbJOM:[function(e,t,n){t.exports=e("5623780714120508").getBundleURL("abzv4")+"../../"+e("24b80f18573d7e51").resolve("eeDZt")},{"5623780714120508":"1Ksod","24b80f18573d7e51":"aOnzl"}]},["fBdzW","kgW6q"],"kgW6q","parcelRequire6393"),globalThis.define=t;